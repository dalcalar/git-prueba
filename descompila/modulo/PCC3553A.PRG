 SET CENTURY ON
 PUBLIC afIl, x, ntM1, ntM2
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE 01 TO meRr
 DIMENSION afIl[31, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM1TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEM"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FVE"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FCA"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DAT"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CAJ"
 afIl[x, 2] = "N"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 6
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MND"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ACU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SLD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1GRU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SR1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NUM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NTI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1GLO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 80
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NBA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NCT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CHE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SRL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1LET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1RCB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DNC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj, 2, 0)+ ;
       ftM1sr1+ftM1num TAG ftM1doc
 INDEX ON ftM1fpa+ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj,  ;
       2, 0)+ftM1sr1+ftM1num TAG ftM1fpa
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[13, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM2CAJ"
 afIl[x, 2] = "N"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2GRU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NTI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2HO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2OT1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2HO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2OT2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2EST"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON STR(ftM2caj, 2, 0)+STR(ftM2gru, 1, 0)+ftM2tip+ftM2fpa TAG ftM2caj
 INDEX ON ftM2tip+ftM2fpa+STR(ftM2caj, 2, 0)+STR(ftM2gru, 1, 0) TAG ftM2tip
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 STORE 99 TO mkEy
 SELECT 1
 DO abR_0000a IN PUX0000A WITH "3110", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Letras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3110DAT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 DO abR_0000a IN PUX0000A WITH "3500", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Pend_Vtas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3500DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 DO abR_0000a IN PUX0000A WITH "3510", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Ing_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3510DAT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 DO abR_0000a IN PUX0000A WITH "3511", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Ing_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3511NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 DO abR_0000a IN PUX0000A WITH "3530", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Ing_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3530DAT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 DO abR_0000a IN PUX0000A WITH "3531", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Ing_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3531NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 DO abR_0000a IN PUX0000A WITH "3610", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Notas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3610DAT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300DAT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM1DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_2
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM2CAJ
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 00 TO meRr
 PUBLIC vsW0, vsW1, vsW2, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
        ffFs, cfFs
 PUBLIC icLn, ucLn, icL1, ucL1, vfI2, vpAg, vlIn, vtDo, itDo, utDo, ctDo,  ;
        vsEr, isEr
 PUBLIC usEr, csEr, vdOc, idOc, udOc, cdOc, vcAj, icAj, ucAj, ccAj, vgRu,  ;
        igRu, ugRu
 PUBLIC cgRu, vsR1, isR1, usR1, csR1, vnUm, inUm, unUm, cnUm, vgR1, igR1,  ;
        ugR1, vcJj
 PUBLIC icJj, ucJj, vtIp, itIp, utIp, ifEc, ufEc, ciFe, chFe, vmOn, vmNd,  ;
        vtCa, vgLo
 PUBLIC vsRl, vlEt, vrCb, vpGo, vcHe, vaCu, vtOt, xtOt, vsLd, vfPa, ifPa,  ;
        ufPa, vnFp
 PUBLIC vnOm, vfEm, vnTi, vdNc, vsG1, vsG2, voPc, vtPo, veF1, veF2, veF3,  ;
        veF4, vcH1
 PUBLIC vcH2, vcH3, vcH4, vdP1, vdP2, vdP3, vdP4, voT1, voT2, voT3, voT4,  ;
        vfA1, vfA2
 PUBLIC vfA3, vfA4, vbO1, vbO2, vbO3, vbO4, vnP1, vnP2, vnP3, vnP4, vpE1,  ;
        vpE2, vpE3
 PUBLIC vpE4, vnC1, vnC2, vnC3, vnC4, vnD1, vnD2, vnD3, vnD4, vnVe, vxLs,  ;
        vaNo, vmEs
 PUBLIC vdAt, vfCa
 PUBLIC vpAn_11, vpAn_12
 STORE DATE() TO ifEc, ufEc
 STORE CTOD("  /  /    ") TO ciFe, chFe
 STORE SPACE(02) TO vtDo, itDo, utDo
 STORE SPACE(03) TO vsEr, isEr, usEr
 STORE SPACE(03) TO vsR1, isR1, usR1
 STORE SPACE(07) TO vdOc, idOc, udOc
 STORE SPACE(07) TO vnUm, inUm, unUm
 STORE 00 TO vgRu, igRu, ugRu
 STORE 00 TO vcAj, icAj, ucAj
 STORE 00 TO veF1, veF2, veF3, veF4
 STORE 00 TO vcH1, vcH2, vcH3, vcH4
 STORE 00 TO vdP1, vdP2, vdP3, vdP4
 STORE 00 TO voT1, voT2, voT3, voT4
 STORE 00 TO vfA1, vfA2, vfA3, vfA4
 STORE 00 TO vbO1, vbO2, vbO3, vbO4
 STORE 00 TO vnP1, vnP2, vnP3, vnP4
 STORE 00 TO vpE1, vpE2, vpE3, vpE4
 STORE 00 TO vnC1, vnC2, vnC3, vnC4
 STORE 00 TO vnD1, vnD2, vnD3, vnD4
 STORE 01 TO vsW0, vsW1, vsW2
 STORE 88 TO mpAg
 STORE 99 TO mkEy
 SET READBORDER ON
 DO p00_3553a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO reS_3553a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_3552a IN PCC3552A
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hl1_3553a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO reS_3553a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Tab
                STORE k_Tab TO mkEy
                SELECT teMporal
                SET ORDER TO FTM1DOC
                IF ifEc<>ciFe .OR. ufEc<>chFe
                     SELECT teMporal
                     ZAP
                     REINDEX
                     SELECT teMporal_2
                     ZAP
                     REINDEX
                     STORE 00 TO veF1, veF2, veF3, veF4
                     STORE 00 TO vcH1, vcH2, vcH3, vcH4
                     STORE 00 TO vdP1, vdP2, vdP3, vdP4
                     STORE 00 TO voT1, voT2, voT3, voT4
                     STORE 00 TO vfA1, vfA2, vfA3, vfA4
                     STORE 00 TO vbO1, vbO2, vbO3, vbO4
                     STORE 00 TO vnP1, vnP2, vnP3, vnP4
                     STORE 00 TO vpE1, vpE2, vpE3, vpE4
                     STORE 00 TO vnC1, vnC2, vnC3, vnC4
                     STORE 00 TO vnD1, vnD2, vnD3, vnD4
                     STORE 01 TO vgRu
                     SAVE SCREEN TO vpAn_11
                     SET ESCAPE ON
                     ON ESCAPE STORE K_ESC TO MKEY
                     SELECT caB_ing_caja
                     SET NEAR ON
                     SEEK SUBSTR(DTOC(ifEc), 7, 4)+SUBSTR(DTOC(ifEc), 4,  ;
                          2)+SUBSTR(DTOC(ifEc), 1, 2)
                     SET NEAR OFF
                     DO WHILE  .NOT. EOF() .AND. f3510dat<=ufEc
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          IF f3510est="9" .OR. f3510tpo=2 .OR. f3510tpo=5
                               SKIP
                               LOOP
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  CAJA "+f3510ano+ ;
                             "-"+f3510mes+"-"+f3510num+ ;
                             "...Presionar ESC para Salir..."
                          STORE f3510ano TO vaNo
                          STORE f3510mes TO vmEs
                          STORE f3510ser TO vsEr
                          STORE f3510num TO vnUm
                          STORE f3510tpo TO vtPo
                          STORE f3510caj TO vcAj
                          STORE f3510mon TO vmNd
                          STORE f3510tca TO vtCa
                          STORE f3510glo TO vgLo
                          STORE f3510srl TO vsRl
                          STORE f3510let TO vlEt
                          STORE f3510rcb TO vrCb
                          STORE f3510tip TO vtIp
                          STORE f3510nti TO vnTi
                          STORE f3510dnc TO vdNc
                          STORE f3510dat TO vdAt
                          STORE CTOD(f3510dia+"/"+f3510mes+"/"+f3510ano)  ;
                                TO vfCa
                          DO CASE
                               CASE vtPo=1
                                    STORE "Por rendir" TO vcHe
                               CASE vtPo=4
                                    STORE "Canje/Renovacion LE" TO vcHe
                               CASE vtPo=6
                                    STORE "Aplicacion NC" TO vcHe
                               OTHERWISE
                                    STORE "Caja" TO vcHe
                          ENDCASE
                          SELECT deT_ing_caja
                          SET NEAR ON
                          SEEK vaNo+vmEs+vsEr+vnUm
                          SET NEAR OFF
                          DO WHILE  .NOT. EOF() .AND. f3511ano+f3511mes+ ;
                             f3511ser+f3511num=vaNo+vmEs+vsEr+vnUm
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               STORE f3511tdo TO vtDo
                               STORE f3511sr1 TO vsR1
                               STORE f3511doc TO vdOc
                               STORE f3511pag TO vaCu
                               SELECT peNd_vtas
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    STORE 0 TO vtOt, vsLd
                                    STORE 1 TO vmOn
                                    STORE "00" TO vfPa
                                    STORE SPACE(70) TO vnOm, vnFp, vnVe
                                    STORE CTOD("  /  /    ") TO vfEm, vfVe
                               ELSE
                                    STORE f3500nom TO vnOm
                                    STORE f3500fem TO vfEm
                                    STORE f3500fve TO vfVe
                                    STORE f3500fpa TO vfPa
                                    STORE f3500nfp TO vnFp
                                    STORE f3500nve TO vnVe
                                    STORE f3500mon TO vmOn
                                    STORE f3500tot TO vtOt
                                    STORE f3500tot+f3500int-f3500acu TO vsLd
                               ENDIF
                               IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                                    STORE vtOt*-1 TO vtOt
                                    STORE vaCu*-1 TO vaCu
                               ENDIF
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc+STR(vgRu, 1, 0)+ ;
                                    STR(vcAj, 2, 0)+vsR1+vnUm
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1gru WITH vgRu
                                    REPLACE ftM1caj WITH vcAj
                                    REPLACE ftM1sr1 WITH vsR1
                                    REPLACE ftM1num WITH vnUm
                                    REPLACE ftM1fem WITH vfEm
                                    REPLACE ftM1fca WITH vfCa
                                    REPLACE ftM1dat WITH vdAt
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1fpa WITH vfPa
                                    REPLACE ftM1nfp WITH vnFp
                                    REPLACE ftM1nve WITH vnVe
                                    REPLACE ftM1dnc WITH vdNc
                                    REPLACE ftM1tip WITH vtIp
                                    REPLACE ftM1nti WITH vnTi
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1mnd WITH vmNd
                                    REPLACE ftM1tca WITH vtCa
                                    REPLACE ftM1acu WITH vaCu
                                    REPLACE ftM1sld WITH vsLd
                                    REPLACE ftM1glo WITH vgLo
                                    REPLACE ftM1che WITH vcHe
                                    REPLACE ftM1srl WITH vsRl
                                    REPLACE ftM1let WITH vlEt
                                    REPLACE ftM1rcb WITH vrCb
                                    SELECT teMporal_2
                                    SEEK STR(vcAj, 2, 0)+STR(vgRu, 1, 0)+ ;
                                     vtIp+vfPa
                                    IF EOF()
                                         APPEND BLANK
                                         REPLACE ftM2caj WITH vcAj
                                         REPLACE ftM2gru WITH vgRu
                                         REPLACE ftM2tip WITH vtIp
                                         REPLACE ftM2nti WITH vnTi
                                         REPLACE ftM2fpa WITH vfPa
                                         REPLACE ftM2nfp WITH vnFp
                                         REPLACE ftM2ho1 WITH 0
                                         REPLACE ftM2ho2 WITH 0
                                         REPLACE ftM2ot1 WITH 0
                                         REPLACE ftM2ot2 WITH 0
                                         REPLACE ftM2to1 WITH 0
                                         REPLACE ftM2to2 WITH 0
                                    ENDIF
                                    DO CASE
                                         CASE vmNd=1
                                              REPLACE ftM2to1 WITH ftM2to1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2to2 WITH ftM2to2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE vmNd=1 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              REPLACE ftM2ho1 WITH ftM2ho1+vaCu
                                         CASE vmNd=2 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              REPLACE ftM2ho2 WITH ftM2ho2+vaCu
                                         CASE vmNd=1
                                              REPLACE ftM2ot1 WITH ftM2ot1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2ot2 WITH ftM2ot2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE vtPo=4
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=1 .AND.  ;
                                          vfEm>=ifEc .AND. vfEm<=ufEc
                                              STORE veF1-vaCu TO veF1
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=2 .AND.  ;
                                          vfEm>=ifEc .AND. vfEm<=ufEc
                                              STORE veF2-vaCu TO veF2
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=1
                                              STORE veF3-vaCu TO veF3
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=2
                                              STORE veF4-vaCu TO veF4
                                         CASE vmNd=1 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<> ;
                                          "N3" .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE veF1+vaCu TO veF1
                                         CASE vmNd=2 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<> ;
                                          "N3" .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE veF2+vaCu TO veF2
                                         CASE vmNd=1 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<>"N3"
                                              STORE veF3+vaCu TO veF3
                                         CASE vmNd=2 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<>"N3"
                                              STORE veF4+vaCu TO veF4
                                    ENDCASE
                               ENDIF
                               SELECT deT_ing_caja
                               SKIP
                          ENDDO
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          SELECT caB_ing_caja
                          SKIP
                     ENDDO
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     STORE 02 TO vgRu
                     STORE 00 TO vcAj
                     SELECT caB_ing_bancos
                     SET NEAR ON
                     SEEK SUBSTR(DTOC(ifEc), 7, 4)+SUBSTR(DTOC(ifEc), 4,  ;
                          2)+SUBSTR(DTOC(ifEc), 1, 2)
                     SET NEAR OFF
                     DO WHILE  .NOT. EOF() .AND. f3530dat<=ufEc
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          IF f3530est="9" .OR. f3530tpo=2 .OR. f3530tpo=3
                               SKIP
                               LOOP
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  BANCOS "+ ;
                             f3530ano+"-"+f3530mes+"-"+f3530num+ ;
                             "...Presionar ESC para Salir..."
                          STORE f3530ano TO vaNo
                          STORE f3530mes TO vmEs
                          STORE f3530ser TO vsEr
                          STORE f3530num TO vnUm
                          STORE f3530mon TO vmNd
                          STORE f3530tip TO vtIp
                          STORE f3530nti TO vnTi
                          STORE f3530tca TO vtCa
                          STORE f3530glo TO vgLo
                          STORE f3530rcb TO vrCb
                          STORE f3530nba TO vnBa
                          STORE f3530nct TO vnCt
                          STORE f3530che TO vcHe
                          STORE f3530dat TO vdAt
                          STORE CTOD(f3530dia+"/"+f3530mes+"/"+f3530ano)  ;
                                TO vfCa
                          SELECT deT_ing_bancos
                          SEEK vaNo+vmEs+vsEr+vnUm
                          DO WHILE  .NOT. EOF() .AND. f3531ano+f3531mes+ ;
                             f3531ser+f3531num=vaNo+vmEs+vsEr+vnUm
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               STORE f3531tdo TO vtDo
                               STORE f3531sr1 TO vsR1
                               STORE f3531doc TO vdOc
                               STORE f3531pag TO vaCu
                               SELECT peNd_vtas
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    STORE 0 TO vtOt, vsLd
                                    STORE 1 TO vmOn
                                    STORE "00" TO vfPa
                                    STORE SPACE(70) TO vnOm, vnFp, vnVe
                                    STORE CTOD("  /  /    ") TO vfEm, vfVe
                               ELSE
                                    STORE f3500nom TO vnOm
                                    STORE f3500fem TO vfEm, vfVe
                                    STORE f3500fpa TO vfPa
                                    STORE f3500nfp TO vnFp
                                    STORE f3500nve TO vnVe
                                    STORE f3500mon TO vmOn
                                    STORE f3500tot TO vtOt
                                    STORE f3500tot+f3500int-f3500acu TO vsLd
                               ENDIF
                               IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                                    STORE vtOt*-1 TO vtOt
                                    STORE vaCu*-1 TO vaCu
                               ENDIF
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc+STR(vgRu, 1, 0)+ ;
                                    STR(vcAj, 2, 0)+vsR1+vnUm
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1gru WITH vgRu
                                    REPLACE ftM1caj WITH vcAj
                                    REPLACE ftM1sr1 WITH vsR1
                                    REPLACE ftM1num WITH vnUm
                                    REPLACE ftM1fem WITH vfEm
                                    REPLACE ftM1fca WITH vfCa
                                    REPLACE ftM1dat WITH vdAt
                                    REPLACE ftM1dat WITH vdAt
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1fpa WITH vfPa
                                    REPLACE ftM1nfp WITH vnFp
                                    REPLACE ftM1nve WITH vnVe
                                    REPLACE ftM1dnc WITH 0
                                    REPLACE ftM1tip WITH vtIp
                                    REPLACE ftM1nti WITH vnTi
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1mnd WITH vmNd
                                    REPLACE ftM1tca WITH vtCa
                                    REPLACE ftM1acu WITH vaCu
                                    REPLACE ftM1sld WITH vsLd
                                    REPLACE ftM1glo WITH vgLo
                                    REPLACE ftM1che WITH vcHe
                                    REPLACE ftM1nba WITH vnBa
                                    REPLACE ftM1nct WITH vnCt
                                    REPLACE ftM1rcb WITH vrCb
                                    SELECT teMporal_2
                                    SEEK STR(vcAj, 2, 0)+STR(vgRu, 1, 0)+ ;
                                     vtIp+vfPa
                                    IF EOF()
                                         APPEND BLANK
                                         REPLACE ftM2caj WITH vcAj
                                         REPLACE ftM2gru WITH vgRu
                                         REPLACE ftM2tip WITH vtIp
                                         REPLACE ftM2nti WITH vnTi
                                         REPLACE ftM2fpa WITH vfPa
                                         REPLACE ftM2nfp WITH vnFp
                                         REPLACE ftM2ho1 WITH 0
                                         REPLACE ftM2ho2 WITH 0
                                         REPLACE ftM2ot1 WITH 0
                                         REPLACE ftM2ot2 WITH 0
                                         REPLACE ftM2to1 WITH 0
                                         REPLACE ftM2to2 WITH 0
                                    ENDIF
                                    DO CASE
                                         CASE vmNd=1
                                              REPLACE ftM2to1 WITH ftM2to1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2to2 WITH ftM2to2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE vmNd=1 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              REPLACE ftM2ho1 WITH ftM2ho1+vaCu
                                         CASE vmNd=2 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              REPLACE ftM2ho2 WITH ftM2ho2+vaCu
                                         CASE vmNd=1
                                              REPLACE ftM2ot1 WITH ftM2ot1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2ot2 WITH ftM2ot2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE AT("CHEQ",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND.  ;
                                          vmNd=1 .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE vcH1+vaCu TO vcH1
                                         CASE AT("CHEQ",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND.  ;
                                          vmNd=2 .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE vcH2+vaCu TO vcH2
                                         CASE AT("CHEQ",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND. vmNd=1
                                              STORE vcH3+vaCu TO vcH3
                                         CASE AT("CHEQ",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND. vmNd=2
                                              STORE vcH4+vaCu TO vcH4
                                         CASE AT("DEPO",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND.  ;
                                          vmNd=1 .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE vdP1+vaCu TO vdP1
                                         CASE AT("DEPO",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND.  ;
                                          vmNd=2 .AND. vfEm>=ifEc .AND.  ;
                                          vfEm<=ufEc
                                              STORE vdP2+vaCu TO vdP2
                                         CASE AT("DEPO",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND. vmNd=1
                                              STORE vdP3+vaCu TO vdP3
                                         CASE AT("DEPO",  ;
                                          UPPER(ALLTRIM(vnTi)))<>0 .AND. vmNd=2
                                              STORE vdP4+vaCu TO vdP4
                                         CASE vmNd=1 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              STORE voT1+vaCu TO voT1
                                         CASE vmNd=2 .AND. vfEm>=ifEc  ;
                                          .AND. vfEm<=ufEc
                                              STORE voT2+vaCu TO voT2
                                         CASE vmNd=1
                                              STORE voT3+vaCu TO voT3
                                         CASE vmNd=2
                                              STORE voT4+vaCu TO voT4
                                    ENDCASE
                               ENDIF
                               SELECT deT_ing_bancos
                               SKIP
                          ENDDO
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          SELECT caB_ing_bancos
                          SKIP
                     ENDDO
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     SELECT caB_fact
                     SET NEAR ON
                     SEEK SUBSTR(DTOC(ifEc), 7, 4)+SUBSTR(DTOC(ifEc), 4,  ;
                          2)+SUBSTR(DTOC(ifEc), 1, 2)
                     SET NEAR OFF
                     DO WHILE  .NOT. EOF() .AND. f1300dat<=ufEc
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          IF f1300tdo="CT"
                               SKIP
                               LOOP
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  "+f1300tdo+":"+ ;
                             f1300ser+"-"+f1300doc+ ;
                             "...Presionar ESC para Salir..."
                          STORE f1300tdo TO vtDo
                          STORE f1300ser TO vsR1
                          STORE f1300doc TO vdOc
                          STORE f1300nom TO vnOm
                          STORE f1300mon TO vmOn
                          STORE f1300tot TO vtOt
                          STORE f1300fpa TO vfPa
                          STORE f1300nfp TO vnFp
                          STORE f1300fem TO vfEm
                          STORE f1300dat TO vdAt
                          STORE CTOD("  /  /    ") TO vfCa
                          IF f1300est="9"
                               STORE 0 TO vtOt
                               STORE "ANULADO" TO vnOm
                          ENDIF
                          SELECT teMporal
                          SEEK vtDo+vsR1+vdOc
                          IF EOF()
                               APPEND BLANK
                               REPLACE ftM1tdo WITH vtDo
                               REPLACE ftM1ser WITH vsR1
                               REPLACE ftM1doc WITH vdOc
                               REPLACE ftM1fem WITH vfEm
                               REPLACE ftM1fca WITH vfCa
                               REPLACE ftM1dat WITH vdAt
                               REPLACE ftM1fpa WITH vfPa
                               REPLACE ftM1nfp WITH vnFp
                               REPLACE ftM1caj WITH 0
                               REPLACE ftM1gru WITH 0
                               REPLACE ftM1nom WITH vnOm
                               REPLACE ftM1mon WITH vmOn
                               REPLACE ftM1mnd WITH 1
                               REPLACE ftM1dnc WITH 0
                               REPLACE ftM1tot WITH vtOt
                               REPLACE ftM1acu WITH 0
                               REPLACE ftM1sld WITH vtOt
                               REPLACE ftM1tca WITH 1
                          ENDIF
                          SELECT caB_fact
                          SKIP
                     ENDDO
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     SELECT caB_notas
                     SET NEAR ON
                     SEEK SUBSTR(DTOC(ifEc), 7, 4)+SUBSTR(DTOC(ifEc), 4,  ;
                          2)+SUBSTR(DTOC(ifEc), 1, 2)
                     SET NEAR OFF
                     DO WHILE  .NOT. EOF() .AND. f3610dat<=ufEc
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  "+f3610tdo+":"+ ;
                             f3610ser+"-"+f3610doc+ ;
                             "...Presionar ESC para Salir..."
                          STORE f3610tdo TO vtDo
                          STORE f3610ser TO vsR1
                          STORE f3610doc TO vdOc
                          STORE f3610nom TO vnOm
                          STORE f3610fem TO vfEm
                          STORE f3610mon TO vmOn
                          STORE f3610tot TO vtOt
                          STORE f3610dat TO vdAt
                          STORE CTOD("  /  /    ") TO vfCa
                          IF f3610est="9"
                               STORE 0 TO vtOt
                               STORE "ANULADO" TO vnOm
                          ENDIF
                          IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                               STORE vtOt*-1 TO vtOt
                          ENDIF
                          SELECT teMporal
                          SEEK vtDo+vsR1+vdOc
                          IF EOF()
                               APPEND BLANK
                               REPLACE ftM1tdo WITH vtDo
                               REPLACE ftM1ser WITH vsR1
                               REPLACE ftM1doc WITH vdOc
                               REPLACE ftM1fem WITH vfEm
                               REPLACE ftM1fca WITH vfCa
                               REPLACE ftM1dat WITH vdAt
                               REPLACE ftM1fpa WITH "00"
                               REPLACE ftM1caj WITH 0
                               REPLACE ftM1gru WITH 0
                               REPLACE ftM1nom WITH vnOm
                               REPLACE ftM1mon WITH vmOn
                               REPLACE ftM1mnd WITH 1
                               REPLACE ftM1dnc WITH 0
                               REPLACE ftM1tot WITH vtOt
                               REPLACE ftM1acu WITH 0
                               REPLACE ftM1sld WITH vtOt
                               REPLACE ftM1tca WITH 1
                          ENDIF
                          SELECT caB_notas
                          SKIP
                     ENDDO
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     SELECT caB_ing_caja
                     STORE 01 TO meRr
                     SET ORDER TO F3510LET
                     STORE 00 TO meRr
                     STORE k_Tab TO mkEy
                     STORE "LE" TO vtDo
                     SELECT leTras
                     SET NEAR ON
                     SEEK SUBSTR(DTOC(ifEc), 7, 4)+SUBSTR(DTOC(ifEc), 4,  ;
                          2)+SUBSTR(DTOC(ifEc), 1, 2)
                     SET NEAR OFF
                     DO WHILE  .NOT. EOF() .AND. f3110dat<=ufEc
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          IF f3110est="9"
                               SKIP
                               LOOP
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  LE:"+f3110ser+ ;
                             "-"+f3110let+"..."+CHR(13)+CHR(13)+ ;
                             "Presionar ESC para Salir..."
                          STORE f3110ser TO vsR1
                          STORE f3110let TO vdOc
                          STORE f3110nom TO vnOm
                          STORE f3110mon TO vmOn
                          STORE f3110tot TO vtOt
                          STORE f3110fem TO vfEm
                          STORE f3110dat TO vdAt
                          STORE CTOD("  /  /    ") TO vfCa
                          SELECT caB_ing_caja
                          SEEK vsR1+vdOc
                          IF EOF()
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1gru WITH 0
                                    REPLACE ftM1dnc WITH 0
                                    REPLACE ftM1glo WITH "Emitida n/canjeada"
                                    REPLACE ftM1fem WITH vfEm
                                    REPLACE ftM1fca WITH vfCa
                                    REPLACE ftM1dat WITH vdAt
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1mnd WITH vmOn
                                    REPLACE ftM1sld WITH 0
                                    REPLACE ftM1tca WITH 1
                                    REPLACE ftM1acu WITH 0
                               ENDIF
                          ENDIF
                          SELECT leTras
                          SKIP
                     ENDDO
                     SELECT caB_ing_caja
                     STORE 01 TO meRr
                     SET ORDER TO F3510DAT
                     STORE 00 TO meRr
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     RESTORE SCREEN FROM vpAn_11
                     IF mkEy=k_Esc .OR. mkEy=99
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                ENDIF
                SELECT teMporal
                GOTO TOP
                IF BOF() .OR. EOF()
                     STORE "No hay datos registrados entre esta fecha..."  ;
                           TO mmSj
                ELSE
                     STORE "**" TO ctDo, csEr, cdOc
                     DO WHILE  .NOT. EOF()
                          IF ctDo+csEr+cdOc=ftM1tdo+ftM1ser+ftM1doc
                               SKIP
                               LOOP
                          ENDIF
                          STORE ftM1tdo TO ctDo
                          STORE ftM1ser TO csEr
                          STORE ftM1doc TO cdOc
                          DO CASE
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vfA1+ftM1tot TO vfA1
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vfA2+ftM1tot TO vfA2
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=1
                                    STORE vfA3+ftM1tot TO vfA3
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=2
                                    STORE vfA4+ftM1tot TO vfA4
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vbO1+ftM1tot TO vbO1
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vbO2+ftM1tot TO vbO2
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=1
                                    STORE vbO3+ftM1tot TO vbO3
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=2
                                    STORE vbO4+ftM1tot TO vbO4
                               CASE ftM1tdo="NP" .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnP1+ftM1tot TO vnP1
                               CASE ftM1tdo="NP" .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnP2+ftM1tot TO vnP2
                               CASE ftM1tdo="NP" .AND. ftM1mon=1
                                    STORE vnP3+ftM1tot TO vnP3
                               CASE ftM1tdo="NP" .AND. ftM1mon=2
                                    STORE vnP4+ftM1tot TO vnP4
                               CASE ftM1tdo="PC" .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vpE1+ftM1tot TO vpE1
                               CASE ftM1tdo="PC" .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vpE2+ftM1tot TO vpE2
                               CASE ftM1tdo="PC" .AND. ftM1mon=1
                                    STORE vpE3+ftM1tot TO vpE3
                               CASE ftM1tdo="PC" .AND. ftM1mon=2
                                    STORE vpE4+ftM1tot TO vpE4
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnC1+ftM1tot TO vnC1
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnC2+ftM1tot TO vnC2
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=1
                                    STORE vnC3+ftM1tot TO vnC3
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=2
                                    STORE vnC4+ftM1tot TO vnC4
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=1 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnD1+ftM1tot TO vnD1
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=2 .AND.  ;
                                    ftM1fem>=ifEc .AND. ftM1fem<=ufEc
                                    STORE vnD2+ftM1tot TO vnD2
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=1
                                    STORE vnD3+ftM1tot TO vnD3
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=2
                                    STORE vnD4+ftM1tot TO vnD4
                          ENDCASE
                          SKIP
                     ENDDO
                     GOTO TOP
                     STORE ifEc TO ciFe
                     STORE ufEc TO chFe
                     DO prEsiona WITH "4", "R_CONS06", mmF1, mmC1
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "MOVIMI", mmF2, mmC2
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "EXCEL", mmF1+2, 0
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET READBORDER OFF
                     DO pcC3551b WITH "3"
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET READBORDER ON
                     DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "MOVIM0", mmF2, mmC2
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET COLOR TO RGB(0,0,0,224,226,209)
                     @ mmF1, 0 CLEAR TO mmF1+3.1, 3.200
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      DO coLbln
      STORE k_Enter TO mkEy
      @iFIL-4,iCLN+08 Get iFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
      @iFIL-4,iCLN+28 Get uFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE P00_3553a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mfI0+1 TO mfI0
 STORE mcO0+muCo-14 TO mmC2
 STORE mcO0+0.4 TO icLn
 STORE mcO0+muCo TO ucLn
 STORE (mwCo-188.9)/2 TO icL1
 STORE icL1+188.4 TO ucL1
 STORE mfI0+01.3 TO ifIl, ufIl, vfIl
 STORE ifIl+(INT(muFi)-4) TO ffIl
 STORE ffIl-7 TO ffIl
 STORE ifIl+1 TO ifFs, ufFs, vfFs
 STORE ffIl TO ffFs
 STORE ffIl+8.4 TO mmF2
 STORE ffIl+01.3 TO vfI2
 DO tiT_0000a WITH "Cancelaciones x Fechas de Digitacion"
 DO coLsc1
 DO cuAdro WITH mfI0, icLn, ffIl+8.9, ucLn
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(0,0,0,224,226,209)
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 DO prEsiona WITH "1", "OPCIO2", mfI0-3.3, icLn-0.6
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLsc3
 @iFIL-4,iCLN+01 Say "Del" Font "&mLetRom",13 Style "BT"
 @iFIL-4,iCLN+23 Say "al"  Font "&mLetRom",13 Style "BT"
 DO liN_3551a IN PCC3551A WITH ifIl-1.6, ffIl+1.1
 DO li1_3551a IN PCC3551A WITH ifIl-0.2, ffIl+1.1
 @ ifIl-0.2, icLn TO ifIl-0.2, ucLn
 @ ffIl+1.1, icLn TO ffIl+1.1, ucLn
 DO coLblz
 @iFIL-1.2,iCLN+04.0 Say "Documento" Font "&mLetAri",9 Style "BT"
 @iFIL-1.2,iCLN+21.6 Say "Emisin"   Font "&mLetAri",9 Style "BT"
 DO CASE
      CASE mrEs="3"
           @iFIL-1.2,iCLN+046.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+073.8 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+086.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+107.8 Say "Cheque/Deps"    Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+126.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+150.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+169.5 Say "Saldo"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+185.5 Say "Digitado"        Font "&mLetAri",9 Style "BT"
      CASE mrEs="4"
           @iFIL-1.2,iCLN+051.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+083.7 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+106.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+137.8 Say "F.Pago"          Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+154.0 Say "Cheque/Depsito" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+178.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+203.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+223.1 Say "Saldo"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+238.5 Say "Digitado"        Font "&mLetAri",9 Style "BT"
      OTHERWISE
           @iFIL-1.2,iCLN+051.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+083.8 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+106.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+140.8 Say "Forma de Pago"   Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+170.0 Say "Cheque/Depsito" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+195.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+220.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+240.1 Say "Saldo"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+255.5 Say "Digitado"        Font "&mLetAri",9 Style "BT"
 ENDCASE
 DO toT_3551a IN PCC3551A
 DO coLbln
 @iFIL-4,iCLN+08 Get iFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
 @iFIL-4,iCLN+28 Get uFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "MOVIM0", mmF2, mmC2
 IF mkEy=k_Esc
      RETURN
 ENDIF
ENDPROC
*
PROCEDURE Res_3553a
 DO p00_3553a WITH "1"
 IF mkEy=k_Esc
      EXIT
 ENDIF
 IF LEN(ALLTRIM(inUm))<>0
      STORE 00 TO cfIl
      STORE ifIl TO vfIl
      DO muE_3551b IN PCC3551B WITH "v", "c"
      SELECT teMporal
      DO seE_3551b IN PCC3551B WITH "i"
      DO WHILE  .NOT. EOF() .AND. vfIl<ffIl+1
           IF ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj, 2,  ;
              0)+ftM1sr1+ftM1num=vtDo+vsEr+vdOc+STR(vgRu, 1, 0)+STR(vcAj,  ;
              2, 0)+vsR1+vnUm
                STORE vfIl TO cfIl
                EXIT
           ENDIF
           STORE vfIl+1 TO vfIl
           SKIP
      ENDDO
      IF cfIl=0
           DO muE_3551b IN PCC3551B WITH "v", "i"
           DO muE_3551b IN PCC3551B WITH "v", "c"
           STORE ifIl TO vfIl, cfIl
      ENDIF
      DO seE_3551b IN PCC3551B WITH "i"
      DO paN_3551b IN PCC3551B
      IF mkEy=k_Esc
           RETURN
      ENDIF
      STORE cfIl TO vfIl
      DO muE_3551b IN PCC3551B WITH "c", "v"
      DO seE_3551b IN PCC3551B WITH "v"
      DO toT_3551a IN PCC3551A
 ENDIF
ENDPROC
*
PROCEDURE Hl1_3553a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Esta consulta muestra todos los Movimientos de Ventas del rango de Fechas"
 @ pfIl+01, 02 SAY "de digitacion y su forma de cancelacin o pago a cuenta."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 18 SAY ":" STYLE "BT"
 @ pfIl+06, 18 SAY ":" STYLE "BT"
 @ pfIl+07, 18 SAY ":" STYLE "BT"
 @ pfIl+08, 18 SAY ":" STYLE "BT"
 @ pfIl+05, 02 SAY "ESC" STYLE "BT"
 @ pfIl+06, 02 SAY "F10" STYLE "BT"
 @ pfIl+07, 02 SAY "F1" STYLE "BT"
 @ pfIl+08, 02 SAY "ENTER, TAB," STYLE "BT"
 @ pfIl+09, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+05, 20 SAY "Regresar al Men Principal"
 @ pfIl+06, 20 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 20 SAY "Ayuda del Programa"
 @ pfIl+08, 20 SAY "Consultar a partir de lo digitado, si es mayor a lo regis-"
 @ pfIl+09, 20 SAY "trado va al final del Archivo"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE vsW0, vsW1, vsW2, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
         ffFs, cfFs
 RELEASE icLn, ucLn, icL1, ucL1, vfI2, vpAg, vlIn, vtDo, itDo, utDo, ctDo,  ;
         vsEr, isEr
 RELEASE usEr, csEr, vdOc, idOc, udOc, cdOc, vcAj, icAj, ucAj, ccAj, vgRu,  ;
         igRu, ugRu
 RELEASE cgRu, vsR1, isR1, usR1, csR1, vnUm, inUm, unUm, cnUm, vgR1, igR1,  ;
         ugR1, vcJj
 RELEASE icJj, ucJj, vtIp, itIp, utIp, ifEc, ufEc, ciFe, chFe, vmOn, vmNd,  ;
         vtCa, vgLo
 RELEASE vsRl, vlEt, vrCb, vpGo, vcHe, vaCu, vtOt, xtOt, vsLd, vfPa, ifPa,  ;
         ufPa, vnFp
 RELEASE vnOm, vfEm, vnTi, vdNc, vsG1, vsG2, voPc, vtPo, veF1, veF2, veF3,  ;
         veF4, vcH1
 RELEASE vcH2, vcH3, vcH4, vdP1, vdP2, vdP3, vdP4, voT1, voT2, voT3, voT4,  ;
         vfA1, vfA2
 RELEASE vfA3, vfA4, vbO1, vbO2, vbO3, vbO4, vnP1, vnP2, vnP3, vnP4, vpE1,  ;
         vpE2, vpE3
 RELEASE vpE4, vnC1, vnC2, vnC3, vnC4, vnD1, vnD2, vnD3, vnD4, vnVe, vxLs,  ;
         vaNo, vmEs
 RELEASE vdAt, vfCa
 RELEASE vpAn_11, vpAn_12
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 RELEASE ntM1, ntM2
ENDPROC
*
