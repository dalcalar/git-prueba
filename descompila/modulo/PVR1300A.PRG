 SET CENTURY ON
 PUBLIC ntM1, ntM2, ntM3, ntM4, ntM5, ntM6, ntM7, ntM8, ntM9, ntM0
 PUBLIC afIl, x
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE "0002" TO ntM3
 STORE "0003" TO ntM4
 STORE "0004" TO ntM5
 STORE "0005" TO ntM6
 STORE "0006" TO ntM7
 STORE "0007" TO ntM8
 STORE "0008" TO ntM9
 STORE "0009" TO ntM0
 STORE 01 TO meRr
 DIMENSION afIl[33, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM1GRU"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NGR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NTI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEM"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FVE"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CLI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TIT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NTT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1VEN"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DCT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1COD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DES"
 afIl[x, 2] = "C"
 afIl[x, 3] = 80
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NUV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 25
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1IMP"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TPO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TPR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NTP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1PRO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CAN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1PRE"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ALM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0) TAG ftM1doc
 INDEX ON ALLTRIM(ftM1cli)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1cli
 INDEX ON ALLTRIM(ftM1ruc)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1ruc
 INDEX ON ALLTRIM(ftM1tip)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1tip
 INDEX ON ALLTRIM(ftM1ven)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1ven
 INDEX ON ALLTRIM(ftM1fpa)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1fpa
 INDEX ON ALLTRIM(ftM1tpr)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1tpr
 INDEX ON ALLTRIM(ftM1cod)+"*"+ftM1tdo+ftM1ser+ftM1doc+STR(RECNO(), 7, 0)  ;
       TAG ftM1cod
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[17, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM2TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FEM"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FVE"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NTT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2MON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2SIG"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 6
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2ALM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM2tdo+ftM2ser+ftM2doc TAG ftM2doc
 INDEX ON UPPER(ftM2nom)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2nom
 INDEX ON UPPER(ftM2ntt)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2ntt
 INDEX ON UPPER(ftM2nfp)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2nfp
 INDEX ON UPPER(ftM2nve)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2nve
 INDEX ON UPPER(ftM2ruc)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2ruc
 INDEX ON STR(ftM2to1, 16, 2)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2to1
 INDEX ON STR(ftM2to2, 16, 2)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2to2
 INDEX ON STR(ftM2mon, 1, 0)+STR(ftM2tot, 16, 2)+ftM2tdo+ftM2ser+ftM2doc  ;
       TAG ftM2tot
 INDEX ON SUBSTR(DTOC(ftM2fem), 7, 4)+SUBSTR(DTOC(ftM2fem), 4, 2)+ ;
       SUBSTR(DTOC(ftM2fem), 1, 2)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2fem
 INDEX ON SUBSTR(DTOC(ftM2fve), 7, 4)+SUBSTR(DTOC(ftM2fve), 4, 2)+ ;
       SUBSTR(DTOC(ftM2fve), 1, 2)+ftM2tdo+ftM2ser+ftM2doc TAG ftM2fve
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[12, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM3COD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 120
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NUV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 25
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3CAN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3FA1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3FA2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3BO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3BO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NP1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NP2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE "TM01"+ntM3+meXt TO mdBf
 DO WHILE .T.
      ntM3 = STRTRAN(STR(VAL(ntM3)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM3+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM3="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM3cod)+"*" TAG ftM3cod
 INDEX ON UPPER(ftM3nom)+ALLTRIM(ftM3cod)+"*" TAG ftM3nom
 INDEX ON STR(ftM3can, 16, 4)+UPPER(ftM3nom)+ALLTRIM(ftM3cod)+"*" TAG ftM3can
 INDEX ON STR(ftM3to1, 16, 2)+UPPER(ftM3nom)+ALLTRIM(ftM3cod)+"*" TAG ftM3to1
 INDEX ON STR(ftM3to2, 16, 2)+UPPER(ftM3nom)+ALLTRIM(ftM3cod)+"*" TAG ftM3to2
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM4+meXt TO mdBf
 DO WHILE .T.
      ntM4 = STRTRAN(STR(VAL(ntM4)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM4+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM4="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM5+meXt TO mdBf
 DO WHILE .T.
      ntM5 = STRTRAN(STR(VAL(ntM5)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM5+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM5="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM6+meXt TO mdBf
 DO WHILE .T.
      ntM6 = STRTRAN(STR(VAL(ntM6)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM6+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM6="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           DO deL_file2 WITH "5", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM7+meXt TO mdBf
 DO WHILE .T.
      ntM7 = STRTRAN(STR(VAL(ntM7)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM7+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM7="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           DO deL_file2 WITH "5", "S"
           DO deL_file2 WITH "6", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM8+meXt TO mdBf
 DO WHILE .T.
      ntM8 = STRTRAN(STR(VAL(ntM8)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM8+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM8="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           DO deL_file2 WITH "5", "S"
           DO deL_file2 WITH "6", "S"
           DO deL_file2 WITH "7", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM9+meXt TO mdBf
 DO WHILE .T.
      ntM9 = STRTRAN(STR(VAL(ntM9)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM9+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM9="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           DO deL_file2 WITH "5", "S"
           DO deL_file2 WITH "6", "S"
           DO deL_file2 WITH "7", "S"
           DO deL_file2 WITH "8", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 DO tmP_1300a
 STORE "TM01"+ntM0+meXt TO mdBf
 DO WHILE .T.
      ntM0 = STRTRAN(STR(VAL(ntM0)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM0+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM0="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           DO deL_file2 WITH "4", "S"
           DO deL_file2 WITH "5", "S"
           DO deL_file2 WITH "6", "S"
           DO deL_file2 WITH "7", "S"
           DO deL_file2 WITH "8", "S"
           DO deL_file2 WITH "9", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM4cod)+"*"+ALLTRIM(ftM4cdg)+"*" TAG ftM4cdg
 INDEX ON ALLTRIM(ftM4cod)+"*"+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+"*" TAG ftM4dcr
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ctd
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt1
 INDEX ON ALLTRIM(ftM4cod)+"*"+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4tt2
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+ALLTRIM(ftM4cdg)+"*" TAG ftM4cd1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+UPPER(ftM4dcr)+ALLTRIM(ftM4cdg)+ ;
       "*" TAG ftM4dc1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4ctd, 16, 4)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4ct1
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt1, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t11
 INDEX ON ALLTRIM(ftM4cod)+"*"+ftM4tpo+STR(ftM4tt2, 16, 2)+UPPER(ftM4dcr)+ ;
       ALLTRIM(ftM4cdg)+"*" TAG ftM4t12
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 DO coLbln
 STORE 99 TO mkEy
 SELECT 1
 @ 1, 1 SAY "Abriendo Archivo 1/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 GOTO TOP
 IF BOF() .OR. EOF()
      STORE "Archivo de Documentos de Ventas no puede estar vacío" TO mmSj
      STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
            "PRESIONAR UNA TECLA PARA REGRESAR AL MENÚ..." TO mmSj
      WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
      WAIT CLEAR
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 @ 1, 1 SAY "Abriendo Archivo 2/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1301", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1301DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 @ 1, 1 SAY "Abriendo Archivo 3/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1101", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Clientes
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1101COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 @ 1, 1 SAY "Abriendo Archivo 4/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 @ 1, 1 SAY "Abriendo Archivo 5/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "3610", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Nota
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3610FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 @ 1, 1 SAY "Abriendo Archivo 6/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9110", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tipo_Cl
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9110TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 @ 1, 1 SAY "Abriendo Archivo 7/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9111", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cambio
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9111FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 @ 1, 1 SAY "Abriendo Archivo 8/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9211", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tip_Prod
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9211TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 @ 1, 1 SAY "Abriendo Archivo 9/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9216", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Grupos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9216COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 @ 1, 1 SAY "Abriendo Archivo 10/20..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9991", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tiendas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9991COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 11
 @ 1, 1 SAY "Abriendo Archivo 11/20..." STYLE "BQ"
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 12
 @ 1, 1 SAY "Abriendo Archivo 12/20..." STYLE "BQ"
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_2
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM2DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 13
 @ 1, 1 SAY "Abriendo Archivo 13/20..." STYLE "BQ"
 STORE "TM01"+ntM3+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_3
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 14
 @ 1, 1 SAY "Abriendo Archivo 14/20..." STYLE "BQ"
 STORE "TM01"+ntM4+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_4
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 15
 @ 1, 1 SAY "Abriendo Archivo 15/20..." STYLE "BQ"
 STORE "TM01"+ntM5+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_5
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 16
 @ 1, 1 SAY "Abriendo Archivo 16/20..." STYLE "BQ"
 STORE "TM01"+ntM6+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_6
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 17
 @ 1, 1 SAY "Abriendo Archivo 17/20..." STYLE "BQ"
 STORE "TM01"+ntM7+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_7
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 18
 @ 1, 1 SAY "Abriendo Archivo 18/20..." STYLE "BQ"
 STORE "TM01"+ntM8+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_8
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 19
 @ 1, 1 SAY "Abriendo Archivo 19/20..." STYLE "BQ"
 STORE "TM01"+ntM9+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_9
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 20
 @ 1, 1 SAY "Abriendo Archivo 20/20..." STYLE "BQ"
 STORE "TM01"+ntM0+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_10
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 21 TO muLt
 STORE 00 TO meRr
 PUBLIC viTe, viT1, ciTx, vsW0, csW0, vsW1, vsW2, vsW3, csW3, vsW4, csW4,  ;
        vsW5, csW5
 PUBLIC vsW6, vpAg, vlIn, vxLs, voPc, coPc, voPf, coPf, voPb, coPb, voPn,  ;
        coPn, voPd
 PUBLIC coPd, vuLt, dfEm, hfEm, cdFe, chFe, vfI1, vfI2, vfI3, vfI4, vfI5,  ;
        vfI6, vfI7
 PUBLIC vfI8, vfI9, vfI0, vcO1, vcL1, vcL2, vcL3, vcL4, vcL5, vcL6, vcL7,  ;
        vcL8, vcL9
 PUBLIC vcL0, vcLa, vnUf, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
        ffFs, cfFs
 PUBLIC vfFr, ifFr, ufFr, ffFr, cfFr, daNo, dmEs, ddIa, vcLi, vnCl, vtIt,  ;
        vdNi, vfPa
 PUBLIC vvEn, vpIg, vtCa, vdEs, vnUv, vnVv, vgRu, vnGr, vtPr, vnTp, vtIp,  ;
        vnTi, viMp
 PUBLIC vpRo, vnUm, vtDo, itDo, utDo, vsEr, isEr, usEr, dsEr, hsEr, cdSe,  ;
        chSe, vdOc
 PUBLIC idOc, udOc, vfEm, ifEm, ufEm, vfVe, ifVe, ufVe, vrUc, irUc, urUc,  ;
        vnOm, inOm
 PUBLIC unOm, xnOm, ynOm, znOm, vnVe, inVe, unVe, vnFp, inFp, unFp, vnTt,  ;
        inTt, unTt
 PUBLIC vmOn, imOn, umOn, vtOt, itOt, utOt, tsOl, tsO1, tuSd, tuS1, vtO1,  ;
        itO1, utO1
 PUBLIC ttO1, xtO1, ytO1, ztO1, vtO2, itO2, utO2, ttO2, xtO2, ytO2, ztO2,  ;
        vtT1, itT1
 PUBLIC utT1, xtT1, ttT1, vtT2, itT2, utT2, xtT2, ttT2, vcOd, icOd, ucOd,  ;
        xcOd, ycOd
 PUBLIC zcOd, dcOd, hcOd, vcDg, icDg, ucDg, xcDg, hcDg, dcDg, vcAn, icAn,  ;
        ucAn, xcAn
 PUBLIC ycAn, zcAn, vcTd, icTd, ucTd, xcTd, vdCr, idCr, udCr, xdCr, vtPo,  ;
        vtTt, vtD1
 PUBLIC vtD2, vtD3, vtD4, vtD5, vt11, vt12, vt21, vt22, vt31, vt32, vt41,  ;
        vt42, vhOr
 PUBLIC tvAl, vpOr, tfA1, tfA2, tbO1, tbO2, tnP1, tnP2, vpT2, vpT3, vpT4,  ;
        vpT5, vaL2
 PUBLIC vaL3, vaL4, vaL5, vaLt, vaLm, vnO1, vnO2, vnO3, vnO4, vnO5, vaA1,  ;
        vaA2, vaA3
 PUBLIC vaA4, vaA5, caA1, caA2, caA3, caA4, caA5, vaB1, vaB2, vaB3, vaB4, vaB5
 PUBLIC vpAn_11, vpAn_12, vpAn_13, vpAn_99
 SELECT caB_fact
 GOTO BOTTOM
 STORE 01 TO voPf, voPb, voPn, voPd
 STORE 00 TO vaL2, vaL3, vaL4, vaL5
 STORE 00 TO vaA2, vaA3, vaA4, vaA5
 STORE 00 TO coPf, coPb, coPn, coPd, coPc
 STORE 00 TO vaB1, vaB2, vaB3, vaB4, vaB5
 STORE 01 TO vsW6, voPc, viTe, vaA1, vaLt
 STORE 99 TO mkEy, caA1, caA2, caA3, caA4, caA5
 STORE "000" TO dsEr
 STORE "ZZZ" TO hsEr
 STORE f1300fem TO hfEm
 STORE CTOD("01"+SUBSTR(DTOC(hfEm), 3, 8)) TO dfEm
 STORE CTOD("  /  /    ") TO cdFe, chFe
 STORE SPACE(30) TO vnO1, vnO2, vnO3, vnO4, vnO5
 STORE SPACE(30) TO cdSe, chSe, vpT2, vpT3, vpT4, vpT5
 @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO1)+"..." STYLE "BQ"
 SELECT tiEndas
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE f9991cod TO vcOd
      DO CASE
           CASE vcOd="01"
                STORE f9991nom TO vnO1
                SKIP
                LOOP
           CASE vcOd="02"
                SKIP
                LOOP
           CASE vcOd="03"
                STORE f9991nom TO vnO2
                STORE f9991pth TO vpT2
           CASE vcOd="04"
                STORE f9991nom TO vnO3
                STORE f9991pth TO vpT3
           CASE vcOd="05"
                STORE f9991nom TO vnO4
                STORE f9991pth TO vpT4
           CASE vcOd="06"
                STORE f9991nom TO vnO5
                STORE f9991pth TO vpT5
           OTHERWISE
                EXIT
      ENDCASE
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact2
                STORE 1 TO vaL2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact3
                STORE 1 TO vaL3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact4
                STORE 1 TO vaL4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact5
                STORE 1 TO vaL5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1300FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1301DOC
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3610FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      SELECT tiEndas
      SKIP
 ENDDO
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 WAIT CLEAR
 SET READBORDER ON
 DO p00_1300a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO p00_1300a WITH "1"
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_1300a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hlP_1300a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO p00_1300a WITH "1"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Ctrl_home .AND. viTe=1
                STORE "Estás en el primer campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=4
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_left
                STORE "No hay campos a la izquierda..." TO mmSj
           CASE mkEy=k_Up .AND. viTe=1
                STORE "No hay más campos arriba..." TO mmSj
           CASE mkEy=k_Esc .OR. mkEy=k_Ctrl_home
                STORE 99 TO mkEy
                STORE 01 TO viTe
           CASE mkEy=k_Up
                STORE viTe-1 TO viTe
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Ctrl_right
                DO veR_1300a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     DO CASE
                          CASE viTe=4
                               SAVE SCREEN TO vpAn_11
                               DO CASE
                                    CASE voPc=1
                                         DO pvR1300b
                                    OTHERWISE
                                         DO pvR1300c
                               ENDCASE
                               STORE dfEm TO cdFe
                               STORE hfEm TO chFe
                               STORE dsEr TO cdSe
                               STORE hsEr TO chSe
                               STORE vaA1 TO caA1
                               STORE vaA2 TO caA2
                               STORE vaA3 TO caA3
                               STORE vaA4 TO caA4
                               STORE vaA5 TO caA5
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               RESTORE SCREEN FROM vpAn_11
                          OTHERWISE
                               STORE viTe+1 TO viTe
                     ENDCASE
                ENDIF
           CASE mkEy=k_Ctrl_end
                STORE 4 TO ciTx
                DO veR_1300a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     STORE viTe+1 TO viTe
                     DO WHILE viTe<ciTx .AND. mkEy<>99
                          DO veR_1300a
                          IF mkEy=k_Esc
                               EXIT
                          ENDIF
                          IF mkEy<>99
                               STORE viTe+1 TO viTe
                          ENDIF
                     ENDDO
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                ENDIF
           CASE mkEy=k_Tab
                STORE 4 TO ciTx
                DO WHILE viTe<=ciTx .AND. mkEy<>99
                     DO veR_1300a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     IF mkEy<>99
                          STORE viTe+1 TO viTe
                     ENDIF
                ENDDO
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     SAVE SCREEN TO vpAn_11
                     DO CASE
                          CASE voPc=1
                               DO pvR1300b
                          OTHERWISE
                               DO pvR1300c
                     ENDCASE
                     STORE dfEm TO cdFe
                     STORE hfEm TO chFe
                     STORE dsEr TO cdSe
                     STORE hsEr TO chSe
                     STORE vaA1 TO caA1
                     STORE vaA2 TO caA2
                     STORE vaA3 TO caA3
                     STORE vaA4 TO caA4
                     STORE vaA5 TO caA5
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     RESTORE SCREEN FROM vpAn_11
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      STORE k_Enter TO mkEy
      DO coLbln
      DO CASE
           CASE viTe=1
                @vFI3+02.5,vCO1+85 Get dFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=2
                @vFI3+04.5,vCO1+85 Get hFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=3
                @vFI3+08.5,vCO1+85 Get dSER Font "&mLetRom",12 Style "NQ" Size 1,04.3 Color ,&mColBlN Pict "!!!"
           CASE viTe=4
                @vFI3+10.5,vCO1+85 Get hSER Font "&mLetRom",12 Style "NQ" Size 1,04.3 Color ,&mColBlN Pict "!!!"
      ENDCASE
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE P00_1300a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO CASE
      CASE mrEs="4"
           STORE 2.5 TO vnUf
      OTHERWISE
           STORE 3.0 TO vnUf
 ENDCASE
 IF vaLt>1
      STORE 140 TO muCo
 ELSE
      STORE 120 TO muCo
 ENDIF
 STORE 24 TO muFi
 STORE (mwFi-muFi)/2 TO vfI1
 STORE (mwCo-muCo)/2 TO vcO1
 STORE vfI1-1 TO vfI1
 STORE vfI1+vnUf TO vfI2
 STORE vfI2+vnUf TO vfI3
 STORE vfI3+vnUf TO vfI4
 STORE vfI4+vnUf TO vfI5
 STORE vfI5+vnUf TO vfI6
 STORE vfI6+vnUf TO vfI7
 STORE vfI7+vnUf TO vfI8
 STORE vfI8+vnUf TO vfI9
 STORE vfI9+vnUf TO vfI0
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mfI0+02.3 TO ifIl, ufIl, vfIl
 STORE ifIl+INT(muFi)-3 TO ffIl
 STORE ifIl+1.5 TO ifFs, ufFs, vfFs
 STORE ifFs+(ffIl-ifIl) TO ffFs
 DO tiT_0000a WITH "Reportes de Ventas"
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 SAVE SCREEN TO vpAn_99
 DO coL_beige
 IF vaLt>1
      DO cuAdro WITH vfI3+0.5, vcO1+66, vfI3+13, vcO1+135
 ELSE
      DO cuAdro WITH vfI3+0.5, vcO1+66, vfI3+13, vcO1+105
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI5, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI6, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI7, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI8, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI9, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI0, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLneb
 @vFI1-4.0,vCO1+08.0 Say "Tipo de Reportes"               Font "&mLetAri",18 Style "BT"
 DO coLbln
 @vFI1-3.9,vCO1+08.2 Say "Tipo de Reportes"               Font "&mLetAri",18 Style "BT"
 DO coLblz
 @vFI1+0.2,vCO1+16.0 Say "Reporte General"                Font "&mLetAri",10 Style "BT"
 @vFI2+0.2,vCO1+09.0 Say "Reporte x Clientes Titulares"   Font "&mLetAri",10 Style "BT"
 @vFI3+0.2,vCO1+10.0 Say "Reporte x Tipo de Clientes"     Font "&mLetAri",10 Style "BT"
 @vFI4+0.2,vCO1+14.0 Say "Reporte x Vendedor"             Font "&mLetAri",10 Style "BT"
 @vFI5+0.2,vCO1+10.0 Say "Reporte x Formas de Pago"       Font "&mLetAri",10 Style "BT"
 @vFI6+0.2,vCO1+08.0 Say "Reporte x Tipos de Productos"   Font "&mLetAri",10 Style "BT"
 @vFI7+0.2,vCO1+08.0 Say "Reporte x Productos,Servicios"  Font "&mLetAri",10 Style "BT"
 @vFI8+0.2,vCO1+07.0 Say "Reporte x Productos Nacionales" Font "&mLetAri",10 Style "BT"
 @vFI9+0.2,vCO1+07.0 Say "Reporte x Productos Importados" Font "&mLetAri",10 Style "BT"
 @vFI0+0.2,vCO1+13.0 Say "Reporte x Servicios"            Font "&mLetAri",10 Style "BT"
 DO opC_1300a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_beige
 @vFI3+00.5,vCO1+071 Say "Fechas:" Font "&mLetRom",14 Style "BQ"
 @vFI3+02.5,vCO1+071 Say "Desde"   Font "&mLetRom",14 Style "NQ"
 @vFI3+04.5,vCO1+071 Say "Hasta"   Font "&mLetRom",14 Style "NQ"
 @vFI3+06.5,vCO1+071 Say "Series:" Font "&mLetRom",14 Style "BQ"
 @vFI3+08.5,vCO1+071 Say "Desde"   Font "&mLetRom",14 Style "NQ"
 @vFI3+10.5,vCO1+071 Say "Hasta"   Font "&mLetRom",14 Style "NQ"
 @vFI3+02.5,vCO1+085 Get dFEM      Font "&mLetRom",12 Style "NQ" Size 1,12   Color ,&mColBlN
 @vFI3+04.5,vCO1+085 Get hFEM      Font "&mLetRom",12 Style "NQ" Size 1,12   Color ,&mColBlN
 @vFI3+08.5,vCO1+085 Get dSER      Font "&mLetRom",12 Style "NQ" Size 1,04.3 Color ,&mColBlN
 @vFI3+10.5,vCO1+085 Get hSER      Font "&mLetRom",12 Style "NQ" Size 1,04.3 Color ,&mColBlN
 READ TIMEOUT 0.01
 IF vaLt>1
      DO coL_beige
      @vFI3+02.5,vCO1+108 Say vNO1   Font "&mLetAri",8 Style "NQ" Size 1,17 Pict "@S20"
      @vFI3+04.5,vCO1+108 Say vNO2   Font "&mLetAri",8 Style "NQ" Size 1,17 Pict "@S20"
      @vFI3+06.5,vCO1+108 Say vNO3   Font "&mLetAri",8 Style "NQ" Size 1,17 Pict "@S20"
      @vFI3+08.5,vCO1+108 Say vNO4   Font "&mLetAri",8 Style "NQ" Size 1,17 Pict "@S20"
      @vFI3+10.5,vCO1+108 Say vNO5   Font "&mLetAri",8 Style "NQ" Size 1,17 Pict "@S20"
      DO alM_1300a
 ENDIF
ENDPROC
*
PROCEDURE Alm_1300a
 IF vaA1=1
      DO prEsiona WITH "1", "SI", vfI3+02.5, vcO1+104
 ELSE
      DO prEsiona WITH "1", "NO", vfI3+02.5, vcO1+104
 ENDIF
 DO CASE
      CASE vaL2=1 .AND. vaA2=1
           DO prEsiona WITH "1", "SI", vfI3+04.5, vcO1+104
      CASE vaL2=1
           DO prEsiona WITH "1", "NO", vfI3+04.5, vcO1+104
 ENDCASE
 DO CASE
      CASE vaL3=1 .AND. vaA3=1
           DO prEsiona WITH "1", "SI", vfI3+06.5, vcO1+104
      CASE vaL3=1
           DO prEsiona WITH "1", "NO", vfI3+06.5, vcO1+104
 ENDCASE
 DO CASE
      CASE vaL4=1 .AND. vaA4=1
           DO prEsiona WITH "1", "SI", vfI3+08.5, vcO1+104
      CASE vaL4=1
           DO prEsiona WITH "1", "NO", vfI3+08.5, vcO1+104
 ENDCASE
 DO CASE
      CASE vaL5=1 .AND. vaA5=1
           DO prEsiona WITH "1", "SI", vfI3+10.5, vcO1+104
      CASE vaL5=1
           DO prEsiona WITH "1", "NO", vfI3+10.5, vcO1+104
 ENDCASE
ENDPROC
*
PROCEDURE Opc_1300a
 DO CASE
      CASE coPc=1
           DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
      CASE coPc=2
           DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
      CASE coPc=3
           DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
      CASE coPc=4
           DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
      CASE coPc=5
           DO prEsiona WITH "1", "ITEM0", vfI5, vcO1+2
      CASE coPc=6
           DO prEsiona WITH "1", "ITEM0", vfI6, vcO1+2
      CASE coPc=7
           DO prEsiona WITH "1", "ITEM0", vfI7, vcO1+2
      CASE coPc=8
           DO prEsiona WITH "1", "ITEM0", vfI8, vcO1+2
      CASE coPc=9
           DO prEsiona WITH "1", "ITEM0", vfI9, vcO1+2
      CASE coPc=10
           DO prEsiona WITH "1", "ITEM0", vfI0, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLblz
 DO CASE
      CASE coPc=1
           @vFI1+0.2,vCO1+16 Say "Reporte General"                Font "&mLetAri",10 Style "BT"
      CASE coPc=2
           @vFI2+0.2,vCO1+09 Say "Reporte x Clientes Titulares"   Font "&mLetAri",10 Style "BT"
      CASE coPc=3
           @vFI3+0.2,vCO1+10 Say "Reporte x Tipo de Clientes"     Font "&mLetAri",10 Style "BT"
      CASE coPc=4
           @vFI4+0.2,vCO1+14 Say "Reporte x Vendedor"             Font "&mLetAri",10 Style "BT"
      CASE coPc=5
           @vFI5+0.2,vCO1+10 Say "Reporte x Formas de Pago"       Font "&mLetAri",10 Style "BT"
      CASE coPc=6
           @vFI6+0.2,vCO1+08 Say "Reporte x Tipos de Productos"   Font "&mLetAri",10 Style "BT"
      CASE coPc=7
           @vFI7+0.2,vCO1+08 Say "Reporte x Productos,Servicios"  Font "&mLetAri",10 Style "BT"
      CASE coPc=8
           @vFI8+0.2,vCO1+07 Say "Reporte x Productos Nacionales" Font "&mLetAri",10 Style "BT"
      CASE coPc=9
           @vFI9+0.2,vCO1+07 Say "Reporte x Productos Importados" Font "&mLetAri",10 Style "BT"
      CASE coPc=10
           @vFI0+0.2,vCO1+13 Say "Reporte x Servicios"            Font "&mLetAri",10 Style "BT"
 ENDCASE
 DO CASE
      CASE voPc=1
           DO prEsiona WITH "2", "ITEM0", vfI1, vcO1+2
      CASE voPc=2
           DO prEsiona WITH "2", "ITEM0", vfI2, vcO1+2
      CASE voPc=3
           DO prEsiona WITH "2", "ITEM0", vfI3, vcO1+2
      CASE voPc=4
           DO prEsiona WITH "2", "ITEM0", vfI4, vcO1+2
      CASE voPc=5
           DO prEsiona WITH "2", "ITEM0", vfI5, vcO1+2
      CASE voPc=6
           DO prEsiona WITH "2", "ITEM0", vfI6, vcO1+2
      CASE voPc=7
           DO prEsiona WITH "2", "ITEM0", vfI7, vcO1+2
      CASE voPc=8
           DO prEsiona WITH "2", "ITEM0", vfI8, vcO1+2
      CASE voPc=9
           DO prEsiona WITH "2", "ITEM0", vfI9, vcO1+2
      CASE voPc=10
           DO prEsiona WITH "2", "ITEM0", vfI0, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(253,242,47,0,0,0)
 DO CASE
      CASE voPc=1
           @vFI1+0.2,vCO1+16 Say "Reporte General"                Font "&mLetAri",10 Style "BT"
      CASE voPc=2
           @vFI2+0.2,vCO1+09 Say "Reporte x Clientes Titulares"   Font "&mLetAri",10 Style "BT"
      CASE voPc=3
           @vFI3+0.2,vCO1+10 Say "Reporte x Tipo de Clientes"     Font "&mLetAri",10 Style "BT"
      CASE voPc=4
           @vFI4+0.2,vCO1+14 Say "Reporte x Vendedor"             Font "&mLetAri",10 Style "BT"
      CASE voPc=5
           @vFI5+0.2,vCO1+10 Say "Reporte x Formas de Pago"       Font "&mLetAri",10 Style "BT"
      CASE voPc=6
           @vFI6+0.2,vCO1+08 Say "Reporte x Tipos de Productos"   Font "&mLetAri",10 Style "BT"
      CASE voPc=7
           @vFI7+0.2,vCO1+08 Say "Reporte x Productos,Servicios"  Font "&mLetAri",10 Style "BT"
      CASE voPc=8
           @vFI8+0.2,vCO1+07 Say "Reporte x Productos Nacionales" Font "&mLetAri",10 Style "BT"
      CASE voPc=9
           @vFI9+0.2,vCO1+07 Say "Reporte x Productos Importados" Font "&mLetAri",10 Style "BT"
      CASE voPc=10
           @vFI0+0.2,vCO1+13 Say "Reporte x Servicios"            Font "&mLetAri",10 Style "BT"
 ENDCASE
 STORE voPc TO coPc
ENDPROC
*
PROCEDURE Ver_1300a
 DO CASE
      CASE viTe=1 .AND. AT(" ", DTOC(dfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. AT(" ", DTOC(hfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. dfEm>hfEm
           STORE "Fecha inicial no puede ser mayor a final..." TO mmSj
      CASE viTe=3 .AND. AT(" ", dsEr)<>0
           STORE "Serie no puede tener espacios vacíos..." TO mmSj
      CASE viTe=4 .AND. AT(" ", hsEr)<>0
           STORE "Serie no puede tener espacios vacíos..." TO mmSj
      CASE viTe=4 .AND. dsEr>hsEr
           STORE "Serie inicial no puede ser mayor a final..." TO mmSj
      CASE viTe=4 .AND. dfEm=cdFe .AND. dsEr=cdSe .AND. vaA1=caA1 .AND.  ;
           vaA3=caA3 .AND. vaA5=caA5 .AND. hfEm=chFe .AND. hsEr=chSe  ;
           .AND. vaA2=caA2 .AND. vaA4=caA4
      CASE viTe=4
           DO reV_1300a
           IF vaB1+vaB2+vaB3+vaB4+vaB5=0
                STORE "No hay datos en este rango de Fecha..." TO mmSj
           ELSE
                STORE TIME() TO vhOr
                SET ESCAPE ON
                ON ESCAPE STORE 9000 TO MKEY
                DO prO_1300a
                ON ESCAPE
                SET ESCAPE OFF
                WAIT WINDOW NOWAIT "Hora Final de Lectura: "+TIME()
                = INKEY(0.05)
                WAIT CLEAR
                IF mkEy=9000
                     STORE "Proceso Interrumpido..." TO mmSj
                ELSE
                     SELECT teMporal
                     GOTO TOP
                     IF BOF()
                          STORE "No hay datos en este rango de Fecha..."  ;
                                TO mmSj
                     ENDIF
                ENDIF
           ENDIF
 ENDCASE
 IF LEN(ALLTRIM(mmSj))<>0
      DO poNmsj
      STORE 99 TO mkEy
 ENDIF
ENDPROC
*
PROCEDURE Rev_1300a
 STORE SUBSTR(DTOC(dfEm), 1, 2) TO ddIa
 STORE SUBSTR(DTOC(dfEm), 4, 2) TO dmEs
 STORE SUBSTR(DTOC(dfEm), 7, 4) TO daNo
 STORE 0 TO vaB1, vaB2, vaB3, vaB4, vaB5
 IF vaA1=1
      SELECT caB_fact
      GOTO TOP
      SET NEAR ON
      SEEK daNo+dmEs+ddIa
      SET NEAR OFF
      IF  .NOT. EOF() .AND. f1300fem<=hfEm
           STORE 1 TO vaB1
      ENDIF
 ENDIF
 IF vaA2=1
      SELECT caB_fact2
      GOTO TOP
      SET NEAR ON
      SEEK daNo+dmEs+ddIa
      SET NEAR OFF
      IF  .NOT. EOF() .AND. f1300fem<=hfEm
           STORE 1 TO vaB2
      ENDIF
 ENDIF
 IF vaA3=1
      SELECT caB_fact3
      GOTO TOP
      SET NEAR ON
      SEEK daNo+dmEs+ddIa
      SET NEAR OFF
      IF  .NOT. EOF() .AND. f1300fem<=hfEm
           STORE 1 TO vaB3
      ENDIF
 ENDIF
 IF vaA4=1
      SELECT caB_fact4
      GOTO TOP
      SET NEAR ON
      SEEK daNo+dmEs+ddIa
      SET NEAR OFF
      IF  .NOT. EOF() .AND. f1300fem<=hfEm
           STORE 1 TO vaB4
      ENDIF
 ENDIF
 IF vaA5=1
      SELECT caB_fact5
      GOTO TOP
      SET NEAR ON
      SEEK daNo+dmEs+ddIa
      SET NEAR OFF
      IF  .NOT. EOF() .AND. f1300fem<=hfEm
           STORE 1 TO vaB5
      ENDIF
 ENDIF
ENDPROC
*
PROCEDURE Pro_1300a
 SELECT teMporal
 ZAP
 IF vaA1=1 .AND. vaB1=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO1)+"..."+vhOr
      DO prF_1300a WITH 1
 ENDIF
 IF vaL2=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA2=1 .AND. vaB2=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO2)+"..."+vhOr
      DO prF_1300a WITH 2
 ENDIF
 IF vaL3=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA3=1 .AND. vaB3=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO3)+"..."+vhOr
      DO prF_1300a WITH 3
 ENDIF
 IF vaL4=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA4=1 .AND. vaB4=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO4)+"..."+vhOr
      DO prF_1300a WITH 4
 ENDIF
 IF vaL5=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA5=1 .AND. vaB5=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO5)+"..."+vhOr
      DO prF_1300a WITH 5
 ENDIF
 IF mkEy<>99 .AND. mkEy<>9000 .AND. vaA1=1 .AND. vaB1=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO1)+"..."+vhOr
      DO prN_1300a WITH 1
 ENDIF
 IF vaL2=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA2=1 .AND. vaB2=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO2)+"..."+vhOr
      DO prN_1300a WITH 2
 ENDIF
 IF vaL3=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA3=1 .AND. vaB3=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO3)+"..."+vhOr
      DO prN_1300a WITH 3
 ENDIF
 IF vaL4=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA4=1 .AND. vaB4=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO4)+"..."+vhOr
      DO prN_1300a WITH 4
 ENDIF
 IF vaL5=1 .AND. mkEy<>99 .AND. mkEy<>9000 .AND. vaA5=1 .AND. vaB5=1
      WAIT WINDOW NOWAIT "L E Y E N D O  "+ALLTRIM(vnO5)+"..."+vhOr
      DO prN_1300a WITH 5
 ENDIF
ENDPROC
*
PROCEDURE PrF_1300a
 PARAMETER prEg
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f1300tdo="CT" .OR. f1300est$"89" .OR. f1300tdo="PC" .OR.  ;
         f1300ser<dsEr .OR. f1300ser>hsEr
           SKIP
           LOOP
      ENDIF
      STORE f1300tdo TO vtDo
      STORE f1300ser TO vsEr
      STORE f1300doc TO vdOc
      STORE f1300mon TO vmOn
      STORE 0 TO vdCt
      DO CASE
           CASE prEg=1
                SELECT deT_fact
           CASE prEg=2
                SELECT deT_fact2
           CASE prEg=3
                SELECT deT_fact3
           CASE prEg=4
                SELECT deT_fact4
           CASE prEg=5
                SELECT deT_fact5
      ENDCASE
      GOTO TOP
      SEEK vtDo+vsEr+vdOc
      IF EOF()
           DO CASE
                CASE prEg=1
                     SELECT caB_fact
                CASE prEg=2
                     SELECT caB_fact2
                CASE prEg=3
                     SELECT caB_fact3
                CASE prEg=4
                     SELECT caB_fact4
                CASE prEg=5
                     SELECT caB_fact5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      STORE 0 TO tvAl, vpOr
      DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=vtDo+vsEr+vdOc
           IF mkEy=9000
                RETURN
           ENDIF
           STORE tvAl+f1301to2 TO tvAl
           SKIP
      ENDDO
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      IF f1300tot<>tvAl
           STORE f1300tot-tvAl TO vdCt
           STORE (1-(f1300tot/tvAl))*100 TO vpOr
      ENDIF
      STORE f1300fem TO vfEm
      STORE f1300cli TO vcLi
      STORE f1300nom TO vnOm
      STORE f1300tit TO vtIt
      STORE f1300ntt TO vnTt
      STORE f1300ruc TO vrUc
      STORE f1300ele TO vdNi
      STORE f1300fpa TO vfPa
      STORE f1300nfp TO vnFp
      STORE f1300ven TO vvEn
      STORE f1300nve TO vnVe
      STORE f1300pig TO vpIg
      STORE f1300tot TO vtOt
      STORE f1300fem+f1300dia TO vfVe
      IF LEN(ALLTRIM(vtIt))=0
           STORE vcLi TO vtIt
      ENDIF
      SELECT clIentes
      SEEK vtIt
      DO CASE
           CASE EOF() .AND. (vtDo="BO" .OR. vtDo="BC" .OR. vtDo="BE" .OR.  ;
                vtDo="NP")
                STORE "****" TO vtIt, vcLi
                STORE "**" TO vtIp
                STORE "Tipo de Cliente Varios" TO vnTi
                IF LEN(ALLTRIM(vrUc))=0
                     STORE "Cliente Varios" TO vnTt
                     STORE "***********" TO vrUc
                ENDIF
           CASE EOF()
                STORE "****" TO vtIt, vcLi
                STORE "**" TO vtIp
                STORE "Tipo de Cliente Varios" TO vnTi
                STORE "Cliente Varios" TO vnTt
           CASE  .NOT. EOF()
                STORE f1101tip TO vtIp
                IF LEN(ALLTRIM(vrUc))=0
                     STORE vtIt TO vrUc
                ENDIF
                SELECT tiPo_cl
                SEEK vtIp
                DO CASE
                     CASE LEN(ALLTRIM(vtIp))=0
                          STORE "**" TO vtIp
                          STORE "Tipo de Cliente Varios" TO vnTi
                     CASE EOF()
                          STORE "Tipo de Cliente borrado" TO vnTi
                     OTHERWISE
                          STORE f9110nti TO vnTi
                ENDCASE
      ENDCASE
      IF LEN(ALLTRIM(vfPa))=0
           STORE "**" TO vfPa
           STORE "Forma de Pago Varios" TO vnFp
      ENDIF
      IF LEN(ALLTRIM(vvEn))=0
           STORE "**" TO vvEn
           STORE "Vendedores Varios" TO vnVe
      ENDIF
      DO CASE
           CASE prEg=1
                SELECT deT_fact
           CASE prEg=2
                SELECT deT_fact2
           CASE prEg=3
                SELECT deT_fact3
           CASE prEg=4
                SELECT deT_fact4
           CASE prEg=5
                SELECT deT_fact5
      ENDCASE
      GOTO TOP
      SEEK vtDo+vsEr+vdOc
      STORE 0 TO tvAl
      DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=vtDo+vsEr+vdOc
           IF mkEy=9000
                RETURN
           ENDIF
           STORE f1301cod TO vcOd
           STORE f1301des TO vdEs
           STORE f1301nuv TO vnUv
           STORE f1301can TO vcAn
           STORE f1301to2 TO vtO2
           IF vpOr<>0
                STORE vtO2-ROUND(vtO2*vpOr/100, 2) TO vtO2
           ENDIF
           STORE tvAl+vtO2 TO tvAl
           SELECT prOductos
           SEEK ALLTRIM(vcOd)+"*"
           IF EOF()
                STORE "**" TO vgRu, vtPr
                STORE "Sin Grupo" TO vnGr
                STORE "Sin Tipo" TO vnTp
                STORE 2 TO viMp
                STORE " " TO vpRo
           ELSE
                STORE f2111gru TO vgRu
                STORE f2111tip TO vtPr
                STORE f2111tpo TO vtPo
                STORE f2111imp TO viMp
                STORE f2111pro TO vpRo
                SELECT grUpos
                SEEK vgRu
                IF EOF()
                     STORE "**" TO vgRu
                     STORE "Sin Grupo" TO vnGr
                ELSE
                     STORE f9216des TO vnGr
                ENDIF
                SELECT tiP_prod
                SEEK vtPr
                DO CASE
                     CASE EOF()
                          STORE "**" TO vtPr
                          STORE "Sin Tipo" TO vnTp
                     OTHERWISE
                          STORE f9211nti TO vnTp
                ENDCASE
           ENDIF
           SELECT teMporal
           APPEND BLANK
           REPLACE ftM1gru WITH vgRu
           REPLACE ftM1ngr WITH vnGr
           REPLACE ftM1tip WITH vtIp
           REPLACE ftM1nti WITH vnTi
           REPLACE ftM1tdo WITH vtDo
           REPLACE ftM1ser WITH vsEr
           REPLACE ftM1doc WITH vdOc
           REPLACE ftM1fem WITH vfEm
           REPLACE ftM1fve WITH vfVe
           REPLACE ftM1tit WITH vtIt
           REPLACE ftM1ntt WITH vnTt
           REPLACE ftM1cli WITH vcLi
           REPLACE ftM1nom WITH vnOm
           REPLACE ftM1ruc WITH vrUc
           REPLACE ftM1fpa WITH vfPa
           REPLACE ftM1nfp WITH vnFp
           REPLACE ftM1ven WITH vvEn
           REPLACE ftM1nve WITH vnVe
           REPLACE ftM1mon WITH vmOn
           REPLACE ftM1tot WITH vtOt
           REPLACE ftM1cod WITH vcOd
           REPLACE ftM1des WITH vdEs
           REPLACE ftM1nuv WITH vnUv
           REPLACE ftM1can WITH vcAn
           REPLACE ftM1imp WITH viMp
           REPLACE ftM1tpo WITH vtPo
           REPLACE ftM1tpr WITH vtPr
           REPLACE ftM1ntp WITH vnTp
           REPLACE ftM1pro WITH vpRo
           REPLACE ftM1pre WITH ROUND(vtO2/vcAn, 4)
           REPLACE ftM1to2 WITH vtO2
           REPLACE ftM1alm WITH STR(prEg, 1, 0)
           DO CASE
                CASE prEg=1
                     SELECT deT_fact
                CASE prEg=2
                     SELECT deT_fact2
                CASE prEg=3
                     SELECT deT_fact3
                CASE prEg=4
                     SELECT deT_fact4
                CASE prEg=5
                     SELECT deT_fact5
           ENDCASE
           SKIP
      ENDDO
      IF vtOt<>tvAl
           SELECT teMporal
           IF tvAl>vtOt
                STORE vtO2-(tvAl-vtOt) TO vtO2
           ELSE
                STORE vtO2+(vtOt-tvAl) TO vtO2
           ENDIF
           REPLACE ftM1pre WITH ROUND(vtO2/vcAn, 4)
           REPLACE ftM1to2 WITH vtO2
      ENDIF
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE PrN_1300a
 PARAMETER prEg
 DO CASE
      CASE prEg=1
           SELECT caB_nota
      CASE prEg=2
           SELECT caB_nota2
      CASE prEg=3
           SELECT caB_nota3
      CASE prEg=4
           SELECT caB_nota4
      CASE prEg=5
           SELECT caB_nota5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND..."+ALLTRIM(vnO1)+ ;
      " Presionar ESC para Salir"+CHR(13)+"Hora Inicial de Lectura: "+vhOr
 DO WHILE  .NOT. EOF() .AND. f3610fem>=dfEm .AND. f3610fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f3610est$"89" .OR. f3610ser<dsEr .OR. f3610ser>hsEr
           SKIP
           LOOP
      ENDIF
      STORE f3610tdo TO vtDo
      STORE f3610ser TO vsEr
      STORE f3610doc TO vdOc
      STORE f3610fem TO vfEm, vfVe
      STORE f3610cli TO vcLi
      STORE f3610nom TO vnOm
      STORE f3610tit TO vtIt
      STORE f3610nti TO vnTt
      STORE f3610ruc TO vrUc
      STORE f3610ele TO vdNi
      STORE f3610ven TO vvEn
      STORE f3610nve TO vnVe
      STORE f3610mon TO vmOn
      STORE f3610pig TO vpIg
      STORE f3610tot TO vtOt
      STORE "  " TO vfPa, vnFp
      IF LEN(ALLTRIM(vfPa))=0
           STORE "**" TO vfPa
           STORE "Forma de Pago Varios" TO vnFp
      ENDIF
      IF LEN(ALLTRIM(vvEn))=0
           STORE "**" TO vvEn
           STORE "Vendedores Varios" TO vnVe
      ENDIF
      IF LEN(ALLTRIM(vtIt))=0
           STORE vcLi TO vtIt
           STORE vnOm TO vnTt
      ENDIF
      IF LEN(ALLTRIM(vtIt))=0
           STORE "****" TO vtIt, vcLi
           STORE "Clientes/Titulares Varios" TO vnTt
      ENDIF
      DO CASE
           CASE LEN(ALLTRIM(vrUc))<>0
           CASE LEN(ALLTRIM(vdNi))<>0
                STORE vdNi TO vrUc
           OTHERWISE
                STORE vtIt TO vrUc
      ENDCASE
      SELECT clIentes
      SEEK vtIt
      IF EOF()
           STORE "****" TO vtIt, vcLi
           STORE "**" TO vtIp
           STORE "Tipo de Cliente Varios" TO vnTi
           IF LEN(ALLTRIM(vrUc))=0
                STORE "Cliente Varios" TO vnTt
                STORE "****" TO vrUc
           ENDIF
      ELSE
           STORE f1101tip TO vtIp
           DO CASE
                CASE LEN(ALLTRIM(vrUc))<>0
                OTHERWISE
                     STORE vtIt TO vrUc
           ENDCASE
           SELECT tiPo_cl
           SEEK vtIp
           DO CASE
                CASE LEN(ALLTRIM(vtIp))=0
                     STORE "**" TO vtIp
                     STORE "Tipo de Cliente Varios" TO vnTi
                CASE EOF()
                     STORE "Tipo de Cliente borrado" TO vnTi
                OTHERWISE
                     STORE f9110nti TO vnTi
           ENDCASE
      ENDIF
      IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
           STORE vtOt*-1 TO vtOt
      ENDIF
      SELECT teMporal
      APPEND BLANK
      REPLACE ftM1gru WITH "**"
      REPLACE ftM1ngr WITH "Sin Grupo"
      REPLACE ftM1tip WITH vtIp
      REPLACE ftM1nti WITH vnTi
      REPLACE ftM1tdo WITH vtDo
      REPLACE ftM1ser WITH vsEr
      REPLACE ftM1doc WITH vdOc
      REPLACE ftM1fem WITH vfEm
      REPLACE ftM1fve WITH vfVe
      REPLACE ftM1tit WITH vtIt
      REPLACE ftM1ntt WITH vnTt
      REPLACE ftM1cli WITH vcLi
      REPLACE ftM1nom WITH vnOm
      REPLACE ftM1ruc WITH vrUc
      REPLACE ftM1fpa WITH vfPa
      REPLACE ftM1nfp WITH vnFp
      REPLACE ftM1ven WITH vvEn
      REPLACE ftM1nve WITH vnVe
      REPLACE ftM1mon WITH vmOn
      REPLACE ftM1tot WITH vtOt
      REPLACE ftM1cod WITH "****"
      REPLACE ftM1des WITH "Sin Producto"
      REPLACE ftM1nuv WITH " "
      REPLACE ftM1can WITH 0
      REPLACE ftM1imp WITH 2
      REPLACE ftM1tpo WITH 2
      REPLACE ftM1tpr WITH "**"
      REPLACE ftM1ntp WITH "Sin Tipo"
      REPLACE ftM1pro WITH " "
      REPLACE ftM1pre WITH vtOt
      REPLACE ftM1to2 WITH vtOt
      REPLACE ftM1alm WITH STR(prEg, 1, 0)
      DO CASE
           CASE prEg=1
                SELECT caB_nota
           CASE prEg=2
                SELECT caB_nota2
           CASE prEg=3
                SELECT caB_nota3
           CASE prEg=4
                SELECT caB_nota4
           CASE prEg=5
                SELECT caB_nota5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE Tmp_1300a
 DIMENSION afIl[8, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM4COD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4TPO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4CDG"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4DCR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 120
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4NUV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 25
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4CTD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM4TT1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM4TT2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
ENDPROC
*
PROCEDURE Clp_1300a
 = INKEY(0.01)
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Enter TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.80
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfI1-0.35 .AND. mfIl<=vfI1+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>1
           STORE 1 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI2-0.35 .AND. mfIl<=vfI2+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>2
           STORE 2 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI3-0.35 .AND. mfIl<=vfI3+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>3
           STORE 3 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI4-0.35 .AND. mfIl<=vfI4+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>4
           STORE 4 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI5-0.35 .AND. mfIl<=vfI5+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>5
           STORE 5 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI6-0.35 .AND. mfIl<=vfI6+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>6
           STORE 6 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI7-0.35 .AND. mfIl<=vfI7+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>7
           STORE 7 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI8-0.35 .AND. mfIl<=vfI8+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>8
           STORE 8 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI9-0.35 .AND. mfIl<=vfI9+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>9
           STORE 9 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI0-0.35 .AND. mfIl<=vfI0+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>10
           STORE 10 TO voPc
           DO opC_1300a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI3+002 .AND. mfIl<=vfI3+04 .AND. mcCc>=vcO1+104 .AND.  ;
           mcCc<=vcO1+118.2 .AND. vaLt>1
           IF vaA1=0
                STORE 1 TO vaA1
           ELSE
                STORE 0 TO vaA1
           ENDIF
           DO alM_1300a
      CASE mfIl>=vfI3+004 .AND. mfIl<=vfI3+06 .AND. mcCc>=vcO1+104 .AND.  ;
           mcCc<=vcO1+118.2 .AND. vaLt>1
           IF vaA2=0
                STORE 1 TO vaA2
           ELSE
                STORE 0 TO vaA2
           ENDIF
           DO alM_1300a
      CASE mfIl>=vfI3+006 .AND. mfIl<=vfI3+08 .AND. mcCc>=vcO1+104 .AND.  ;
           mcCc<=vcO1+118.2 .AND. vaL3=1
           IF vaA3=0
                STORE 1 TO vaA3
           ELSE
                STORE 0 TO vaA3
           ENDIF
           DO alM_1300a
      CASE mfIl>=vfI3+008 .AND. mfIl<=vfI3+10 .AND. mcCc>=vcO1+104 .AND.  ;
           mcCc<=vcO1+118.2 .AND. vaL4=1
           IF vaA4=0
                STORE 1 TO vaA4
           ELSE
                STORE 0 TO vaA4
           ENDIF
           DO alM_1300a
      CASE mfIl>=vfI3+010 .AND. mfIl<=vfI3+12 .AND. mcCc>=vcO1+104 .AND.  ;
           mcCc<=vcO1+118.2 .AND. vaL5=1
           IF vaA5=0
                STORE 1 TO vaA5
           ELSE
                STORE 0 TO vaA5
           ENDIF
           DO alM_1300a
      CASE mfIl>=vfI3+2.428 .AND. mfIl<=vfI3+4.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>1
           STORE 01 TO viTe
           STORE 99 TO mkEy
      CASE mfIl>=vfI3+4.50 .AND. mfIl<=vfI3+6.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>2
           IF viTe=1
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 2 TO viTe
           ENDIF
           STORE 99 TO mkEy
      CASE mfIl>=vfI3+8.50 .AND. mfIl<=vfI3+10.0 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+90.4 .AND. viTe<>3
           IF viTe=1
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF viTe<3
                STORE 2 TO viTe
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 3 TO viTe
           ENDIF
           STORE 99 TO mkEy
      CASE mfIl>=vfI3+10.428 .AND. mfIl<=vfI3+12.0 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+90.4 .AND. viTe<>4
           IF viTe=1
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF viTe<3
                STORE 2 TO viTe
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF viTe<3
                STORE 3 TO viTe
                DO veR_1300a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 4 TO viTe
           ENDIF
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
ENDPROC
*
PROCEDURE Hlp_1300a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0.2 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Este Programa tiene varias opciones para ordenar la información de Ven-"
 @ pfIl+01, 02 SAY "tas por pantalla o impresora."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 20 SAY ":" STYLE "BT"
 @ pfIl+06, 20 SAY ":" STYLE "BT"
 @ pfIl+07, 20 SAY ":" STYLE "BT"
 @ pfIl+08, 20 SAY ":" STYLE "BT"
 @ pfIl+10, 20 SAY ":" STYLE "BT"
 @ pfIl+11, 20 SAY ":" STYLE "BT"
 @ pfIl+05, 02 SAY "ESC" STYLE "BT"
 @ pfIl+06, 02 SAY "F10" STYLE "BT"
 @ pfIl+07, 02 SAY "F1" STYLE "BT"
 @ pfIl+08, 02 SAY "ENTER, CTRL ->," STYLE "BT"
 @ pfIl+09, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+10, 02 SAY "TAB" STYLE "BT"
 @ pfIl+11, 02 SAY "FLECHA ARRIBA" STYLE "BT"
 @ pfIl+05, 22 SAY "Regresar a la pantalla anterior"
 @ pfIl+06, 22 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 22 SAY "Ayuda del Programa"
 @ pfIl+08, 22 SAY "Ir al siguiente campo, al final ingresa a la Consulta"
 @ pfIl+10, 22 SAY "Ir a la Consulta"
 @ pfIl+11, 22 SAY "Campo anterior"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE viTe, viT1, ciTx, vsW0, csW0, vsW1, vsW2, vsW3, csW3, vsW4, csW4,  ;
         vsW5, csW5
 RELEASE vsW6, vpAg, vlIn, vxLs, voPc, coPc, voPf, coPf, voPb, coPb, voPn,  ;
         coPn, voPd
 RELEASE coPd, vuLt, dfEm, hfEm, cdFe, chFe, vfI1, vfI2, vfI3, vfI4, vfI5,  ;
         vfI6, vfI7
 RELEASE vfI8, vfI9, vfI0, vcO1, vcL1, vcL2, vcL3, vcL4, vcL5, vcL6, vcL7,  ;
         vcL8, vcL9
 RELEASE vcL0, vcLa, vnUf, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
         ffFs, cfFs
 RELEASE vfFr, ifFr, ufFr, ffFr, cfFr, daNo, dmEs, ddIa, vcLi, vnCl, vtIt,  ;
         vdNi, vfPa
 RELEASE vvEn, vpIg, vtCa, vdEs, vnUv, vnVv, vgRu, vnGr, vtPr, vnTp, vtIp,  ;
         vnTi, viMp
 RELEASE vpRo, vnUm, vtDo, itDo, utDo, vsEr, isEr, usEr, dsEr, hsEr, cdSe,  ;
         chSe, vdOc
 RELEASE idOc, udOc, vfEm, ifEm, ufEm, vfVe, ifVe, ufVe, vrUc, irUc, urUc,  ;
         vnOm, inOm
 RELEASE unOm, xnOm, ynOm, znOm, vnVe, inVe, unVe, vnFp, inFp, unFp, vnTt,  ;
         inTt, unTt
 RELEASE vmOn, imOn, umOn, vtOt, itOt, utOt, tsOl, tsO1, tuSd, tuS1, vtO1,  ;
         itO1, utO1
 RELEASE ttO1, xtO1, ytO1, ztO1, vtO2, itO2, utO2, ttO2, xtO2, ytO2, ztO2,  ;
         vtT1, itT1
 RELEASE utT1, xtT1, ttT1, vtT2, itT2, utT2, xtT2, ttT2, vcOd, icOd, ucOd,  ;
         xcOd, ycOd
 RELEASE zcOd, dcOd, hcOd, vcDg, icDg, ucDg, xcDg, hcDg, dcDg, vcAn, icAn,  ;
         ucAn, xcAn
 RELEASE ycAn, zcAn, vcTd, icTd, ucTd, xcTd, vdCr, idCr, udCr, xdCr, vtPo,  ;
         vtTt, vtD1
 RELEASE vtD2, vtD3, vtD4, vtD5, vt11, vt12, vt21, vt22, vt31, vt32, vt41,  ;
         vt42, vhOr
 RELEASE tvAl, vpOr, tfA1, tfA2, tbO1, tbO2, tnP1, tnP2, vpT2, vpT3, vpT4,  ;
         vpT5, vaL2
 RELEASE vaL3, vaL4, vaL5, vaLt, vaLm, vnO1, vnO2, vnO3, vnO4, vnO5, vaA1,  ;
         vaA2, vaA3
 RELEASE vaA4, vaA5, caA1, caA2, caA3, caA4, caA5, vaB1, vaB2, vaB3, vaB4, vaB5
 RELEASE vpAn_11, vpAn_12, vpAn_13, vpAn_99
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 DO deL_file2 WITH "3", "S"
 DO deL_file2 WITH "4", "S"
 DO deL_file2 WITH "5", "S"
 DO deL_file2 WITH "6", "S"
 DO deL_file2 WITH "7", "S"
 DO deL_file2 WITH "8", "S"
 DO deL_file2 WITH "9", "S"
 DO deL_file2 WITH "0", "S"
 RELEASE ntM1, ntM2, ntM3, ntM4, ntM5, ntM6, ntM7, ntM8, ntM9, ntM0
ENDPROC
*
