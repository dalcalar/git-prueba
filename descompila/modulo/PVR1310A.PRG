 SET CENTURY ON
 PUBLIC ntM1, ntM2
 PUBLIC afIl, x
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE 01 TO meRr
 DIMENSION afIl[102, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM1COD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 120
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NUV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1STO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MIN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAX"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1EN1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FE1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MA1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AB1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MY1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JU1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JL1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AG1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SE1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OC1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DI1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1EN2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FE2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MA2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AB2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MY2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JU2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JL2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AG2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SE2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OC2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DI2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIK"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1END"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FED"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SED"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DID"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIW"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM1cod)+"*" TAG ftM1cod
 INDEX ON UPPER(ftM1nom)+ALLTRIM(ftM1cod)+"*" TAG ftM1nom
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[42, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM1COD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 120
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NUV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1STO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MIN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAX"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1EN1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FE1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MA1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AB1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MY1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JU1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JL1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AG1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SE1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OC1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DI1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1EN2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FE2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MA2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AB2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MY2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JU2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JL2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AG2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SE2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OC2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DI2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 1
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ENC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MAC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ABC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MYC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JUC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1JLC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1AGC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SEC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1OCC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DIC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM1cod)+"*" TAG ftM1cod
 INDEX ON UPPER(ftM1nom)+ALLTRIM(ftM1cod)+"*" TAG ftM1nom
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 STORE 99 TO mkEy
 SELECT 1
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET DELETED OFF
 GOTO TOP
 SET DELETED ON
 IF BOF() .OR. EOF()
      STORE "Archivo de Documentos de Ventas no puede estar vacío" TO mmSj
      STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
            "PRESIONAR UNA TECLA PARA REGRESAR AL MENÚ..." TO mmSj
      WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
      WAIT CLEAR
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 DO abR_0000a IN PUX0000A WITH "1301", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1301DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 DO abR_0000a IN PUX0000A WITH "1101", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Clientes
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1101COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 DO abR_0000a IN PUX0000A WITH "2400", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2400FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 DO abR_0000a IN PUX0000A WITH "2401", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2401DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 DO abR_0000a IN PUX0000A WITH "2990", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Kardex
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2990TD1
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 DO abR_0000a IN PUX0000A WITH "9110", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tipo_Cl
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9110TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 DO abR_0000a IN PUX0000A WITH "9111", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cambio
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9111FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 DO abR_0000a IN PUX0000A WITH "9113", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Vendedor
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9113NOM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 11
 DO abR_0000a IN PUX0000A WITH "9211", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tip_Prod
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9211TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 12
 DO abR_0000a IN PUX0000A WITH "9216", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Grupos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9216COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 13
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_1
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM1COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 14
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_2
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM1COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 00 TO meRr
 PUBLIC viTe, viT1, voPc, coPc, coP1, voPv, coPv, voPk, coPk, vsW0, vsW1,  ;
        vsW2, vsW3
 PUBLIC vpAg, vlIn, vfB1, vcB1, vxLs, dfEm, hfEm, cdFe, chFe, vfI1, vfI2,  ;
        vfI3, vfI4
 PUBLIC vfI5, vfI6, vfI7, vcO1, vnUf, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs,  ;
        ifFs, ufFs
 PUBLIC ffFs, vtDo, itDo, utDo, vsEr, isEr, usEr, vdOc, idOc, udOc, vtPo,  ;
        itPo, utPo
 PUBLIC vtPp, itPp, utPp, daNo, vaNo, iaNo, uaNo, dmEs, vmEs, imEs, umEs,  ;
        ddIa, vdIa
 PUBLIC idIa, udIa, vcLi, vmOn, vtOt, vfEm, vtCa, vnUv, vcAn, vcOd, icOd,  ;
        ucOd, xcOd
 PUBLIC vnOm, inOm, unOm, xnOm, vgRu, vnGr, vtPr, vnTp, vsTo, vmIn, vmAx,  ;
        vvCs, vpIe
 PUBLIC vcEr, vpRe, vtP1
 PUBLIC tvEn1, tvFe1, tvMa1, tvAb1, tvMy1, tvJu1, tvJl1, tvAg1, tvSe1,  ;
        tvOc1, tvNo1, tvDi1
 PUBLIC tvEn2, tvFe2, tvMa2, tvAb2, tvMy2, tvJu2, tvJl2, tvAg2, tvSe2,  ;
        tvOc2, tvNo2, tvDi2
 PUBLIC tvEnc, tvFec, tvMac, tvAbc, tvMyc, tvJuc, tvJlc, tvAgc, tvSec,  ;
        tvOcc, tvNoc, tvDic
 PUBLIC tvEnk, tvFek, tvMak, tvAbk, tvMyk, tvJuk, tvJlk, tvAgk, tvSek,  ;
        tvOck, tvNok, tvDik
 PUBLIC tvEnd, tvFed, tvMad, tvAbd, tvMyd, tvJud, tvJld, tvAgd, tvSed,  ;
        tvOcd, tvNod, tvDid
 PUBLIC tvEnu, tvFeu, tvMau, tvAbu, tvMyu, tvJuu, tvJlu, tvAgu, tvSeu,  ;
        tvOcu, tvNou, tvDiu
 PUBLIC tvEnw, tvFew, tvMaw, tvAbw, tvMyw, tvJuw, tvJlw, tvAgw, tvSew,  ;
        tvOcw, tvNow, tvDiw
 PUBLIC tvEnf, tvFef, tvMaf, tvAbf, tvMyf, tvJuf, tvJlf, tvAgf, tvSef,  ;
        tvOcf, tvNof, tvDif
 PUBLIC tcEn1, tcFe1, tcMa1, tcAb1, tcMy1, tcJu1, tcJl1, tcAg1, tcSe1,  ;
        tcOc1, tcNo1, tcDi1
 PUBLIC tcEn2, tcFe2, tcMa2, tcAb2, tcMy2, tcJu2, tcJl2, tcAg2, tcSe2,  ;
        tcOc2, tcNo2, tcDi2
 PUBLIC tcEnc, tcFec, tcMac, tcAbc, tcMyc, tcJuc, tcJlc, tcAgc, tcSec,  ;
        tcOcc, tcNoc, tcDic
 PUBLIC vpAn_11, vpAn_12, vpAn_99
 SELECT caB_fact
 GOTO BOTTOM
 STORE f1300fem TO hfEm
 STORE CTOD("01"+SUBSTR(DTOC(hfEm), 3, 8)) TO dfEm
 STORE CTOD("  /  /    ") TO cdFe, chFe
 STORE 01 TO voPc, viTe, vsW0, vsW1, vsW2, vsW3, voPv
 STORE 00 TO coPc, coP1, voPk
 STORE 00 TO tvEn1, tvFe1, tvMa1, tvAb1, tvMy1, tvJu1, tvJl1, tvAg1,  ;
       tvSe1, tvOc1, tvNo1, tvDi1
 STORE 00 TO tvEn2, tvFe2, tvMa2, tvAb2, tvMy2, tvJu2, tvJl2, tvAg2,  ;
       tvSe2, tvOc2, tvNo2, tvDi2
 STORE 00 TO tvEnc, tvFec, tvMac, tvAbc, tvMyc, tvJuc, tvJlc, tvAgc,  ;
       tvSec, tvOcc, tvNoc, tvDic
 STORE 00 TO tvEnk, tvFek, tvMak, tvAbk, tvMyk, tvJuk, tvJlk, tvAgk,  ;
       tvSek, tvOck, tvNok, tvDik
 STORE 00 TO tvEnd, tvFed, tvMad, tvAbd, tvMyd, tvJud, tvJld, tvAgd,  ;
       tvSed, tvOcd, tvNod, tvDid
 STORE 00 TO tvEnu, tvFeu, tvMau, tvAbu, tvMyu, tvJuu, tvJlu, tvAgu,  ;
       tvSeu, tvOcu, tvNou, tvDiu
 STORE 00 TO tvEnw, tvFew, tvMaw, tvAbw, tvMyw, tvJuw, tvJlw, tvAgw,  ;
       tvSew, tvOcw, tvNow, tvDiw
 STORE 00 TO tvEnf, tvFef, tvMaf, tvAbf, tvMyf, tvJuf, tvJlf, tvAgf,  ;
       tvSef, tvOcf, tvNof, tvDif
 STORE 00 TO tcEn1, tcFe1, tcMa1, tcAb1, tcMy1, tcJu1, tcJl1, tcAg1,  ;
       tcSe1, tcOc1, tcNo1, tcDi1
 STORE 00 TO tcEn2, tcFe2, tcMa2, tcAb2, tcMy2, tcJu2, tcJl2, tcAg2,  ;
       tcSe2, tcOc2, tcNo2, tcDi2
 STORE 00 TO tcEnc, tcFec, tcMac, tcAbc, tcMyc, tcJuc, tcJlc, tcAgc,  ;
       tcSec, tcOcc, tcNoc, tcDic
 STORE 99 TO mkEy, coPv, coPk
 SET READBORDER ON
 DO p00_1310a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO p00_1310a WITH "1"
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_1310a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hlP_1310a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO p00_1310a WITH "1"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Ctrl_home .AND. viTe=1
                STORE "Estás en el primer campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=2
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_left
                STORE "No hay campos a la izquierda..." TO mmSj
           CASE mkEy=k_Up .AND. viTe=1
                STORE "No hay más campos arriba..." TO mmSj
           CASE mkEy=k_Esc .OR. mkEy=k_Ctrl_home
                STORE 99 TO mkEy
                STORE 01 TO viTe
           CASE mkEy=k_Up
                STORE viTe-1 TO viTe
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Ctrl_right
                DO veR_1310a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     DO CASE
                          CASE viTe=2
                               SAVE SCREEN TO vpAn_11
                               DO pvR1310b
                               STORE dfEm TO cdFe
                               STORE hfEm TO chFe
                               STORE voPc TO coP1
                               STORE voPv TO coPv
                               STORE voPk TO coPk
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               RESTORE SCREEN FROM vpAn_11
                          OTHERWISE
                               STORE viTe+1 TO viTe
                     ENDCASE
                ENDIF
           CASE mkEy=k_Ctrl_end
                DO veR_1310a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     STORE 2 TO viTe
                ENDIF
           CASE mkEy=k_Tab
                DO veR_1310a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99 .AND. viTe<2
                     STORE 2 TO viTe
                     DO veR_1310a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                ENDIF
                IF mkEy<>99
                     SAVE SCREEN TO vpAn_11
                     DO pvR1310b
                     STORE dfEm TO cdFe
                     STORE hfEm TO chFe
                     STORE voPc TO coP1
                     STORE voPv TO coPv
                     STORE voPk TO coPk
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     RESTORE SCREEN FROM vpAn_11
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      STORE k_Enter TO mkEy
      DO coLbln
      DO CASE
           CASE viTe=1
                @vFI1+1.9,vCO1+85 Get dFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=2
                @vFI1+4.3,vCO1+85 Get hFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
      ENDCASE
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE P00_1310a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO CASE
      CASE mrEs="3"
           STORE 3.0 TO vnUf
      CASE mrEs="4"
           STORE 2.5 TO vnUf
      OTHERWISE
           STORE 3.0 TO vnUf
 ENDCASE
 STORE 24 TO muFi
 STORE 110 TO muCo
 STORE (mwFi-muFi)/2 TO vfI1
 STORE (mwCo-muCo)/2 TO vcO1
 STORE vfI1-1 TO vfI1
 STORE vfI1+vnUf TO vfI2
 STORE vfI2+vnUf TO vfI3
 STORE vfI3+vnUf TO vfI4
 STORE vfI4+vnUf TO vfI5
 STORE vfI5+vnUf TO vfI6
 STORE vfI6+vnUf TO vfI7
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mfI0+3.3 TO ifIl, ufIl, vfIl
 DO CASE
      CASE mrEs="3"
           STORE ifIl+INT(muFi)-8 TO ffIl
      OTHERWISE
           STORE ifIl+INT(muFi)-7 TO ffIl
 ENDCASE
 STORE ifIl+2 TO ifFs, vfFs, ufFs
 STORE ffIl TO ffFs
 STORE ifIl-4.9 TO vfB1
 DO CASE
      CASE mrEs$"34"
           STORE mcO0+83.2 TO vcB1
      OTHERWISE
           STORE mcO0+107.2 TO vcB1
 ENDCASE
 DO tiT_0000a WITH "Estadístico de Ventas/Compras x Meses"
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 SAVE SCREEN TO vpAn_99
 DO coL_beige
 DO cuAdro WITH vfI1+0.5, vcO1+66, vfI1+16, vcO1+105
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI5, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI6, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI7, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLneb
 DO CASE
      CASE mrEs="3"
           @vFI1-4.0,vCO1+8.0 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
           DO coLbln
           @vFI1-3.9,vCO1+8.2 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
      CASE mrEs="4"
           @vFI1-3.0,vCO1+8.0 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
           DO coLbln
           @vFI1-2.9,vCO1+8.2 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
      OTHERWISE
           @vFI1-4.0,vCO1+8.0 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
           DO coLbln
           @vFI1-3.9,vCO1+8.2 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
 ENDCASE
 DO coLblz
 @vFI1+0.2,vCO1+08 Say "Reporte x Productos/Servicios"  Font "&mLetAri",10 Style "BT"
 @vFI2+0.2,vCO1+14 Say "Reporte x Clientes"             Font "&mLetAri",10 Style "BT"
 @vFI3+0.2,vCO1+10 Say "Reporte x Tipo de Clientes"     Font "&mLetAri",10 Style "BT"
 @vFI4+0.2,vCO1+14 Say "Reporte x Vendedor"             Font "&mLetAri",10 Style "BT"
 @vFI5+0.2,vCO1+10 Say "Reporte x Formas de Pago"       Font "&mLetAri",10 Style "BT"
 @vFI6+0.2,vCO1+08 Say "Reporte x Tipos de Productos"   Font "&mLetAri",10 Style "BT"
 @vFI7+0.2,vCO1+08 Say "Reporte x Grupo de Productos"   Font "&mLetAri",10 Style "BT"
 DO opC_1310a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO op1_1310a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_beige
 @vFI1+1.9,vCO1+71 Say "Desde" Font "&mLetRom",14 Style "NQ"
 @vFI1+4.3,vCO1+71 Say "Hasta" Font "&mLetRom",14 Style "NQ"
 @vFI1+1.9,vCO1+85 Get dFEM    Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 @vFI1+4.3,vCO1+85 Get hFEM    Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 READ TIMEOUT 0.01
ENDPROC
*
PROCEDURE Opc_1310a
 DO CASE
      CASE coPc=1
           DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
      CASE coPc=2
           DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
      CASE coPc=3
           DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
      CASE coPc=4
           DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
      CASE coPc=5
           DO prEsiona WITH "1", "ITEM0", vfI5, vcO1+2
      CASE coPc=6
           DO prEsiona WITH "1", "ITEM0", vfI6, vcO1+2
      CASE coPc=7
           DO prEsiona WITH "1", "ITEM0", vfI7, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLblz
 DO CASE
      CASE coPc=1
           @vFI1+0.2,vCO1+08 Say "Reporte x Productos/Servicios" Font "&mLetAri",10 Style "BT"
      CASE coPc=2
           @vFI2+0.2,vCO1+14 Say "Reporte x Clientes"            Font "&mLetAri",10 Style "BT"
      CASE coPc=3
           @vFI3+0.2,vCO1+10 Say "Reporte x Tipo de Clientes"    Font "&mLetAri",10 Style "BT"
      CASE coPc=4
           @vFI4+0.2,vCO1+14 Say "Reporte x Vendedor"            Font "&mLetAri",10 Style "BT"
      CASE coPc=5
           @vFI5+0.2,vCO1+10 Say "Reporte x Formas de Pago"      Font "&mLetAri",10 Style "BT"
      CASE coPc=6
           @vFI6+0.2,vCO1+08 Say "Reporte x Tipos de Productos"  Font "&mLetAri",10 Style "BT"
      CASE coPc=7
           @vFI7+0.2,vCO1+08 Say "Reporte x Grupo de Productos"  Font "&mLetAri",10 Style "BT"
 ENDCASE
 DO CASE
      CASE voPc=1
           DO prEsiona WITH "2", "ITEM0", vfI1, vcO1+2
      CASE voPc=2
           DO prEsiona WITH "2", "ITEM0", vfI2, vcO1+2
      CASE voPc=3
           DO prEsiona WITH "2", "ITEM0", vfI3, vcO1+2
      CASE voPc=4
           DO prEsiona WITH "2", "ITEM0", vfI4, vcO1+2
      CASE voPc=5
           DO prEsiona WITH "2", "ITEM0", vfI5, vcO1+2
      CASE voPc=6
           DO prEsiona WITH "2", "ITEM0", vfI6, vcO1+2
      CASE voPc=7
           DO prEsiona WITH "2", "ITEM0", vfI7, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(253,242,47,0,0,0)
 DO CASE
      CASE voPc=1
           @vFI1+0.2,vCO1+08 Say "Reporte x Productos/Servicios" Font "&mLetAri",10 Style "BT"
      CASE voPc=2
           @vFI2+0.2,vCO1+14 Say "Reporte x Clientes"            Font "&mLetAri",10 Style "BT"
      CASE voPc=3
           @vFI3+0.2,vCO1+10 Say "Reporte x Tipo de Clientes"    Font "&mLetAri",10 Style "BT"
      CASE voPc=4
           @vFI4+0.2,vCO1+14 Say "Reporte x Vendedor"            Font "&mLetAri",10 Style "BT"
      CASE voPc=5
           @vFI5+0.2,vCO1+10 Say "Reporte x Formas de Pago"      Font "&mLetAri",10 Style "BT"
      CASE voPc=6
           @vFI6+0.2,vCO1+08 Say "Reporte x Tipos de Productos"  Font "&mLetAri",10 Style "BT"
      CASE voPc=7
           @vFI7+0.2,vCO1+08 Say "Reporte x Grupo de Productos"  Font "&mLetAri",10 Style "BT"
 ENDCASE
 STORE voPc TO coPc
ENDPROC
*
PROCEDURE Op1_1310a
 DO coL_beige
 @vFI1+08.3,vCO1+71 Say "Incluye:" Font "&mLetRom",14 Style "NQ"
 @vFI1+11.3,vCO1+74 Say "Ventas"   Font "&mLetRom",14 Style "NQ"
 @vFI1+13.3,vCO1+74 Say "Compras"  Font "&mLetRom",14 Style "NQ"
 DO CASE
      CASE voPv=1
           DO prEsiona WITH "1", "SI", vfI1+11.5, vcO1+71
      CASE voPv=0
           DO prEsiona WITH "1", "NO", vfI1+11.5, vcO1+71
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO CASE
      CASE voPk=1
           DO prEsiona WITH "1", "SI", vfI1+13.5, vcO1+71
      CASE voPk=0
           DO prEsiona WITH "1", "NO", vfI1+13.5, vcO1+71
 ENDCASE
ENDPROC
*
PROCEDURE Ver_1310a
 DO CASE
      CASE viTe=1 .AND. AT(" ", DTOC(dfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. AT(" ", DTOC(hfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. dfEm>hfEm
           STORE "Fecha inicial no puede ser mayor a final..." TO mmSj
      CASE viTe=2 .AND. voPv+voPk=0
           STORE "Hay que seleccionar minimo un Grupo de búsqueda..." TO mmSj
      CASE viTe=2
           STORE SUBSTR(DTOC(dfEm), 1, 2) TO ddIa
           STORE SUBSTR(DTOC(dfEm), 4, 2) TO dmEs
           STORE SUBSTR(DTOC(dfEm), 7, 4) TO daNo
           SELECT caB_fact
           SET DELETED OFF
           GOTO TOP
           SET DELETED ON
           SET NEAR ON
           SEEK daNo+dmEs+ddIa
           SET NEAR OFF
           SELECT caB_cpra
           SET DELETED OFF
           GOTO TOP
           SET DELETED ON
           SET NEAR ON
           SEEK daNo+dmEs+ddIa
           SET NEAR OFF
           IF dfEm<>cdFe .OR. hfEm<>chFe .OR. voPc<>coP1 .OR. voPv<>coPv  ;
              .OR. voPk<>coPk
                SELECT teMporal_1
                SET ORDER TO FTM1COD
                SELECT teMporal_2
                SET ORDER TO FTM1COD
                IF voPv=1
                     STORE 01 TO meRr
                     SELECT deT_cpra
                     SET ORDER TO F2401COD
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     STORE 00 TO meRr
                ENDIF
                WAIT WINDOW NOWAIT  ;
                     "L E Y E N D O  FA/BO... Presionar ESC para Salir"+ ;
                     CHR(13)+"Hora Inicial de Lectura: "+TIME()
                SET ESCAPE ON
                ON ESCAPE STORE 9000 TO MKEY
                IF voPv=1
                     DO prV_1310a
                     STORE 01 TO meRr
                     SELECT deT_cpra
                     SET ORDER TO F2401DOC
                     IF mkEy=k_Esc
                          WAIT CLEAR
                          ON ESCAPE
                          SET ESCAPE OFF
                          EXIT
                     ENDIF
                     STORE 00 TO meRr
                ENDIF
                IF voPk=1
                     DO prC_1310a
                ENDIF
                ON ESCAPE
                SET ESCAPE OFF
                WAIT WINDOW NOWAIT "Hora Final de Lectura: "+TIME()
                = INKEY(0.5)
                WAIT CLEAR
                IF mkEy=9000
                     STORE "Proceso Interrumpido..." TO mmSj
                ELSE
                     SELECT teMporal_1
                     GOTO TOP
                     IF BOF()
                          SELECT teMporal_2
                          GOTO TOP
                          IF BOF()
                               STORE "No hay datos en este rango de Fecha..."  ;
                                     TO mmSj
                          ENDIF
                     ENDIF
                ENDIF
           ENDIF
 ENDCASE
 IF LEN(ALLTRIM(mmSj))<>0
      DO poNmsj
      STORE 99 TO mkEy
 ENDIF
ENDPROC
*
PROCEDURE PrV_1310a
 PRIVATE pcOs, ptDo, psEr, pdOc
 SELECT teMporal_1
 ZAP
 REINDEX
 SELECT caB_fact
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f1300tdo="CT" .OR. f1300est$"89" .OR. f1300tdo="PC"
           SKIP
           LOOP
      ENDIF
      STORE f1300tdo TO vtDo
      STORE f1300ser TO vsEr
      STORE f1300doc TO vdOc
      IF voPc=1 .OR. voPc=6 .OR. voPc=7
           SELECT deT_fact
           SET DELETED OFF
           GOTO TOP
           SET DELETED ON
           SEEK vtDo+vsEr+vdOc
           IF EOF()
                SELECT caB_fact
                SKIP
                LOOP
           ENDIF
      ENDIF
      SELECT caB_fact
      STORE f1300mon TO vmOn
      STORE f1300tot TO vtOt
      STORE f1300fem TO vfEm
      STORE SUBSTR(DTOC(vfEm), 1, 2) TO vdIa
      STORE SUBSTR(DTOC(vfEm), 4, 2) TO vmEs
      STORE SUBSTR(DTOC(vfEm), 7, 4) TO vaNo
      SELECT caMbio
      SEEK vfEm
      IF EOF()
           STORE 1 TO vtCa
      ELSE
           STORE f9111tc3 TO vtCa
      ENDIF
      SELECT caB_fact
      DO CASE
           CASE voPc=2
                STORE f1300cli TO vcOd
                STORE f1300nom TO vnOm
                DO CASE
                     CASE LEN(ALLTRIM(f1300ruc))<>0
                          STORE f1300ruc TO vcOd
                     CASE LEN(ALLTRIM(f1300ele))<>0
                          STORE f1300ele TO vcOd
                ENDCASE
           CASE voPc=3
                STORE f1300cli TO vcLi
                STORE "**" TO vcOd
                STORE "Tipo de Cliente Varios" TO vnOm
                SELECT clIentes
                SEEK vcLi
                IF  .NOT. EOF()
                     STORE f1101tip TO vcOd
                     SELECT tiPo_cl
                     SEEK vcOd
                     IF  .NOT. EOF()
                          STORE f9110nti TO vnOm
                     ENDIF
                ENDIF
           CASE voPc=4
                STORE f1300ven TO vcOd
                STORE f1300nve TO vnOm
           CASE voPc=5
                STORE f1300fpa TO vcOd
                STORE f1300nfp TO vnOm
      ENDCASE
      IF voPc<>1 .AND. voPc<>6 .AND. voPc<>7
           STORE " " TO vnUv
           STORE 0 TO vcAn, vsTo, vmIn, vmAx, vnEg
           DO grA_1310a WITH "1"
      ELSE
           SELECT deT_fact
           DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=vtDo+ ;
              vsEr+vdOc
                IF mkEy=9000
                     RETURN
                ENDIF
                STORE f1301cod TO vcOd
                STORE f1301des TO vnOm
                STORE f1301nuv TO vnUv
                STORE f1301can TO vcAn
                STORE f1301to2 TO vtOt
                STORE vtOt/vcAn TO vpRe
                IF vmOn=2
                     STORE ROUND(vpRe*vtCa, 2) TO vpRe
                ENDIF
                IF voPc=1
                     SELECT prOductos
                     SEEK ALLTRIM(vcOd)+"*"
                     IF EOF()
                          STORE 0 TO vsTo, vmIn, vmAx, vvCs, vtPo
                          STORE 1 TO vpIe, vtP1
                     ELSE
                          STORE f2111sto TO vsTo
                          STORE f2111min TO vmIn
                          STORE f2111max TO vmAx
                          STORE f2111tip TO vtPr
                          STORE f2111tpo TO vtP1
                          SELECT tiP_prod
                          SEEK vtPr
                          IF EOF()
                               STORE 1 TO vtPo
                          ELSE
                               STORE f9211tpo TO vtPo
                          ENDIF
                          SELECT prOductos
                          DO CASE
                               CASE vtPo=1 .AND. f2111la1<>0 .AND. f2111an1<>0
                                    STORE ROUND(f2111la1*f2111an1*mfCt,  ;
                                     8) TO vpIe
                               CASE vtPo=1 .AND. f2111la2<>0 .AND. f2111an2<>0
                                    STORE ROUND(f2111la2*f2111an2/mfCp,  ;
                                     8) TO vpIe
                               OTHERWISE
                                    STORE 1 TO vpIe
                          ENDCASE
                          DO CASE
                               CASE f2111tpo=2
                                    STORE 0 TO vvCs
                               CASE f2111vcs<>0
                                    STORE f2111vcs*vpIe TO vvCs
                               CASE f2111vcp<>0
                                    STORE f2111vcp*vtCa*vpIe TO vvCs
                               OTHERWISE
                                    STORE 0 TO vvCs
                          ENDCASE
                     ENDIF
                     IF vtP1<>2
                          SELECT kaRdex
                          SEEK ALLTRIM(vcOd)+"*"+"CO"
                          DO CASE
                               CASE  .NOT. EOF() .AND. f2990ano+f2990mes+ ;
                                     f2990dia>vaNo+vmEs+vdIa
                                    STORE f2990tfa TO pcOs
                                    STORE f2990tdo TO ptDo
                                    STORE f2990ser TO psEr
                                    STORE f2990doc TO pdOc
                                    SELECT deT_cpra
                                    SEEK ALLTRIM(vcOd)+"*"+ptDo+psEr+pdOc
                                    IF  .NOT. EOF()
                                         STORE f2401pre*1.18 TO pcOs
                                    ENDIF
                                    SELECT kaRdex
                                    IF f2990mon=1
                                         STORE pcOs TO vvCs
                                    ELSE
                                         STORE ROUND(pcOs*vtCa, 2) TO vvCs
                                    ENDIF
                               CASE  .NOT. EOF()
                                    SET NEAR ON
                                    SEEK ALLTRIM(vcOd)+"*"+"CO"+vaNo+vmEs+vdIa
                                    SET NEAR OFF
                                    IF EOF() .OR. ALLTRIM(f2990cod)+"*"<> ;
                                       ALLTRIM(vcOd)+"*" .OR. f2990tdo<>"CO"
                                         IF EOF()
                                              GOTO BOTTOM
                                         ELSE
                                              SKIP -1
                                         ENDIF
                                    ENDIF
                                    IF f2990ano+f2990mes+f2990dia>vaNo+ ;
                                       vmEs+vdIa
                                         SKIP -1
                                         IF BOF() .OR. ALLTRIM(f2990cod)+ ;
                                          "*"<>ALLTRIM(vcOd)+"*" .OR.  ;
                                          f2990tdo<>"CO"
                                              IF BOF()
                                                   GOTO BOTTOM
                                              ELSE
                                                   SKIP
                                              ENDIF
                                         ENDIF
                                    ENDIF
                                    STORE f2990tfa TO pcOs
                                    STORE f2990tdo TO ptDo
                                    STORE f2990ser TO psEr
                                    STORE f2990doc TO pdOc
                                    SELECT deT_cpra
                                    SEEK ALLTRIM(vcOd)+"*"+ptDo+psEr+pdOc
                                    IF  .NOT. EOF()
                                         STORE f2401pre*1.18 TO pcOs
                                    ENDIF
                                    SELECT kaRdex
                                    IF f2990mon=1
                                         STORE pcOs TO vvCs
                                    ELSE
                                         STORE ROUND(pcOs*vtCa, 2) TO vvCs
                                    ENDIF
                          ENDCASE
                     ENDIF
                     STORE vvCs*vcAn TO vvCs
                     IF vvCs<=0 .OR. vvCs>(vpRe*vcAn)
                          STORE 1 TO vnEg
                     ELSE
                          STORE 0 TO vnEg
                     ENDIF
                     DO grA_1310a WITH "1"
                ELSE
                     STORE " " TO vnUv
                     SELECT prOductos
                     SEEK ALLTRIM(vcOd)+"*"
                     IF EOF()
                          STORE 0 TO vsTo, vmIn, vmAx
                          STORE "**" TO vgRu, vtPr
                          STORE "Sin Grupo" TO vnGr
                          STORE "Sin Tipo" TO vnTp
                     ELSE
                          STORE f2111gru TO vgRu
                          STORE f2111tip TO vtPr
                          STORE f2111sto TO vsTo
                          STORE f2111min TO vmIn
                          STORE f2111max TO vmAx
                          SELECT grUpos
                          SEEK vgRu
                          IF EOF()
                               STORE "**" TO vgRu
                               STORE "Sin Grupo" TO vnGr
                          ELSE
                               STORE f9216des TO vnGr
                          ENDIF
                          SELECT tiP_prod
                          SEEK vtPr
                          DO CASE
                               CASE EOF()
                                    STORE "**" TO vtPr
                                    STORE "Sin Tipo" TO vnTp
                               OTHERWISE
                                    STORE f9211nti TO vnTp
                          ENDCASE
                     ENDIF
                     DO CASE
                          CASE voPc=6
                               STORE vtPr TO vcOd
                               STORE vnTp TO vnOm
                          OTHERWISE
                               STORE vgRu TO vcOd
                               STORE vnGr TO vnOm
                     ENDCASE
                     STORE 0 TO vnEg
                     DO grA_1310a WITH "1"
                ENDIF
                SELECT deT_fact
                SKIP
           ENDDO
      ENDIF
      SELECT caB_fact
      SKIP
 ENDDO
 UNLOCK ALL
 FLUSH
 WAIT WINDOW NOWAIT "T O T A L I Z A N D O... Presionar ESC para Salir"
 SELECT teMporal_1
 REPLACE ftM1enu WITH ftM1en1-ftM1enk, ftM1enw WITH ftM1en2-ftM1end ALL
 REPLACE ftM1feu WITH ftM1fe1-ftM1fek, ftM1few WITH ftM1fe2-ftM1fed ALL
 REPLACE ftM1mau WITH ftM1ma1-ftM1mak, ftM1maw WITH ftM1ma2-ftM1mad ALL
 REPLACE ftM1abu WITH ftM1ab1-ftM1abk, ftM1abw WITH ftM1ab2-ftM1abd ALL
 REPLACE ftM1myu WITH ftM1my1-ftM1myk, ftM1myw WITH ftM1my2-ftM1myd ALL
 REPLACE ftM1juu WITH ftM1ju1-ftM1juk, ftM1juw WITH ftM1ju2-ftM1jud ALL
 REPLACE ftM1jlu WITH ftM1jl1-ftM1jlk, ftM1jlw WITH ftM1jl2-ftM1jld ALL
 REPLACE ftM1agu WITH ftM1ag1-ftM1agk, ftM1agw WITH ftM1ag2-ftM1agd ALL
 REPLACE ftM1seu WITH ftM1se1-ftM1sek, ftM1sew WITH ftM1se2-ftM1sed ALL
 REPLACE ftM1ocu WITH ftM1oc1-ftM1ock, ftM1ocw WITH ftM1oc2-ftM1ocd ALL
 REPLACE ftM1nou WITH ftM1no1-ftM1nok, ftM1now WITH ftM1no2-ftM1nod ALL
 REPLACE ftM1diu WITH ftM1di1-ftM1dik, ftM1diw WITH ftM1di2-ftM1did ALL
 SUM ftM1en1 TO tvEn1 ALL
 SUM ftM1en2 TO tvEn2 ALL
 SUM ftM1enc TO tvEnc ALL
 SUM ftM1enk TO tvEnk ALL
 SUM ftM1end TO tvEnd ALL
 SUM ftM1enu TO tvEnu ALL
 SUM ftM1enw TO tvEnw ALL
 SUM ftM1fe1 TO tvFe1 ALL
 SUM ftM1fe2 TO tvFe2 ALL
 SUM ftM1fec TO tvFec ALL
 SUM ftM1fek TO tvFek ALL
 SUM ftM1fed TO tvFed ALL
 SUM ftM1feu TO tvFeu ALL
 SUM ftM1few TO tvFew ALL
 SUM ftM1ma1 TO tvMa1 ALL
 SUM ftM1ma2 TO tvMa2 ALL
 SUM ftM1mac TO tvMac ALL
 SUM ftM1mak TO tvMak ALL
 SUM ftM1mad TO tvMad ALL
 SUM ftM1mau TO tvMau ALL
 SUM ftM1maw TO tvMaw ALL
 SUM ftM1ab1 TO tvAb1 ALL
 SUM ftM1ab2 TO tvAb2 ALL
 SUM ftM1abc TO tvAbc ALL
 SUM ftM1abk TO tvAbk ALL
 SUM ftM1abd TO tvAbd ALL
 SUM ftM1abu TO tvAbu ALL
 SUM ftM1abw TO tvAbw ALL
 SUM ftM1my1 TO tvMy1 ALL
 SUM ftM1my2 TO tvMy2 ALL
 SUM ftM1myc TO tvMyc ALL
 SUM ftM1myk TO tvMyk ALL
 SUM ftM1myd TO tvMyd ALL
 SUM ftM1myu TO tvMyu ALL
 SUM ftM1myw TO tvMyw ALL
 SUM ftM1ju1 TO tvJu1 ALL
 SUM ftM1ju2 TO tvJu2 ALL
 SUM ftM1juc TO tvJuc ALL
 SUM ftM1juk TO tvJuk ALL
 SUM ftM1jud TO tvJud ALL
 SUM ftM1juu TO tvJuu ALL
 SUM ftM1juw TO tvJuw ALL
 SUM ftM1jl1 TO tvJl1 ALL
 SUM ftM1jl2 TO tvJl2 ALL
 SUM ftM1jlc TO tvJlc ALL
 SUM ftM1jlk TO tvJlk ALL
 SUM ftM1jld TO tvJld ALL
 SUM ftM1jlu TO tvJlu ALL
 SUM ftM1jlw TO tvJlw ALL
 SUM ftM1ag1 TO tvAg1 ALL
 SUM ftM1ag2 TO tvAg2 ALL
 SUM ftM1agc TO tvAgc ALL
 SUM ftM1agk TO tvAgk ALL
 SUM ftM1agd TO tvAgd ALL
 SUM ftM1agu TO tvAgu ALL
 SUM ftM1agw TO tvAgw ALL
 SUM ftM1se1 TO tvSe1 ALL
 SUM ftM1se2 TO tvSe2 ALL
 SUM ftM1sec TO tvSec ALL
 SUM ftM1sek TO tvSek ALL
 SUM ftM1sed TO tvSed ALL
 SUM ftM1seu TO tvSeu ALL
 SUM ftM1sew TO tvSew ALL
 SUM ftM1oc1 TO tvOc1 ALL
 SUM ftM1oc2 TO tvOc2 ALL
 SUM ftM1occ TO tvOcc ALL
 SUM ftM1ock TO tvOck ALL
 SUM ftM1ocd TO tvOcd ALL
 SUM ftM1ocu TO tvOcu ALL
 SUM ftM1ocw TO tvOcw ALL
 SUM ftM1no1 TO tvNo1 ALL
 SUM ftM1no2 TO tvNo2 ALL
 SUM ftM1noc TO tvNoc ALL
 SUM ftM1nok TO tvNok ALL
 SUM ftM1nod TO tvNod ALL
 SUM ftM1nou TO tvNou ALL
 SUM ftM1now TO tvNow ALL
 SUM ftM1di1 TO tvDi1 ALL
 SUM ftM1di2 TO tvDi2 ALL
 SUM ftM1dic TO tvDic ALL
 SUM ftM1dik TO tvDik ALL
 SUM ftM1did TO tvDid ALL
 SUM ftM1diu TO tvDiu ALL
 SUM ftM1diw TO tvDiw ALL
 RELEASE pcOs, ptDo, psEr, pdOc
ENDPROC
*
PROCEDURE PrC_1310a
 IF voPc=2 .OR. voPc=3 .OR. voPc=4 .OR. voPc=5
      RETURN
 ENDIF
 SELECT teMporal_2
 ZAP
 REINDEX
 SELECT caB_cpra
 STORE 0 TO tcEn1, tcFe1, tcMa1, tcAb1, tcMy1, tcJu1, tcJl1, tcAg1, tcSe1,  ;
       tcOc1, tcNo1, tcDi1
 STORE 0 TO tcEn2, tcFe2, tcMa2, tcAb2, tcMy2, tcJu2, tcJl2, tcAg2, tcSe2,  ;
       tcOc2, tcNo2, tcDi2
 STORE 0 TO tcEnc, tcFec, tcMac, tcAbc, tcMyc, tcJuc, tcJlc, tcAgc, tcSec,  ;
       tcOcc, tcNoc, tcDic
 STORE 0 TO tcEnf, tcFef, tcMaf, tcAbf, tcMyf, tcJuf, tcJlf, tcAgf, tcSef,  ;
       tcOcf, tcNof, tcDif
 DO WHILE  .NOT. EOF() .AND. f2400fem>=dfEm .AND. f2400fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f2400tpo=2 .OR. f2400est$"89"
           SKIP
           LOOP
      ENDIF
      STORE f2400tdo TO vtDo
      STORE f2400ser TO vsEr
      STORE f2400doc TO vdOc
      STORE f2400pig TO vpIg
      SELECT deT_cpra
      SET DELETED OFF
      GOTO TOP
      SET DELETED ON
      SEEK vtDo+vsEr+vdOc
      IF EOF()
           SELECT caB_cpra
           SKIP
           LOOP
      ENDIF
      SELECT caB_cpra
      STORE f2400mon TO vmOn
      STORE f2400tot TO vtOt
      STORE f2400fem TO vfEm
      STORE SUBSTR(DTOC(vfEm), 1, 2) TO vdIa
      STORE SUBSTR(DTOC(vfEm), 4, 2) TO vmEs
      STORE SUBSTR(DTOC(vfEm), 7, 4) TO vaNo
      SELECT caMbio
      SEEK vfEm
      IF EOF()
           STORE 1 TO vtCa
      ELSE
           STORE f9111tc3 TO vtCa
      ENDIF
      SELECT deT_cpra
      DO WHILE  .NOT. EOF() .AND. f2401tdo+f2401ser+f2401doc=vtDo+vsEr+vdOc
           IF mkEy=9000
                RETURN
           ENDIF
           STORE f2401cod TO vcOd
           STORE f2401des TO vnOm
           STORE f2401nuv TO vnUv
           STORE f2401can TO vcAn
           STORE f2401pre*f2401can TO vtOt
           STORE vtOt*(1+(vpIg/100)) TO vtOt
           IF voPc=1
                SELECT prOductos
                SEEK ALLTRIM(vcOd)+"*"
                IF EOF()
                     STORE 0 TO vsTo, vmIn, vmAx
                ELSE
                     STORE f2111sto TO vsTo
                     STORE f2111min TO vmIn
                     STORE f2111max TO vmAx
                ENDIF
                STORE 0 TO vnEg
                DO grA_1310a WITH "2"
           ELSE
                STORE " " TO vnUv
                SELECT prOductos
                SEEK ALLTRIM(vcOd)+"*"
                IF EOF()
                     STORE 0 TO vsTo, vmIn, vmAx
                     STORE "**" TO vgRu, vtPr
                     STORE "Sin Grupo" TO vnGr
                     STORE "Sin Tipo" TO vnTp
                ELSE
                     STORE f2111gru TO vgRu
                     STORE f2111tip TO vtPr
                     STORE f2111sto TO vsTo
                     STORE f2111min TO vmIn
                     STORE f2111max TO vmAx
                     SELECT grUpos
                     SEEK vgRu
                     IF EOF()
                          STORE "**" TO vgRu
                          STORE "Sin Grupo" TO vnGr
                     ELSE
                          STORE f9216des TO vnGr
                     ENDIF
                     SELECT tiP_prod
                     SEEK vtPr
                     DO CASE
                          CASE EOF()
                               STORE "**" TO vtPr
                               STORE "Sin Tipo" TO vnTp
                          OTHERWISE
                               STORE f9211nti TO vnTp
                     ENDCASE
                ENDIF
                DO CASE
                     CASE voPc=6
                          STORE vtPr TO vcOd
                          STORE vnTp TO vnOm
                     OTHERWISE
                          STORE vgRu TO vcOd
                          STORE vnGr TO vnOm
                ENDCASE
                STORE 0 TO vnEg
                DO grA_1310a WITH "2"
           ENDIF
           SELECT deT_cpra
           SKIP
      ENDDO
      SELECT caB_cpra
      SKIP
 ENDDO
 WAIT WINDOW NOWAIT "T O T A L I Z A N D O... Presionar ESC para Salir"
 SELECT teMporal_2
 SUM ftM1en1 TO tcEn1 ALL
 SUM ftM1en2 TO tcEn2 ALL
 SUM ftM1enc TO tcEnc ALL
 SUM ftM1fe1 TO tcFe1 ALL
 SUM ftM1fe2 TO tcFe2 ALL
 SUM ftM1fec TO tcFec ALL
 SUM ftM1ma1 TO tcMa1 ALL
 SUM ftM1ma2 TO tcMa2 ALL
 SUM ftM1mac TO tcMac ALL
 SUM ftM1ab1 TO tcAb1 ALL
 SUM ftM1ab2 TO tcAb2 ALL
 SUM ftM1abc TO tcAbc ALL
 SUM ftM1my1 TO tcMy1 ALL
 SUM ftM1my2 TO tcMy2 ALL
 SUM ftM1myc TO tcMyc ALL
 SUM ftM1ju1 TO tcJu1 ALL
 SUM ftM1ju2 TO tcJu2 ALL
 SUM ftM1juc TO tcJuc ALL
 SUM ftM1jl1 TO tcJl1 ALL
 SUM ftM1jl2 TO tcJl2 ALL
 SUM ftM1jlc TO tcJlc ALL
 SUM ftM1ag1 TO tcAg1 ALL
 SUM ftM1ag2 TO tcAg2 ALL
 SUM ftM1agc TO tcAgc ALL
 SUM ftM1se1 TO tcSe1 ALL
 SUM ftM1se2 TO tcSe2 ALL
 SUM ftM1sec TO tcSec ALL
 SUM ftM1oc1 TO tcOc1 ALL
 SUM ftM1oc2 TO tcOc2 ALL
 SUM ftM1occ TO tcOcc ALL
 SUM ftM1no1 TO tcNo1 ALL
 SUM ftM1no2 TO tcNo2 ALL
 SUM ftM1noc TO tcNoc ALL
 SUM ftM1di1 TO tcDi1 ALL
 SUM ftM1di2 TO tcDi2 ALL
 SUM ftM1dic TO tcDic ALL
 SUM ftM1enc-ftM1min TO tvEnf ALL
 SUM ftM1fec-ftM1min TO tvFef ALL
 SUM ftM1mac-ftM1min TO tvMaf ALL
 SUM ftM1abc-ftM1min TO tvAbf ALL
 SUM ftM1myc-ftM1min TO tvMyf ALL
 SUM ftM1juc-ftM1min TO tvJuf ALL
 SUM ftM1jlc-ftM1min TO tvJlf ALL
 SUM ftM1agc-ftM1min TO tvAgf ALL
 SUM ftM1sec-ftM1min TO tvSef ALL
 SUM ftM1occ-ftM1min TO tvOcf ALL
 SUM ftM1noc-ftM1min TO tvNof ALL
 SUM ftM1dic-ftM1min TO tvDif ALL
ENDPROC
*
PROCEDURE Gra_1310a
 PARAMETER ptPo
 PRIVATE pvCs, pvCd, psOl, puSd
 DO CASE
      CASE ptPo="1"
           SELECT teMporal_1
      CASE ptPo="2"
           SELECT teMporal_2
 ENDCASE
 SEEK ALLTRIM(vcOd)+"*"
 IF EOF()
      APPEND BLANK
      REPLACE ftM1cod WITH vcOd
      REPLACE ftM1nom WITH vnOm
      REPLACE ftM1nuv WITH vnUv
      REPLACE ftM1sto WITH vsTo
      REPLACE ftM1min WITH vmIn
      REPLACE ftM1max WITH vmAx
      REPLACE ftM1enc WITH 0
      REPLACE ftM1fec WITH 0
      REPLACE ftM1mac WITH 0
      REPLACE ftM1abc WITH 0
      REPLACE ftM1myc WITH 0
      REPLACE ftM1juc WITH 0
      REPLACE ftM1jlc WITH 0
      REPLACE ftM1agc WITH 0
      REPLACE ftM1sec WITH 0
      REPLACE ftM1occ WITH 0
      REPLACE ftM1noc WITH 0
      REPLACE ftM1dic WITH 0
      REPLACE ftM1en1 WITH 0
      REPLACE ftM1fe1 WITH 0
      REPLACE ftM1ma1 WITH 0
      REPLACE ftM1ab1 WITH 0
      REPLACE ftM1my1 WITH 0
      REPLACE ftM1ju1 WITH 0
      REPLACE ftM1jl1 WITH 0
      REPLACE ftM1ag1 WITH 0
      REPLACE ftM1se1 WITH 0
      REPLACE ftM1oc1 WITH 0
      REPLACE ftM1no1 WITH 0
      REPLACE ftM1di1 WITH 0
      REPLACE ftM1en2 WITH 0
      REPLACE ftM1fe2 WITH 0
      REPLACE ftM1ma2 WITH 0
      REPLACE ftM1ab2 WITH 0
      REPLACE ftM1my2 WITH 0
      REPLACE ftM1ju2 WITH 0
      REPLACE ftM1jl2 WITH 0
      REPLACE ftM1ag2 WITH 0
      REPLACE ftM1se2 WITH 0
      REPLACE ftM1oc2 WITH 0
      REPLACE ftM1no2 WITH 0
      REPLACE ftM1di2 WITH 0
      IF ptPo="1"
           REPLACE ftM1enn WITH 0
           REPLACE ftM1fen WITH 0
           REPLACE ftM1man WITH 0
           REPLACE ftM1abn WITH 0
           REPLACE ftM1myn WITH 0
           REPLACE ftM1jun WITH 0
           REPLACE ftM1jln WITH 0
           REPLACE ftM1agn WITH 0
           REPLACE ftM1sen WITH 0
           REPLACE ftM1ocn WITH 0
           REPLACE ftM1non WITH 0
           REPLACE ftM1din WITH 0
           REPLACE ftM1enk WITH 0
           REPLACE ftM1fek WITH 0
           REPLACE ftM1mak WITH 0
           REPLACE ftM1abk WITH 0
           REPLACE ftM1myk WITH 0
           REPLACE ftM1juk WITH 0
           REPLACE ftM1jlk WITH 0
           REPLACE ftM1agk WITH 0
           REPLACE ftM1sek WITH 0
           REPLACE ftM1ock WITH 0
           REPLACE ftM1nok WITH 0
           REPLACE ftM1dik WITH 0
           REPLACE ftM1end WITH 0
           REPLACE ftM1fed WITH 0
           REPLACE ftM1mad WITH 0
           REPLACE ftM1abd WITH 0
           REPLACE ftM1myd WITH 0
           REPLACE ftM1jud WITH 0
           REPLACE ftM1jld WITH 0
           REPLACE ftM1agd WITH 0
           REPLACE ftM1sed WITH 0
           REPLACE ftM1ocd WITH 0
           REPLACE ftM1nod WITH 0
           REPLACE ftM1did WITH 0
           REPLACE ftM1enu WITH 0
           REPLACE ftM1feu WITH 0
           REPLACE ftM1mau WITH 0
           REPLACE ftM1abu WITH 0
           REPLACE ftM1myu WITH 0
           REPLACE ftM1juu WITH 0
           REPLACE ftM1jlu WITH 0
           REPLACE ftM1agu WITH 0
           REPLACE ftM1seu WITH 0
           REPLACE ftM1ocu WITH 0
           REPLACE ftM1nou WITH 0
           REPLACE ftM1diu WITH 0
           REPLACE ftM1enw WITH 0
           REPLACE ftM1few WITH 0
           REPLACE ftM1maw WITH 0
           REPLACE ftM1abw WITH 0
           REPLACE ftM1myw WITH 0
           REPLACE ftM1juw WITH 0
           REPLACE ftM1jlw WITH 0
           REPLACE ftM1agw WITH 0
           REPLACE ftM1sew WITH 0
           REPLACE ftM1ocw WITH 0
           REPLACE ftM1now WITH 0
           REPLACE ftM1diw WITH 0
      ENDIF
 ENDIF
 IF vmOn=1
      STORE ROUND(vtOt, 1) TO psOl
      STORE ROUND(vtOt/vtCa, 1) TO puSd
 ELSE
      STORE ROUND(vtOt, 1) TO puSd
      STORE ROUND(vtOt*vtCa, 1) TO psOl
 ENDIF
 DO CASE
      CASE vmEs="01"
           REPLACE ftM1enc WITH ftM1enc+vcAn
           REPLACE ftM1en1 WITH ftM1en1+psOl
           REPLACE ftM1en2 WITH ftM1en2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1enn WITH 1
           ENDIF
      CASE vmEs="02"
           REPLACE ftM1fec WITH ftM1fec+vcAn
           REPLACE ftM1fe1 WITH ftM1fe1+psOl
           REPLACE ftM1fe2 WITH ftM1fe2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1fen WITH 1
           ENDIF
      CASE vmEs="03"
           REPLACE ftM1mac WITH ftM1mac+vcAn
           REPLACE ftM1ma1 WITH ftM1ma1+psOl
           REPLACE ftM1ma2 WITH ftM1ma2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1man WITH 1
           ENDIF
      CASE vmEs="04"
           REPLACE ftM1abc WITH ftM1abc+vcAn
           REPLACE ftM1ab1 WITH ftM1ab1+psOl
           REPLACE ftM1ab2 WITH ftM1ab2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1abn WITH 1
           ENDIF
      CASE vmEs="05"
           REPLACE ftM1myc WITH ftM1myc+vcAn
           REPLACE ftM1my1 WITH ftM1my1+psOl
           REPLACE ftM1my2 WITH ftM1my2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1myn WITH 1
           ENDIF
      CASE vmEs="06"
           REPLACE ftM1juc WITH ftM1juc+vcAn
           REPLACE ftM1ju1 WITH ftM1ju1+psOl
           REPLACE ftM1ju2 WITH ftM1ju2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1jun WITH 1
           ENDIF
      CASE vmEs="07"
           REPLACE ftM1jlc WITH ftM1jlc+vcAn
           REPLACE ftM1jl1 WITH ftM1jl1+psOl
           REPLACE ftM1jl2 WITH ftM1jl2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1jln WITH 1
           ENDIF
      CASE vmEs="08"
           REPLACE ftM1agc WITH ftM1agc+vcAn
           REPLACE ftM1ag1 WITH ftM1ag1+psOl
           REPLACE ftM1ag2 WITH ftM1ag2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1agn WITH 1
           ENDIF
      CASE vmEs="09"
           REPLACE ftM1sec WITH ftM1sec+vcAn
           REPLACE ftM1se1 WITH ftM1se1+psOl
           REPLACE ftM1se2 WITH ftM1se2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1sen WITH 1
           ENDIF
      CASE vmEs="10"
           REPLACE ftM1occ WITH ftM1occ+vcAn
           REPLACE ftM1oc1 WITH ftM1oc1+psOl
           REPLACE ftM1oc2 WITH ftM1oc2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1ocn WITH 1
           ENDIF
      CASE vmEs="11"
           REPLACE ftM1noc WITH ftM1noc+vcAn
           REPLACE ftM1no1 WITH ftM1no1+psOl
           REPLACE ftM1no2 WITH ftM1no2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1non WITH 1
           ENDIF
      CASE vmEs="12"
           REPLACE ftM1dic WITH ftM1dic+vcAn
           REPLACE ftM1di1 WITH ftM1di1+psOl
           REPLACE ftM1di2 WITH ftM1di2+puSd
           IF ptPo="1" .AND. vnEg=1
                REPLACE ftM1din WITH 1
           ENDIF
 ENDCASE
 IF ptPo="1" .AND. voPc=1
      STORE ROUND(vvCs, 1) TO pvCs
      STORE ROUND(vvCs/vtCa, 1) TO pvCp
      DO CASE
           CASE vmEs="01"
                REPLACE ftM1enk WITH ftM1enk+pvCs
                REPLACE ftM1end WITH ftM1end+pvCp
           CASE vmEs="02"
                REPLACE ftM1fek WITH ftM1fek+pvCs
                REPLACE ftM1fed WITH ftM1fed+pvCp
           CASE vmEs="03"
                REPLACE ftM1mak WITH ftM1mak+pvCs
                REPLACE ftM1mad WITH ftM1mad+pvCp
           CASE vmEs="04"
                REPLACE ftM1abk WITH ftM1abk+pvCs
                REPLACE ftM1abd WITH ftM1abd+pvCp
           CASE vmEs="05"
                REPLACE ftM1myk WITH ftM1myk+pvCs
                REPLACE ftM1myd WITH ftM1myd+pvCp
           CASE vmEs="06"
                REPLACE ftM1juk WITH ftM1juk+pvCs
                REPLACE ftM1jud WITH ftM1jud+pvCp
           CASE vmEs="07"
                REPLACE ftM1jlk WITH ftM1jlk+pvCs
                REPLACE ftM1jld WITH ftM1jld+pvCp
           CASE vmEs="08"
                REPLACE ftM1agk WITH ftM1agk+pvCs
                REPLACE ftM1agd WITH ftM1agd+pvCp
           CASE vmEs="09"
                REPLACE ftM1sek WITH ftM1sek+pvCs
                REPLACE ftM1sed WITH ftM1sed+pvCp
           CASE vmEs="10"
                REPLACE ftM1ock WITH ftM1ock+pvCs
                REPLACE ftM1ocd WITH ftM1ocd+pvCp
           CASE vmEs="11"
                REPLACE ftM1nok WITH ftM1nok+pvCs
                REPLACE ftM1nod WITH ftM1nod+pvCp
           CASE vmEs="12"
                REPLACE ftM1dik WITH ftM1dik+pvCs
                REPLACE ftM1did WITH ftM1did+pvCp
      ENDCASE
 ENDIF
 RELEASE pvCs, pvCd, psOl, puSd
ENDPROC
*
PROCEDURE Clp_1310a
 = INKEY(0.01)
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Enter TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.80
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfI1+11.428 .AND. mfIl<=vfI1+12.428 .AND. mcCc>=vcO1+71  ;
           .AND. mcCc<=vcO1+73.6
           IF voPv=1
                STORE 0 TO voPv
           ELSE
                STORE 1 TO voPv
           ENDIF
           DO op1_1310a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+13.428 .AND. mfIl<=vfI1+14.428 .AND. mcCc>=vcO1+71  ;
           .AND. mcCc<=vcO1+73.6
           IF voPk=1
                STORE 0 TO voPk
           ELSE
                STORE 1 TO voPk
           ENDIF
           DO op1_1310a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1-0.35 .AND. mfIl<=vfI1+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>1
           STORE 1 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI2-0.35 .AND. mfIl<=vfI2+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>2
           STORE 2 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI3-0.35 .AND. mfIl<=vfI3+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>3
           STORE 3 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI4-0.35 .AND. mfIl<=vfI4+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>4
           STORE 4 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI5-0.35 .AND. mfIl<=vfI5+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>5
           STORE 5 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI6-0.35 .AND. mfIl<=vfI6+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>6
           STORE 6 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI7-0.35 .AND. mfIl<=vfI7+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>7
           STORE 7 TO voPc
           DO opC_1310a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI1+1.786 .AND. mfIl<=vfI1+3.428 .AND. mcCc>=vcO1+69.8  ;
           .AND. mcCc<=vcO1+100 .AND. viTe<>1
           STORE 01 TO viTe
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+4.214 .AND. mfIl<=vfI1+5.786 .AND. mcCc>=vcO1+69.8  ;
           .AND. mcCc<=vcO1+100 .AND. viTe<>2
           IF viTe=1
                DO veR_1310a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 2 TO viTe
           ENDIF
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
ENDPROC
*
PROCEDURE Hlp_1310a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0.2 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Este Programa tiene varias opciones para ordenar la información de Ven-"
 @ pfIl+01, 02 SAY  ;
   "tas por pantalla o impresora x Meses. Se puede verla todo en Soles o to-"
 @ pfIl+02, 02 SAY "do en Dolares."
 @ pfIl+04, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+06, 20 SAY ":" STYLE "BT"
 @ pfIl+07, 20 SAY ":" STYLE "BT"
 @ pfIl+08, 20 SAY ":" STYLE "BT"
 @ pfIl+09, 20 SAY ":" STYLE "BT"
 @ pfIl+11, 20 SAY ":" STYLE "BT"
 @ pfIl+12, 20 SAY ":" STYLE "BT"
 @ pfIl+06, 02 SAY "ESC" STYLE "BT"
 @ pfIl+07, 02 SAY "F10" STYLE "BT"
 @ pfIl+08, 02 SAY "F1" STYLE "BT"
 @ pfIl+09, 02 SAY "ENTER, CTRL ->," STYLE "BT"
 @ pfIl+10, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+11, 02 SAY "TAB" STYLE "BT"
 @ pfIl+12, 02 SAY "FLECHA ARRIBA" STYLE "BT"
 @ pfIl+06, 22 SAY "Regresar a la pantalla anterior"
 @ pfIl+07, 22 SAY "Cerrar y regresar a Windows"
 @ pfIl+08, 22 SAY "Ayuda del Programa"
 @ pfIl+09, 22 SAY "Ir al siguiente campo, al final ingresa a la Consulta"
 @ pfIl+11, 22 SAY "Ir a la Consulta"
 @ pfIl+12, 22 SAY "Campo anterior"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE viTe, viT1, voPc, coPc, coP1, voPv, coPv, voPk, coPk, vsW0, vsW1,  ;
         vsW2, vsW3
 RELEASE vpAg, vlIn, vfB1, vcB1, vxLs, dfEm, hfEm, cdFe, chFe, vfI1, vfI2,  ;
         vfI3, vfI4
 RELEASE vfI5, vfI6, vfI7, vcO1, vnUf, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs,  ;
         ifFs, ufFs
 RELEASE ffFs, vtDo, itDo, utDo, vsEr, isEr, usEr, vdOc, idOc, udOc, vtPo,  ;
         itPo, utPo
 RELEASE vtPp, itPp, utPp, daNo, vaNo, iaNo, uaNo, dmEs, vmEs, imEs, umEs,  ;
         ddIa, vdIa
 RELEASE idIa, udIa, vcLi, vmOn, vtOt, vfEm, vtCa, vnUv, vcAn, vcOd, icOd,  ;
         ucOd, xcOd
 RELEASE vnOm, inOm, unOm, xnOm, vgRu, vnGr, vtPr, vnTp, vsTo, vmIn, vmAx,  ;
         vvCs, vpIe
 RELEASE vcEr, vpRe, vtP1
 RELEASE tvEn1, tvFe1, tvMa1, tvAb1, tvMy1, tvJu1, tvJl1, tvAg1, tvSe1,  ;
         tvOc1, tvNo1, tvDi1
 RELEASE tvEn2, tvFe2, tvMa2, tvAb2, tvMy2, tvJu2, tvJl2, tvAg2, tvSe2,  ;
         tvOc2, tvNo2, tvDi2
 RELEASE tvEnc, tvFec, tvMac, tvAbc, tvMyc, tvJuc, tvJlc, tvAgc, tvSec,  ;
         tvOcc, tvNoc, tvDic
 RELEASE tvEnk, tvFek, tvMak, tvAbk, tvMyk, tvJuk, tvJlk, tvAgk, tvSek,  ;
         tvOck, tvNok, tvDik
 RELEASE tvEnd, tvFed, tvMad, tvAbd, tvMyd, tvJud, tvJld, tvAgd, tvSed,  ;
         tvOcd, tvNod, tvDid
 RELEASE tvEnu, tvFeu, tvMau, tvAbu, tvMyu, tvJuu, tvJlu, tvAgu, tvSeu,  ;
         tvOcu, tvNou, tvDiu
 RELEASE tvEnw, tvFew, tvMaw, tvAbw, tvMyw, tvJuw, tvJlw, tvAgw, tvSew,  ;
         tvOcw, tvNow, tvDiw
 RELEASE tvEnf, tvFef, tvMaf, tvAbf, tvMyf, tvJuf, tvJlf, tvAgf, tvSef,  ;
         tvOcf, tvNof, tvDif
 RELEASE tcEn1, tcFe1, tcMa1, tcAb1, tcMy1, tcJu1, tcJl1, tcAg1, tcSe1,  ;
         tcOc1, tcNo1, tcDi1
 RELEASE tcEn2, tcFe2, tcMa2, tcAb2, tcMy2, tcJu2, tcJl2, tcAg2, tcSe2,  ;
         tcOc2, tcNo2, tcDi2
 RELEASE tcEnc, tcFec, tcMac, tcAbc, tcMyc, tcJuc, tcJlc, tcAgc, tcSec,  ;
         tcOcc, tcNoc, tcDic
 RELEASE vpAn_11, vpAn_12, vpAn_99
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 RELEASE ntM1, ntM2
ENDPROC
*
