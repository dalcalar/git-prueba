 SET CENTURY ON
 PUBLIC ntM1, ntM2, ntM3, ntM4, ntM5, afIl, x
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE "0002" TO ntM3
 STORE "0003" TO ntM4
 STORE "0004" TO ntM5
 STORE 01 TO meRr
 DIMENSION afIl[70, 4]
 STORE 1 TO x
 afIl[x, 1] = "F9702PER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702REG"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702ASI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP3"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702FEM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP4"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702FVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP5"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP6"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702SCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP7"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP8"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NCU"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP9"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TDI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP10"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP11"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 100
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP12"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702BAE"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP13"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702BAS"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP14"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702DCT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP15"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702IGV"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP16"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702DCI"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP17"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702EXO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP18"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702INA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP19"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702ISC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP20"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702BA2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP21"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702IVA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP22"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702OTR"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP23"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP24"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702MON"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP25"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 5
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "SEP26"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702FE2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP27"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TC2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP28"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702SR2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP29"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702DO2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP30"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702CTO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 12
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP31"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702ERR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP32"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP33"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702EST"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP34"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702CM1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 56
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP35"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON f9702tcp+ALLTRIM(f9702scp)+"*"+ALLTRIM(f9702ncp)+"*" TAG f9702doc
 INDEX ON f9702per+ALLTRIM(f9702reg)+"*"+ALLTRIM(f9702asi)+"*"+f9702tcp+ ;
       ALLTRIM(f9702scp)+"*"+ALLTRIM(f9702ncp)+"*" TAG f9702per
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[6, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM2RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 80
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NET"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2IGV"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 16
 afIl[x, 4] = 2
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(ftM2ruc)+"*" TAG ftM2ruc
 INDEX ON UPPER(ftM2nom)+ALLTRIM(ftM2ruc)+"*" TAG ftM2nom
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[27, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM3TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3FEM"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 80
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3PPE"
 afIl[x, 2] = "N"
 afIl[x, 3] = 5
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3PER"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3MON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3NET"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3IGV"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3DTR"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 5
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "FTM3PIG"
 afIl[x, 2] = "N"
 afIl[x, 3] = 5
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TDF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3SRF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3DOF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3FEF"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3REF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3EST"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3TDD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3SRD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3DOD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3ALM"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3CAM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM3COS"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE "TM01"+ntM3+meXt TO mdBf
 DO WHILE .T.
      ntM3 = STRTRAN(STR(VAL(ntM3)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM3+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM3="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM3tdo+ALLTRIM(ftM3ser)+"*"+ALLTRIM(ftM3doc)+"*" TAG ftM3doc
 INDEX ON ftM3tdd+ALLTRIM(ftM3srd)+"*"+ALLTRIM(ftM3dod)+"*" TAG ftM3dod
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[06, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM4TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4DEB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 12
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4HAB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 12
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM4TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE "TM01"+ntM4+meXt TO mdBf
 DO WHILE .T.
      ntM4 = STRTRAN(STR(VAL(ntM4)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM4+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM4="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           DO deL_file2 WITH "2", "S"
           DO deL_file2 WITH "3", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM4tdo+ftM4ser+ftM4doc+ALLTRIM(ftM4deb)+"*"+ALLTRIM(ftM4hab)+ ;
       "*" TAG ftM4doc
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[52, 4]
 STORE 1 TO x
 afIl[x, 1] = "MOTIVO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "TIPOPE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702FEM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP3"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP4"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702SCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP5"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP6"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NCU"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP7"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TDI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP8"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP9"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP10"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702MON"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP11"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702BAS"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP12"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702EXO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP13"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702INA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP14"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702EXP"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP15"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702ISC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP16"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702IGV"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP17"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702OTR"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP18"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP19"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702TC2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP20"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702SR2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP21"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702DO2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP22"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702PER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP23"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702PBA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP24"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702PTO"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP25"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9702PTT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP26"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM5+meXt TO mdBf
 DO WHILE .T.
      ntM5 = STRTRAN(STR(VAL(ntM5)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM5+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM5="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON f9702tcp+ALLTRIM(f9702scp)+"*"+ALLTRIM(f9702ncp)+"*" TAG f9702doc
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 STORE 99 TO mkEy
 SELECT 1
 @ 1, 1 SAY "Abriendo Archivo 1/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 GOTO TOP
 IF BOF() .OR. EOF()
      STORE "Archivo de Documentos de Ventas no puede estar vacío" TO mmSj
      STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
            "PRESIONAR UNA TECLA PARA REGRESAR AL MENÚ..." TO mmSj
      WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
      WAIT CLEAR
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 @ 1, 1 SAY "Abriendo Archivo 2/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1301", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1301DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 @ 1, 1 SAY "Abriendo Archivo 3/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "1101", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Clientes
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1101COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 @ 1, 1 SAY "Abriendo Archivo 4/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 @ 1, 1 SAY "Abriendo Archivo 4/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "2400", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Cpras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2400DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 @ 1, 1 SAY "Abriendo Archivo 4/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "2401", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Cpras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2401COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 @ 1, 1 SAY "Abriendo Archivo 5/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "3610", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared Alias Cab_Notas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3610FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 @ 1, 1 SAY "Abriendo Archivo 6/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9000", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared Alias Datos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 @ 1, 1 SAY "Abriendo Archivo 7/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9111", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cambio
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9111FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 @ 1, 1 SAY "Abriendo Archivo 8/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9114", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Departamentos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9114DPT
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 11
 @ 1, 1 SAY "Abriendo Archivo 9/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9115", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Distritos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9115DIS
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 12
 @ 1, 1 SAY "Abriendo Archivo 10/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9211", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tip_Prod
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9211TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 13
 @ 1, 1 SAY "Abriendo Archivo 11/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9311", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tipo_Doc
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9311TDO
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 14
 @ 1, 1 SAY "Abriendo Archivo 12/16..." STYLE "BQ"
 DO abR_0000a IN PUX0000A WITH "9991", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tiendas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9991COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 15
 @ 1, 1 SAY "Abriendo Archivo 13/16..." STYLE "BQ"
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9702DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 16
 @ 1, 1 SAY "Abriendo Archivo 14/16..." STYLE "BQ"
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_2
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM2RUC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 17
 @ 1, 1 SAY "Abriendo Archivo 15/16..." STYLE "BQ"
 STORE "TM01"+ntM3+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_3
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM3DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 18
 @ 1, 1 SAY "Abriendo Archivo 16/16..." STYLE "BQ"
 STORE "TM01"+ntM4+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_4
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM4DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 19
 @ 1, 1 SAY "Abriendo Archivo 17/17..." STYLE "BQ"
 STORE "TM01"+ntM5+meXt TO mdBf
 Use &mDBF Exclusive Alias Tmp_Rsm_Conting
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 INDEX ON f9702tcp+ALLTRIM(f9702scp)+"*"+ALLTRIM(f9702ncp)+"*" TAG f9702doc
 STORE 20 TO muLt
 STORE 00 TO meRr
 PUBLIC viTe, viT1, ciTx, vxLs, vpAg, vhOr, vpLe, vsW0, vsW1, vfI1, vfI2,  ;
        vfI3, vfI4
 PUBLIC vcO1, vcL1, vcL2, vnUf, ifIl, ufIl, vfIl, ffIl, cfIl, ifFs, ufFs,  ;
        vfFs, ffFs
 PUBLIC cfFs, dfEm, hfEm, cdFe, chFe, dsEr, hsEr, cdSe, chSe, vdAo, cdAo,  ;
        voPc, coPc
 PUBLIC xoPc, ddIa, dmEs, daNo, vtDo, itDo, utDo, ctDo, xtDo, vsEr, isEr,  ;
        usEr, csEr
 PUBLIC xsEr, vdOc, idOc, udOc, cdOc, xdOc, vdEb, vdE2, vdE3, vdE4, vhAb,  ;
        vhA2, vhA3
 PUBLIC vhA4, vcOd, vaLt, vpT2, vpT3, vpT4, vpT5, vnO1, vnO2, vnO3, vnO4,  ;
        vnO5, vaL2
 PUBLIC vaL3, vaL4, vaL5, vaB1, vaB2, vaB3, vaB4, vaB5, tnFa, tnBo, tbAe,  ;
        tbAs, teXo
 PUBLIC tiNa, tiSc, tiGv, tbA2, tiVa, toTr, ttOt, tnCr, tnDe, tpEr, tdTr,  ;
        vaA1, vaA2
 PUBLIC vaA3, vaA4, vaA5, tcOs
 PUBLIC vpAn_11, vpAn_99
 STORE CTOD("01"+SUBSTR(DTOC(DATE()), 3, 8)) TO dfEm
 STORE CTOD("  /  /    ") TO cdFe, chFe
 STORE DATE() TO hfEm
 STORE mdAo TO vdAo
 STORE "001" TO dsEr
 STORE "ZZZ" TO hsEr
 STORE 99 TO mkEy, coPc, cdAo
 STORE 01 TO voPc, viTe, vaLt, vsW0, vsW1, vaA1
 STORE 00 TO xoPc, tnFa, tnBo, tbAe, tbAs, teXo, tiNa, tiSc, tiGv
 STORE 00 TO tdTr, tbA2, tiVa, toTr, ttOt, tnCr, tnDe, tpEr, vaB1
 STORE 00 TO vaB2, vaB3, vaB4, vaB5, vaL2, vaL3, vaL4, vaL5, vaA2
 STORE 00 TO vaA3, vaA4, vaA5
 STORE SPACE(30) TO vnO1, vnO2, vnO3, vnO4, vnO5, vpT2, vpT3, vpT4, vpT5
 STORE SPACE(30) TO cdSe, chSe
 SELECT daTos
 GOTO TOP
 STORE f9000vd1 TO vdEb
 STORE f9000vd2 TO vdE2
 STORE f9000vh1 TO vhAb
 STORE f9000vh2 TO vhA2
 STORE f9000vd1 TO vdE3
 STORE f9000vd2 TO vdE4
 STORE f9000vh1 TO vhA3
 STORE f9000vh2 TO vhA4
 SELECT tiEndas
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE f9991cod TO vcOd
      DO CASE
           CASE vcOd="01"
                STORE f9991nom TO vnO1
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO1)+"..." STYLE "BQ"
                SKIP
                LOOP
           CASE vcOd="02"
                SKIP
                LOOP
           CASE vcOd="03"
                STORE f9991nom TO vnO2
                STORE f9991pth TO vpT2
           CASE vcOd="04"
                STORE f9991nom TO vnO3
                STORE f9991pth TO vpT3
           CASE vcOd="05"
                STORE f9991nom TO vnO4
                STORE f9991pth TO vpT4
           CASE vcOd="06"
                STORE f9991nom TO vnO5
                STORE f9991pth TO vpT5
           OTHERWISE
                EXIT
      ENDCASE
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     SAVE SCREEN TO vpAn_11
                     DO prEsiona WITH "1", "CUAROJ", mfI0+2, mcO0+10
                     IF mkEy=k_Esc
                          RETURN
                     ENDIF
                     @ mfI0+08, mcO0+19 SAY ALLTRIM(vnO2) FONT "Arial",  ;
                       16 STYLE "BT"
                     @ mfI0+10, mcO0+19 SAY "NO HAY ACCESO..." FONT  ;
                       "Arial", 16 STYLE "BT"
                     mkEy = INKEY(5)
                     RESTORE SCREEN FROM vpAn_11
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact2
                STORE 1 TO vaL2, vaA2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     SAVE SCREEN TO vpAn_11
                     DO prEsiona WITH "1", "CUAROJ", mfI0+2, mcO0+10
                     IF mkEy=k_Esc
                          RETURN
                     ENDIF
                     @ mfI0+08, mcO0+19 SAY ALLTRIM(vnO3) FONT "Arial",  ;
                       16 STYLE "BT"
                     @ mfI0+10, mcO0+19 SAY "NO HAY ACCESO..." FONT  ;
                       "Arial", 16 STYLE "BT"
                     mkEy = INKEY(5)
                     RESTORE SCREEN FROM vpAn_11
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact3
                STORE 1 TO vaL3, vaA3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     SAVE SCREEN TO vpAn_11
                     DO prEsiona WITH "1", "CUAROJ", mfI0+2, mcO0+10
                     IF mkEy=k_Esc
                          RETURN
                     ENDIF
                     @ mfI0+08, mcO0+19 SAY ALLTRIM(vnO4) FONT "Arial",  ;
                       16 STYLE "BT"
                     @ mfI0+10, mcO0+19 SAY "NO HAY ACCESO..." FONT  ;
                       "Arial", 16 STYLE "BT"
                     mkEy = INKEY(5)
                     RESTORE SCREEN FROM vpAn_11
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact4
                STORE 1 TO vaL4, vaA4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FV011300.DBF" TO mdBf
                STORE vaLt+1 TO vaLt
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     SAVE SCREEN TO vpAn_11
                     DO prEsiona WITH "1", "CUAROJ", mfI0+2, mcO0+10
                     IF mkEy=k_Esc
                          RETURN
                     ENDIF
                     @ mfI0+08, mcO0+19 SAY ALLTRIM(vnO6) FONT "Arial",  ;
                       16 STYLE "BT"
                     @ mfI0+10, mcO0+19 SAY "NO HAY ACCESO..." FONT  ;
                       "Arial", 16 STYLE "BT"
                     mkEy = INKEY(5)
                     RESTORE SCREEN FROM vpAn_11
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Fact5
                STORE 1 TO vaL5, vaA5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1300FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2, vaA2
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3, vaA3
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4, vaA4
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: DET "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5, vaA5
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Det_Fact5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1301DOC
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2, vaA2
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3, vaA3
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4, vaA4
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: NOT "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5, vaA5
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Nota5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3610FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      SELECT tiEndas
      SKIP
 ENDDO
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 WAIT CLEAR
 SET READBORDER ON
 DO p00_1320a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO p00_1320a WITH "1"
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_1320a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hlP_1320a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO p00_1320a WITH "1"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Alt_s
                DO q1_0000a
                SAVE SCREEN TO vpAn_11
                DO coLbln
                @ vfI1+06, vcO1+08 CLEAR TO vfI1+23, vcO1+99
                @ vfI1+06, vcO1+08 TO vfI1+23, vcO1+99
                @vFI1+07,vCO1+12 Say "Productos"   Font "&mLetRom",15 Style "BQ"
                @vFI1+08,vCO1+12 Say "Debe "+mSIG  Font "&mLetRom",14 Style "BQ"
                @vFI1+10,vCO1+12 Say "Debe US$"    Font "&mLetRom",14 Style "BQ"
                @vFI1+12,vCO1+12 Say "Haber "+mSIG Font "&mLetRom",14 Style "BQ"
                @vFI1+14,vCO1+12 Say "Haber US$"   Font "&mLetRom",14 Style "BQ"
                @vFI1+07,vCO1+44 Say "Servicios"   Font "&mLetRom",15 Style "BQ"
                @vFI1+08,vCO1+44 Say "Debe "+mSIG  Font "&mLetRom",14 Style "BQ"
                @vFI1+10,vCO1+44 Say "Debe US$"    Font "&mLetRom",14 Style "BQ"
                @vFI1+12,vCO1+44 Say "Haber "+mSIG Font "&mLetRom",14 Style "BQ"
                @vFI1+14,vCO1+44 Say "Haber US$"   Font "&mLetRom",14 Style "BQ"
                ON KEY LABEL ESC DO P_ESC
                ON KEY LABEL TAB DO P_TAB
                DO WHILE .T.
                     @vFI1+08,vCO1+33 Get vDEB Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+10,vCO1+33 Get vDE2 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+12,vCO1+33 Get vHAB Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+14,vCO1+33 Get vHA2 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+08,vCO1+33 Get vDE3 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+10,vCO1+33 Get vDE4 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+12,vCO1+33 Get vHA3 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+14,vCO1+33 Get vHA4 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     SET CONFIRM ON
                     SET CURSOR ON
                     READ
                     SET CURSOR OFF
                     SET CONFIRM OFF
                     SELECT daTos
                     IF mkEy=k_Esc .OR. mkEy=k_Tab
                          EXIT
                     ENDIF
                ENDDO
                DO p1_0000a
                STORE 99 TO mkEy
                RESTORE SCREEN FROM vpAn_11
           CASE mkEy=k_Ctrl_home .AND. viTe=1
                STORE "Estás en el primer campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=4 .AND. voPc<>2
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=5
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_left
                STORE "No hay campos a la izquierda..." TO mmSj
           CASE mkEy=k_Up .AND. viTe=1
                STORE "No hay más campos arriba..." TO mmSj
           CASE mkEy=k_Esc .OR. mkEy=k_Ctrl_home
                STORE 99 TO mkEy
                STORE 01 TO viTe
           CASE mkEy=k_Up
                STORE viTe-1 TO viTe
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Ctrl_right
                DO veR_1320a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     STORE 1 TO vsW0
                     DO CASE
                          CASE (viTe=5 .AND. voPc=2) .OR. (viTe=4 .AND.  ;
                               voPc<>2)
                               SAVE SCREEN TO vpAn_11
                               DO CASE
                                    CASE voPc=1
                                         DO pvR1320b
                                    CASE voPc=2
                                         DO pvR1320c
                                    CASE voPc=3
                                         DO pvR1320e
                                    CASE voPc=4
                                         DO pvR1320f
                               ENDCASE
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               STORE dfEm TO cdFe
                               STORE hfEm TO chFe
                               STORE dsEr TO cdSe
                               STORE hsEr TO chSe
                               STORE vdAo TO cdAo
                               STORE voPc TO coPc
                               STORE 1 TO viTe
                               RESTORE SCREEN FROM vpAn_11
                          OTHERWISE
                               STORE viTe+1 TO viTe
                     ENDCASE
                ENDIF
           CASE mkEy=k_Ctrl_end
                IF voPc<>2
                     STORE 4 TO ciTx
                ELSE
                     STORE 5 TO ciTx
                ENDIF
                DO veR_1320a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     STORE viTe+1 TO viTe
                     DO WHILE viTe<ciTx .AND. mkEy<>99
                          DO veR_1320a
                          IF mkEy=k_Esc
                               EXIT
                          ENDIF
                          IF mkEy<>99
                               STORE viTe+1 TO viTe
                          ENDIF
                     ENDDO
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                ENDIF
           CASE mkEy=k_Tab
                IF voPc<>2
                     STORE 4 TO ciTx
                ELSE
                     STORE 5 TO ciTx
                ENDIF
                DO WHILE viTe<=ciTx .AND. mkEy<>99
                     DO veR_1320a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     IF mkEy<>99
                          STORE viTe+1 TO viTe
                     ENDIF
                ENDDO
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     STORE 1 TO vsW0
                     SAVE SCREEN TO vpAn_11
                     DO CASE
                          CASE voPc=1
                               DO pvR1320b
                          CASE voPc=2
                               DO pvR1320c
                          CASE voPc=3
                               DO pvR1320e
                          CASE voPc=4
                               DO pvR1320f
                     ENDCASE
                     RESTORE SCREEN FROM vpAn_11
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     STORE dfEm TO cdFe
                     STORE hfEm TO chFe
                     STORE dsEr TO cdSe
                     STORE hsEr TO chSe
                     STORE vdAo TO cdAo
                     STORE voPc TO coPc
                     STORE 1 TO viTe
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      STORE k_Enter TO mkEy
      DO coLbln
      DO CASE
           CASE viTe=1
                @vFI1+02.5,vCO1+85.0 Get dFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=2
                @vFI1+04.5,vCO1+85.0 Get hFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=3
                @vFI1+06.5,vCO1+94.6 Get dSER Font "&mLetRom",12 Style "NQ" Size 1,04 Color ,&mColBlN Pict "999"
           CASE viTe=4
                @vFI1+08.5,vCO1+94.6 Get hSER Font "&mLetRom",12 Style "NQ" Size 1,04 Color ,&mColBlN Pict "!!!"
           CASE viTe=5 .AND. voPc=2
                @vFI1+10.5,vCO1+87.3 Get vDAO Font "&mLetRom",12 Style "NQ" Size 1,10 Color ,&mColBlN Pict "999999"
      ENDCASE
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE P00_1320a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 STORE 14 TO muFi
 STORE 110 TO muCo
 STORE (mwFi-muFi)/2 TO vfI1
 STORE (mwCo-muCo)/2 TO vcO1
 STORE 03 TO vnUf
 STORE vfI1-1 TO vfI1
 STORE vfI1+vnUf TO vfI2
 STORE vfI2+vnUf TO vfI3
 STORE vfI3+vnUf TO vfI4
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mcO0-0.2 TO mcO0
 STORE mfI0 TO ifIl, ufIl, vfIl, ifFs, ufFs, vfFs
 STORE ifIl+INT(muFi) TO ffIl, ffFs
 STORE mcO0+099.7 TO vcL1
 STORE mcO0+132.0 TO vcL2
 IF mrEs>"3"
      STORE mcO0+167.8 TO vcL1
      STORE mcO0+200.0 TO vcL2
 ENDIF
 DO tiT_0000a WITH "Reportes Especiales de SUNAT"
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 SAVE SCREEN TO vpAn_99
 DO coL_beige
 DO cuAdro WITH vfI1, vcO1+66, vfI1+13, vcO1+106
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLneb
 @vFI1-4.0,vCO1+08.0 Say "Tipo de Reportes"         Font "&mLetAri",18 Style "BT"
 DO coLbln
 @vFI1-3.9,vCO1+08.2 Say "Tipo de Reportes"         Font "&mLetAri",18 Style "BT"
 DO coLblz
 @vFI1+0.2,vCO1+15.0 Say "Registro de Ventas"       Font "&mLetAri",10 Style "BT"
 @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
 @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
 @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 DO opC_1320a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_beige
 @vFI1+00.5,vCO1+71.0 Say "Fechas:"     Font "&mLetRom",14 Style "NQ"
 DO coL_beiaz
 @vFI1+02.5,vCO1+71.0 Say "Desde"       Font "&mLetRom",14 Style "NQ"
 @vFI1+04.5,vCO1+71.0 Say "Hasta"       Font "&mLetRom",14 Style "NQ"
 DO coL_beive
 @vFI1+06.5,vCO1+71.0 Say "Desde Serie" Font "&mLetRom",14 Style "NQ"
 @vFI1+08.5,vCO1+71.0 Say "Hasta Serie" Font "&mLetRom",14 Style "NQ"
 @vFI1+02.5,vCO1+85.0 Get dFEM          Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 @vFI1+04.5,vCO1+85.0 Get hFEM          Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 @vFI1+06.5,vCO1+94.6 Get dSER          Font "&mLetRom",12 Style "NQ" Size 1,04 Color ,&mColBlN
 @vFI1+08.5,vCO1+94.6 Get hSER          Font "&mLetRom",12 Style "NQ" Size 1,04 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO p01_1320a
ENDPROC
*
PROCEDURE P01_1320a
 DO coL_beige
 IF voPc=2
      @vFI1+10.5,vCO1+71.0 Say "Mímimo:" Font "&mLetRom",14 Style "BQ"
      @vFI1+10.5,vCO1+87.3 Get vDAO      Font "&mLetRom",12 Style "NQ" Size 1,10 Color ,&mColBlN Pict "999,999"
      READ TIMEOUT 0.01
 ELSE
      @ vfI1+10.3, vcO1+70 CLEAR TO vfI1+12.1, vcO1+100
 ENDIF
ENDPROC
*
PROCEDURE Opc_1320a
 DO CASE
      CASE xoPc=1
           DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
      CASE xoPc=2
           DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
      CASE xoPc=3
           DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
      CASE xoPc=4
           DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLblz
 DO CASE
      CASE xoPc=1
           @vFI1+0.2,vCO1+15.0 Say "Registro de Ventas"       Font "&mLetAri",10 Style "BT"
      CASE xoPc=2
           @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
      CASE xoPc=3
           @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
      CASE xoPc=4
           @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 ENDCASE
 DO CASE
      CASE voPc=1
           DO prEsiona WITH "2", "ITEM0", vfI1, vcO1+2
      CASE voPc=2
           DO prEsiona WITH "2", "ITEM0", vfI2, vcO1+2
      CASE voPc=3
           DO prEsiona WITH "2", "ITEM0", vfI3, vcO1+2
      CASE voPc=4
           DO prEsiona WITH "2", "ITEM0", vfI4, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(253,242,47,0,0,0)
 DO CASE
      CASE voPc=1
           @vFI1+0.2,vCO1+15.0 Say "Registro de Ventas"       Font "&mLetAri",10 Style "BT"
      CASE voPc=2
           @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
      CASE voPc=3
           @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
      CASE voPc=4
           @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 ENDCASE
 IF xoPc=2 .OR. voPc=2
      DO p01_1320a
 ENDIF
 STORE voPc TO xoPc
ENDPROC
*
PROCEDURE Ver_1320a
 DO CASE
      CASE viTe=1 .AND. AT(" ", DTOC(dfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. AT(" ", DTOC(hfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. dfEm>hfEm
           STORE "Fecha inicial no puede ser mayor a final..." TO mmSj
      CASE viTe=3 .AND. AT(" ", dsEr)<>0
           STORE "Serie no puede tener espacios vacíos..." TO mmSj
      CASE viTe=4 .AND. AT(" ", hsEr)<>0
           STORE "Serie no puede tener espacios vacíos..." TO mmSj
      CASE viTe=4 .AND. dsEr>hsEr
           STORE "Serie inicial no puede ser mayor a final..." TO mmSj
      CASE viTe=4 .AND. mpPe=0 .AND. voPc=3
           STORE "No es Agente de Percepción. No hay Reporte..." TO mmSj
      CASE viTe=4 .AND. mpDt=0 .AND. voPc=4
           STORE "No tienes Productos/Servicios con Detracción. No hay Reporte..."  ;
                 TO mmSj
      CASE viTe=4 .AND. dfEm=cdFe .AND. dsEr=cdSe .AND. vdAo=cdAo .AND.  ;
           hfEm=chFe .AND. hsEr=chSe .AND. voPc=xoPc
      CASE (viTe=5 .AND. voPc=2) .OR. (viTe=4 .AND. (voPc=1 .OR. voPc=3  ;
           .OR. voPc=4))
           DO reV_1300a IN PVR1300A
           IF vaB1+vaB2+vaB3+vaB4+vaB5=0
                STORE "No hay datos en este rango de Fecha..." TO mmSj
           ELSE
                SET ESCAPE ON
                ON ESCAPE STORE 9000 TO MKEY
                SAVE SCREEN TO vpAn_11
                DO prO_1320a
                ON ESCAPE
                SET ESCAPE OFF
                RESTORE SCREEN FROM vpAn_11
                WAIT WINDOW NOWAIT "Hora Final de Lectura: "+TIME()
                = INKEY(0.05)
                WAIT CLEAR
                IF mkEy=9000
                     STORE "Proceso Interrumpido..." TO mmSj
                ELSE
                     SELECT teMporal
                     GOTO TOP
                     IF BOF()
                          STORE "No hay datos en este rango de Fecha..."  ;
                                TO mmSj
                     ENDIF
                ENDIF
           ENDIF
 ENDCASE
 IF LEN(ALLTRIM(mmSj))<>0
      DO poNmsj
      STORE 99 TO mkEy
 ENDIF
ENDPROC
*
PROCEDURE Pro_1320a
 SELECT teMporal
 ZAP
 REINDEX
 SELECT teMporal_2
 ZAP
 REINDEX
 SELECT teMporal_3
 ZAP
 REINDEX
 SELECT teMporal_4
 ZAP
 REINDEX
 STORE TIME() TO vhOr
 STORE 0 TO tnFa, tnBo, tbAe, tbAs, teXo, tiNa, tiSc, tiGv
 STORE 0 TO tbA2, tiVa, toTr, ttOt, tnCr, tnDe, tpEr, tdTr
 DO CASE
      CASE voPc=1
           WAIT WINDOW NOWAIT "L E Y E N D O  FA/BO "+vnO1+"..."+vhOr
           DO prF_1320a WITH 1
           IF vaL2=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  FA/BO "+vnO2+"..."+vhOr
                DO prF_1320a WITH 2
           ENDIF
           IF vaL3=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  FA/BO "+vnO3+"..."+vhOr
                DO prF_1320a WITH 3
           ENDIF
           IF vaL4=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  FA/BO "+vnO4+"..."+vhOr
                DO prF_1320a WITH 4
           ENDIF
           IF vaL5=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  FA/BO "+vnO5+"..."+vhOr
                DO prF_1320a WITH 5
           ENDIF
           STORE TIME() TO vhOr
           WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND "+vnO1+"..."+vhOr
           DO prN_1320a WITH 1
           IF vaL2=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND "+vnO2+"..."+vhOr
                DO prN_1320a WITH 2
           ENDIF
           IF vaL3=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND "+vnO3+"..."+vhOr
                DO prN_1320a WITH 3
           ENDIF
           IF vaL4=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND "+vnO4+"..."+vhOr
                DO prN_1320a WITH 4
           ENDIF
           IF vaL5=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  NC/ND "+vnO5+"..."+vhOr
                DO prN_1320a WITH 5
           ENDIF
           SELECT teMporal
           REPLACE seP1 WITH "|" ALL
           REPLACE seP2 WITH "|" ALL
           REPLACE seP3 WITH "|" ALL
           REPLACE seP4 WITH "|" ALL
           REPLACE seP5 WITH "|" ALL
           REPLACE seP6 WITH "|" ALL
           REPLACE seP7 WITH "|" ALL
           REPLACE seP8 WITH "|" ALL
           REPLACE seP9 WITH "|" ALL
           REPLACE seP10 WITH "|" ALL
           REPLACE seP11 WITH "|" ALL
           REPLACE seP12 WITH "|" ALL
           REPLACE seP13 WITH "|" ALL
           REPLACE seP14 WITH "|" ALL
           REPLACE seP15 WITH "|" ALL
           REPLACE seP16 WITH "|" ALL
           REPLACE seP17 WITH "|" ALL
           REPLACE seP18 WITH "|" ALL
           REPLACE seP19 WITH "|" ALL
           REPLACE seP20 WITH "|" ALL
           REPLACE seP21 WITH "|" ALL
           REPLACE seP22 WITH "|" ALL
           REPLACE seP23 WITH "|" ALL
           REPLACE seP24 WITH "|" ALL
           REPLACE seP25 WITH "|" ALL
           REPLACE seP26 WITH "|" ALL
           REPLACE seP27 WITH "|" ALL
           REPLACE seP28 WITH "|" ALL
           REPLACE seP29 WITH "|" ALL
           REPLACE seP30 WITH "|" ALL
           REPLACE seP31 WITH "|" ALL
           REPLACE seP32 WITH "|" ALL
           REPLACE seP33 WITH "|" ALL
           REPLACE seP34 WITH "|" ALL
           REPLACE seP35 WITH "|" ALL
           STORE TIME() TO vhOr
           WAIT WINDOW NOWAIT "G R A B A N D O  C U O..."+vhOr
           DO cuO_1320a
      CASE voPc=2
           WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO1+"..."+vhOr
           DO prD_1320a WITH 1
           IF vaL2=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO2+"..."+vhOr
                DO prD_1320a WITH 2
           ENDIF
           IF vaL3=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO3+"..."+vhOr
                DO prD_1320a WITH 3
           ENDIF
           IF vaL4=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO4+"..."+vhOr
                DO prD_1320a WITH 4
           ENDIF
           IF vaL5=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO5+"..."+vhOr
                DO prD_1320a WITH 5
           ENDIF
      CASE voPc=3
           WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO1+"..."+vhOr
           DO prP_1320a WITH 1
           IF vaL2=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO2+"..."+vhOr
                DO prP_1320a WITH 2
           ENDIF
           IF vaL3=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO3+"..."+vhOr
                DO prP_1320a WITH 3
           ENDIF
           IF vaL4=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO4+"..."+vhOr
                DO prP_1320a WITH 4
           ENDIF
           IF vaL5=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO5+"..."+vhOr
                DO prP_1320a WITH 5
           ENDIF
      CASE voPc=4
           WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO1+"..."+vhOr
           DO prT_1320a WITH 1
           IF vaL2=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO2+"..."+vhOr
                DO prT_1320a WITH 2
           ENDIF
           IF vaL3=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO3+"..."+vhOr
                DO prT_1320a WITH 3
           ENDIF
           IF vaL4=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO4+"..."+vhOr
                DO prT_1320a WITH 4
           ENDIF
           IF vaL5=1 .AND. mkEy<>99
                STORE TIME() TO vhOr
                WAIT WINDOW NOWAIT "L E Y E N D O  "+vnO5+"..."+vhOr
                DO prT_1320a WITH 5
           ENDIF
 ENDCASE
ENDPROC
*
PROCEDURE PrF_1320a
 PARAMETER prEg
 PUBLIC psRx, ptDo, psEr, pdOc, pfEm, pfVe, ptCa, ptD1, psR1, pdO1, pnOm, pcM1
 PUBLIC ptDi, prUc, pdNi, pmOn, ppIg, pbAs, pnEt, peXo, piGv, ptOt, peSt, peS1
 PUBLIC pdEb, phAb, pcOd, ptIp, ptPo, ptO2, pfEc, ptD2, psR2, pdO2, ppRe
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f1300tdo TO ptDo, ptD1
      STORE f1300ser TO psEr
      STORE f1300doc TO pdOc
      STORE f1300fem TO pfEm
      STORE f1300ele TO pdNi
      DO CASE
           CASE psEr<dsEr .OR. psEr>hsEr
                SKIP
                LOOP
           CASE ptDo="NP" .OR. ptDo="CT" .OR. ptDo="PC"
                SKIP
                LOOP
      ENDCASE
      DO faC_1320a WITH prEg, "1"
      IF mkEy=k_Esc
           STORE 99 TO mkEy
           RETURN
      ENDIF
      IF mkEy=99999
           STORE k_Enter TO mkEy
           DO CASE
                CASE prEg=1
                     SELECT caB_fact
                CASE prEg=2
                     SELECT caB_fact2
                CASE prEg=3
                     SELECT caB_fact3
                CASE prEg=4
                     SELECT caB_fact4
                CASE prEg=5
                     SELECT caB_fact5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC" .OR. ptDo="TF"  ;
                .OR. (ptDo="TK" .AND. LEN(ALLTRIM(f1300ruc))<>0)
                STORE tnFa+1 TO tnFa
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB"  ;
                .OR. (ptDo="TK" .AND. LEN(ALLTRIM(f1300ruc))=0)
                STORE tnBo+1 TO tnBo
      ENDCASE
      STORE tbAe+f9702bae TO tbAe
      STORE tbAs+f9702bas TO tbAs
      STORE teXo+f9702exo TO teXo
      STORE tiNa+f9702ina TO tiNa
      STORE tiSc+f9702isc TO tiSc
      STORE tiGv+f9702igv TO tiGv
      STORE tbA2+f9702ba2 TO tbA2
      STORE tiVa+f9702iva TO tiVa
      STORE toTr+f9702otr TO toTr
      STORE ttOt+f9702tot TO ttOt
      SELECT teMporal_3
      APPEND BLANK
      REPLACE ftM3tdo WITH ptD1
      REPLACE ftM3ser WITH psR1
      REPLACE ftM3doc WITH pdO1
      REPLACE ftM3tdd WITH ptDo
      REPLACE ftM3srd WITH psEr
      REPLACE ftM3dod WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3ref WITH "Venta"
      REPLACE ftM3mon WITH pmOn
      REPLACE ftM3pig WITH ppIg
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3net WITH pbAs
      REPLACE ftM3igv WITH piGv
      REPLACE ftM3tot WITH ptOt
      REPLACE ftM3dtr WITH 0
      REPLACE ftM3ppe WITH 0
      REPLACE ftM3per WITH 0
      REPLACE ftM3tdf WITH " "
      REPLACE ftM3srf WITH " "
      REPLACE ftM3dof WITH " "
      REPLACE ftM3fef WITH CTOD("  /  /    ")
      REPLACE ftM3est WITH peSt
      REPLACE ftM3alm WITH prEg
      REPLACE ftM3cam WITH " "
      REPLACE ftM3cos WITH tcOs
      DO CASE
           CASE prEg=1
                SELECT deT_fact
           CASE prEg=2
                SELECT deT_fact2
           CASE prEg=3
                SELECT deT_fact3
           CASE prEg=4
                SELECT deT_fact4
           CASE prEg=5
                SELECT deT_fact5
      ENDCASE
      GOTO TOP
      SEEK ptDo+psEr+pdOc
      DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=ptDo+psEr+pdOc
           STORE f1301cod TO pcOd
           STORE f1301to2 TO ptO2
           SELECT prOductos
           SEEK ALLTRIM(pcOd)+"*"
           IF EOF()
                DO CASE
                     CASE prEg=1
                          SELECT deT_fact
                     CASE prEg=2
                          SELECT deT_fact2
                     CASE prEg=3
                          SELECT deT_fact3
                     CASE prEg=4
                          SELECT deT_fact4
                     CASE prEg=5
                          SELECT deT_fact5
                ENDCASE
                SKIP
                LOOP
           ENDIF
           STORE f2111tip TO ptIp
           STORE f2111tpo TO ptPo
           SELECT tiP_prod
           SEEK ptIp
           IF EOF()
                DO CASE
                     CASE prEg=1
                          SELECT deT_fact
                     CASE prEg=2
                          SELECT deT_fact2
                     CASE prEg=3
                          SELECT deT_fact3
                     CASE prEg=4
                          SELECT deT_fact4
                     CASE prEg=5
                          SELECT deT_fact5
                ENDCASE
                SKIP
                LOOP
           ENDIF
           DO CASE
                CASE pmOn=1 .AND. LEN(ALLTRIM(f9211vd1))<>0
                     STORE f9211vd1 TO pdEb
                     STORE f9211vh1 TO phAb
                CASE pmOn=2 .AND. LEN(ALLTRIM(f9211vd2))<>0
                     STORE f9211vd2 TO pdEb
                     STORE f9211vh2 TO phAb
                CASE pmOn=1 .AND. ptPo=1
                     STORE vdEb TO pdEb
                     STORE vhAb TO phAb
                CASE pmOn=2 .AND. ptPo=1
                     STORE vdE2 TO pdEb
                     STORE vhA2 TO phAb
                CASE pmOn=1
                     STORE vdE3 TO pdEb
                     STORE vhA3 TO phAb
                CASE pmOn=2
                     STORE vdE4 TO pdEb
                     STORE vhA4 TO phAb
           ENDCASE
           SELECT teMporal_4
           SEEK ptD1+psR1+pdO1+ALLTRIM(pdEb)+"*"+ALLTRIM(phAb)+"*"
           IF EOF()
                APPEND BLANK
                REPLACE ftM4tdo WITH ptD1
                REPLACE ftM4ser WITH psR1
                REPLACE ftM4doc WITH pdO1
                REPLACE ftM4deb WITH pdEb
                REPLACE ftM4hab WITH phAb
                REPLACE ftM4tot WITH 0
           ENDIF
           REPLACE ftM4tot WITH ftM4tot+ptO2
           DO CASE
                CASE prEg=1
                     SELECT deT_fact
                CASE prEg=2
                     SELECT deT_fact2
                CASE prEg=3
                     SELECT deT_fact3
                CASE prEg=4
                     SELECT deT_fact4
                CASE prEg=5
                     SELECT deT_fact5
           ENDCASE
           SKIP
      ENDDO
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
 RELEASE psRx, ptDo, psEr, pdOc, pfEm, pfVe, ptCa, ptD1, psR1, pdO1, pnOm, pcM1
 RELEASE ptDi, prUc, pdNi, pmOn, ppIg, pbAs, pnEt, peXo, piGv, ptOt, peSt, peS1
 RELEASE pdEb, phAb, pcOd, ptIp, ptPo, ptO2, pfEc, ptD2, psR2, pdO2, ppRe
ENDPROC
*
PROCEDURE PrN_1320a
 PARAMETER prEg
 PUBLIC psRx, ptDo, psEr, pdOc, ptD1, psR1, pdO1, ptD2, psR2, pdO2, ptD3, psR3
 PUBLIC pdO3, pfEm, pfE1, pnOm, prUc, pdNi, ptDi, piGv, pmOn, pnEt, piGv, ptOt
 PUBLIC pbAs, peXo, pfRe, ptCa, peSt, peS1, ppIg
 DO CASE
      CASE prEg=1
           SELECT caB_notas
      CASE prEg=2
           SELECT caB_nota2
      CASE prEg=3
           SELECT caB_nota3
      CASE prEg=4
           SELECT caB_nota4
      CASE prEg=5
           SELECT caB_nota5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f3610fem>=dfEm .AND. f3610fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f3610ser TO psEr
      IF psEr<dsEr .OR. psEr>hsEr
           SKIP
           LOOP
      ENDIF
      DO crE_1320a WITH prEg, "1"
      IF mkEy=k_Esc
           STORE 99 TO mkEy
           RETURN
      ENDIF
      DO CASE
           CASE ptDo="NC" .OR. ptDo="N1" .OR. ptDo="N3"
                STORE tnCr+1 TO tnCr
           CASE ptDo="ND" .OR. ptDo="N2" .OR. ptDo="N4"
                STORE tnDe+1 TO tnDe
      ENDCASE
      STORE tbAe+f9702bae TO tbAe
      STORE tbAs+f9702bas TO tbAs
      STORE teXo+f9702exo TO teXo
      STORE tiNa+f9702ina TO tiNa
      STORE tiSc+f9702isc TO tiSc
      STORE tiGv+f9702igv TO tiGv
      STORE tbA2+f9702ba2 TO tbA2
      STORE tiVa+f9702iva TO tiVa
      STORE toTr+f9702otr TO toTr
      STORE ttOt+f9702tot TO ttOt
      SELECT teMporal_3
      APPEND BLANK
      REPLACE ftM3tdo WITH ptD3
      REPLACE ftM3ser WITH psR2
      REPLACE ftM3doc WITH pdO3
      REPLACE ftM3tdd WITH ptDo
      REPLACE ftM3srd WITH psEr
      REPLACE ftM3dod WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3ref WITH "Nota-Vta"
      REPLACE ftM3mon WITH pmOn
      REPLACE ftM3pig WITH ppIg
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3net WITH pbAs
      REPLACE ftM3igv WITH piGv
      REPLACE ftM3tot WITH ptOt
      REPLACE ftM3dtr WITH 0
      REPLACE ftM3ppe WITH 0
      REPLACE ftM3per WITH 0
      REPLACE ftM3tdf WITH " "
      REPLACE ftM3srf WITH " "
      REPLACE ftM3dof WITH " "
      REPLACE ftM3fef WITH CTOD("  /  /    ")
      REPLACE ftM3est WITH peSt
      REPLACE ftM3alm WITH prEg
      REPLACE ftM3cam WITH " "
      DO CASE
           CASE prEg=1
                SELECT caB_notas
           CASE prEg=2
                SELECT caB_nota2
           CASE prEg=3
                SELECT caB_nota3
           CASE prEg=4
                SELECT caB_nota4
           CASE prEg=5
                SELECT caB_nota5
      ENDCASE
      SKIP
 ENDDO
 RELEASE psRx, ptDo, psEr, pdOc, ptD1, psR1, pdO1, ptD2, psR2, pdO2, ptD3, psR3
 RELEASE pdO3, pfEm, pfE1, pnOm, prUc, pdNi, ptDi, piGv, pmOn, pnEt, piGv, ptOt
 RELEASE pbAs, peXo, pfRe, ptCa, peSt, peS1, ppIg
ENDPROC
*
PROCEDURE PrD_1320a
 PARAMETER prEg
 PUBLIC psRx, ptDo, psEr, pdOc, ptD1, psR1, pdO1, pfEm, pfVe, ptCa, pcM1, pnOm
 PUBLIC ptDi, prUc, pdNi, ppIg, pmOn, pnEt, piGv, ptOt, peXo, pbAs, peSt, peS1
 PUBLIC ptD2, psR2, pdO2, ptD3, psR3, pdO3, pfRe, pfE1
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f1300tdo TO ptDo
      STORE f1300ser TO psEr
      STORE f1300ele TO pdNi
      STORE f1300ruc TO prUc
      STORE f1300est TO peSt
      IF peSt$"89" .OR. ptDo="CT" .OR. ptDo="NP" .OR. ptDo="PC" .OR. psEr< ;
         dsEr .OR. psEr>hsEr
           SKIP
           LOOP
      ENDIF
      IF (SUBSTR(ptDo, 1, 1)="B" .AND. LEN(ALLTRIM(pdNi))=0) .OR.  ;
         (SUBSTR(ptDo, 1, 1)="F" .AND. LEN(ALLTRIM(prUc))=0)
           SKIP
           LOOP
      ENDIF
      DO faC_1320a WITH prEg, "2"
      IF mkEy=k_Esc
           STORE 99 TO mkEy
           RETURN
      ENDIF
      SELECT teMporal_2
      SEEK ALLTRIM(prUc)+"*"
      IF EOF()
           APPEND BLANK
           REPLACE ftM2ruc WITH prUc
           REPLACE ftM2nom WITH pnOm
           REPLACE ftM2net WITH 0
           REPLACE ftM2igv WITH 0
           REPLACE ftM2tot WITH 0
           REPLACE ftM2to2 WITH 0
      ENDIF
      REPLACE ftM2net WITH ftM2net+pnEt
      REPLACE ftM2igv WITH ftM2igv+piGv
      REPLACE ftM2tot WITH ftM2tot+ptOt
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC" .OR. ptDo="TF"
                REPLACE ftM2to2 WITH ftM2to2+pnEt
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB"
                REPLACE ftM2to2 WITH ftM2to2+ptOt
           CASE ptDo="TK"
                REPLACE ftM2to2 WITH ftM2to2+ptOt
      ENDCASE
      SELECT teMporal_3
      APPEND BLANK
      REPLACE ftM3tdo WITH ptD1
      REPLACE ftM3ser WITH psR1
      REPLACE ftM3doc WITH pdO1
      REPLACE ftM3tdd WITH ptDo
      REPLACE ftM3srd WITH psEr
      REPLACE ftM3dod WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3ref WITH "Venta"
      REPLACE ftM3mon WITH pmOn
      REPLACE ftM3pig WITH ppIg
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3net WITH pbAs
      REPLACE ftM3igv WITH piGv
      REPLACE ftM3tot WITH ptOt
      REPLACE ftM3dtr WITH 0
      REPLACE ftM3ppe WITH 0
      REPLACE ftM3per WITH 0
      REPLACE ftM3tdf WITH " "
      REPLACE ftM3srf WITH " "
      REPLACE ftM3dof WITH " "
      REPLACE ftM3fef WITH CTOD("  /  /    ")
      REPLACE ftM3est WITH peSt
      REPLACE ftM3alm WITH prEg
      REPLACE ftM3cam WITH " "
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
 DO CASE
      CASE prEg=1
           SELECT caB_notas
      CASE prEg=2
           SELECT caB_nota2
      CASE prEg=3
           SELECT caB_nota3
      CASE prEg=4
           SELECT caB_nota4
      CASE prEg=5
           SELECT caB_nota5
 ENDCASE
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f3610fem>=dfEm .AND. f3610fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f3610ser TO psEr
      STORE f3610est TO peSt
      STORE f3610ele TO pdNi
      STORE f3610ruc TO prUc
      IF peSt$"89" .OR. psEr<dsEr .OR. psEr>hsEr .OR. (LEN(ALLTRIM(pdNi))= ;
         0 .AND. LEN(ALLTRIM(prUc))=0)
           SKIP
           LOOP
      ENDIF
      DO crE_1320a WITH prEg, "2"
      IF mkEy=k_Esc
           STORE 99 TO mkEy
           RETURN
      ENDIF
      SELECT teMporal_2
      SEEK ALLTRIM(vrUc)+"*"
      IF EOF()
           APPEND BLANK
           REPLACE ftM2ruc WITH vrUc
           REPLACE ftM2nom WITH vnOm
           REPLACE ftM2net WITH 0
           REPLACE ftM2igv WITH 0
           REPLACE ftM2tot WITH 0
           REPLACE ftM2to2 WITH 0
      ENDIF
      REPLACE ftM2net WITH ftM2net+pnEt
      REPLACE ftM2igv WITH ftM2igv+piGv
      REPLACE ftM2tot WITH ftM2tot+ptOt
      REPLACE ftM2to2 WITH ftM2to2+pnEt
      SELECT teMporal_3
      APPEND BLANK
      REPLACE ftM3tdo WITH ptD3
      REPLACE ftM3ser WITH psR2
      REPLACE ftM3doc WITH pdO3
      REPLACE ftM3tdd WITH ptDo
      REPLACE ftM3srd WITH psEr
      REPLACE ftM3dod WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3ref WITH "Nota-Vta"
      REPLACE ftM3mon WITH pmOn
      REPLACE ftM3pig WITH ppIg
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3net WITH pbAs
      REPLACE ftM3igv WITH piGv
      REPLACE ftM3tot WITH ptOt
      REPLACE ftM3dtr WITH 0
      REPLACE ftM3ppe WITH 0
      REPLACE ftM3per WITH 0
      REPLACE ftM3tdf WITH " "
      REPLACE ftM3srf WITH " "
      REPLACE ftM3dof WITH " "
      REPLACE ftM3fef WITH CTOD("  /  /    ")
      REPLACE ftM3est WITH peSt
      REPLACE ftM3alm WITH prEg
      REPLACE ftM3cam WITH " "
      DO CASE
           CASE prEg=1
                SELECT caB_notas
           CASE prEg=2
                SELECT caB_nota2
           CASE prEg=3
                SELECT caB_nota3
           CASE prEg=4
                SELECT caB_nota4
           CASE prEg=5
                SELECT caB_nota5
      ENDCASE
      SKIP
 ENDDO
 FLUSH
 RELEASE psRx, ptDo, psEr, pdOc, ptD1, psR1, pdO1, pfEm, pfVe, ptCa, pcM1, pnOm
 RELEASE ptDi, prUc, pdNi, ppIg, pmOn, pnEt, piGv, ptOt, peXo, pbAs, peSt, peS1
 RELEASE ptD2, psR2, pdO2, ptD3, psR3, pdO3, pfRe, pfE1
ENDPROC
*
PROCEDURE PrP_1320a
 PARAMETER prEg
 PRIVATE ptDo, psEr, pdOc, peSt, pfEm, ptCa, pnOm, prUc, pdNi, pmOn, ppIg, pnEt
 PRIVATE ptOt, pcM1, plEn, ptD1, ptPp
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f1300tdo TO ptDo
      STORE f1300ser TO psEr
      STORE f1300est TO peSt
      IF ptDo<>"PC" .OR. psEr<dsEr .OR. psEr>hsEr .OR. peSt$"89" .OR.  ;
         (SUBSTR(psEr, 1, 1)="T" .AND. (voPc=3 .OR. voPc=4))
           SKIP
           LOOP
      ENDIF
      STORE f1300doc TO pdOc
      STORE f1300fem TO pfEm
      STORE f1300nom TO pnOm
      STORE f1300ruc TO prUc
      STORE f1300ele TO pdNi
      STORE f1300mon TO pmOn
      STORE f1300pig TO ppIg
      STORE f1300net TO pnEt
      STORE f1300tot TO ptOt
      STORE f1300cm1 TO pcM1
      DO WHILE .T.
           IF AT("/", pnOm)=0
                EXIT
           ENDIF
           STORE AT("/", pnOm) TO plEn
           STORE ALLTRIM(SUBSTR(pnOm, 1, plEn-1))+" "+ALLTRIM(SUBSTR(pnOm,  ;
                 plEn+1, 100)) TO pnOm
      ENDDO
      DO WHILE .T.
           IF AT("`", pnOm)=0
                EXIT
           ENDIF
           STORE AT("`", pnOm) TO plEn
           STORE ALLTRIM(SUBSTR(pnOm, 1, plEn-1))+" "+ALLTRIM(SUBSTR(pnOm,  ;
                 plEn+1, 100)) TO pnOm
      ENDDO
      DO WHILE .T.
           IF AT('"', pnOm)=0
                EXIT
           ENDIF
           STORE AT('"', pnOm) TO plEn
           STORE ALLTRIM(SUBSTR(pnOm, 1, plEn-1))+" "+ALLTRIM(SUBSTR(pnOm,  ;
                 plEn+1, 100)) TO pnOm
      ENDDO
      DO CASE
           CASE SUBSTR(psEr, 1, 1)="9"
                STORE "I" TO ptPp
           CASE SUBSTR(psEr, 1, 1)="T"
                STORE "T" TO ptPp
           OTHERWISE
                STORE "E" TO ptPp
      ENDCASE
      IF peSt$"89"
           STORE 0 TO pnEt, ptOt
           STORE "ANULADO" TO pnOm
      ENDIF
      IF ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB" .OR.  ;
         (ptDo="TK" .AND. LEN(ALLTRIM(prUc))=0)
           STORE pdNi TO prUc
      ENDIF
      SELECT caMbio
      SEEK pfEm
      IF EOF()
           STORE "Tipo de Cambio del "+DTOC(pfEm)+" no registrado..." TO mmSj
           STORE 99 TO mkEy
           DO poNmsj
           mkEy = INKEY(0)
           EXIT
      ENDIF
      STORE f9111tc1 TO ptCa
      IF pmOn=2
           STORE ptOt*ptCa TO ptOt
           STORE pnEt*ptCa TO pnEt
      ENDIF
      SELECT tiPo_doc
      SEEK SUBSTR(pcM1, 1, 2)
      IF  .NOT. EOF()
           STORE f9311td1 TO ptD1
      ELSE
           STORE "00" TO ptD1
      ENDIF
      SELECT teMporal_3
      SEEK ptDo+ALLTRIM(psEr)+"*"+ALLTRIM(pdOc)+"*"
      IF  .NOT. EOF()
           WAIT WINDOW NOCLEAR NOWAIT
           STORE "Documento duplicado:"+ptDo+"-"+psEr+"-"+pdOc+ ;
                 "... Presionar una Tecla..." TO mmSj
           DO poNmsj
           = INKEY(0)
           STORE k_Enter TO mkEy
           DO CASE
                CASE prEg=1
                     SELECT caB_fact
                CASE prEg=2
                     SELECT caB_fact2
                CASE prEg=3
                     SELECT caB_fact3
                CASE prEg=4
                     SELECT caB_fact4
                CASE prEg=5
                     SELECT caB_fact5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      APPEND BLANK
      REPLACE ftM3tdo WITH ptDo
      REPLACE ftM3ser WITH psEr
      REPLACE ftM3doc WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3tot WITH pnEt
      REPLACE ftM3ppe WITH ppIg
      REPLACE ftM3per WITH ptOt
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3tdf WITH ptD1
      REPLACE ftM3srf WITH SUBSTR(pcM1, 4, 3)
      REPLACE ftM3dof WITH SUBSTR(pcM1, 8, 7)
      REPLACE ftM3fef WITH pfEm
      REPLACE ftM3est WITH peSt
      REPLACE ftM3dtr WITH 0
      STORE ttOt+pnEt TO ttOt
      STORE tpEr+ptOt TO tpEr
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
 RELEASE ptDo, psEr, pdOc, peSt, pfEm, ptCa, pnOm, prUc, pdNi, pmOn, ppIg, pnEt
 RELEASE ptOt, pcM1, plEn, ptD1, ptPp
ENDPROC
*
PROCEDURE PrT_1320a
 PARAMETER prEg
 PRIVATE ptDo, psEr, pdOc, pfEm, pfVe, pmOn, ppIg, pnEt, piGv, ptOt, ptCa, peSt
 PRIVATE pnOm, prUc, pcOd, ptO2, ptIp, pdTr, ppDt, pdEt
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 GOTO TOP
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f1300fem>=dfEm .AND. f1300fem<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      STORE f1300tdo TO ptDo
      STORE f1300ser TO psEr
      STORE f1300est TO peSt
      IF (ptDo="NP" .OR. ptDo="CT" .OR. ptDo="PC") .OR. psEr<dsEr .OR.  ;
         psEr>hsEr .OR. peSt$"89"
           SKIP
           LOOP
      ENDIF
      STORE f1300doc TO pdOc
      STORE f1300mon TO pmOn
      STORE f1300pig TO ppIg
      STORE f1300net TO pnEt
      STORE f1300igv TO piGv
      STORE f1300tot TO ptOt
      STORE f1300fem TO pfEm
      STORE f1300fem+f1300dia TO pfVe
      STORE f1300nom TO pnOm
      STORE f1300ruc TO prUc
      STORE 0 TO pdEt
      SELECT caMbio
      SEEK pfEm
      IF EOF()
           STORE "Tipo de Cambio del "+DTOC(pfEm)+" no registrado..." TO mmSj
           STORE 99 TO mkEy
           DO poNmsj
           = INKEY(2)
           EXIT
      ENDIF
      STORE f9111tc1 TO ptCa
      IF pmOn=2
           STORE ptOt*ptCa TO ptOt
           STORE ROUND(ptOt/(1+(ppIg/100)), 2) TO pnEt
           STORE ptOt-pnEt TO piGv
      ENDIF
      IF ptOt<mmDt
           DO CASE
                CASE prEg=1
                     SELECT caB_fact
                CASE prEg=2
                     SELECT caB_fact2
                CASE prEg=3
                     SELECT caB_fact3
                CASE prEg=4
                     SELECT caB_fact4
                CASE prEg=5
                     SELECT caB_fact5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      DO CASE
           CASE prEg=1
                SELECT deT_fact
           CASE prEg=2
                SELECT deT_fact2
           CASE prEg=3
                SELECT deT_fact3
           CASE prEg=4
                SELECT deT_fact4
           CASE prEg=5
                SELECT deT_fact5
      ENDCASE
      SEEK ptDo+psEr+pdOc
      DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=ptDo+psEr+pdOc
           STORE f1301cod TO pcOd
           STORE f1301to2 TO ptO2
           STORE 2 TO pdTr
           STORE 1 TO ppDt
           SELECT prOductos
           SEEK ALLTRIM(vcOd)+"*"
           IF  .NOT. EOF()
                STORE f2111tip TO ptIp
                STORE f2111pdt TO ppDt
                SELECT tiP_prod
                SEEK ptIp
                IF  .NOT. EOF() .AND. f9211det<>0
                     STORE f9211det TO pdTr
                ENDIF
           ENDIF
           IF pdTr=1
                STORE pdEt+ROUND(ptO2*ppDt/100, 2) TO pdEt
           ENDIF
           SELECT deT_fact
           SKIP
      ENDDO
      IF pdEt=0
           DO CASE
                CASE prEg=1
                     SELECT caB_fact
                CASE prEg=2
                     SELECT caB_fact2
                CASE prEg=3
                     SELECT caB_fact3
                CASE prEg=4
                     SELECT caB_fact4
                CASE prEg=5
                     SELECT caB_fact5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      SELECT teMporal_3
      APPEND BLANK
      REPLACE ftM3tdo WITH ptDo
      REPLACE ftM3ser WITH psEr
      REPLACE ftM3doc WITH pdOc
      REPLACE ftM3fem WITH pfEm
      REPLACE ftM3fve WITH pfVe
      REPLACE ftM3ruc WITH prUc
      REPLACE ftM3nom WITH pnOm
      REPLACE ftM3tca WITH ptCa
      REPLACE ftM3net WITH pnEt
      REPLACE ftM3igv WITH piGv
      REPLACE ftM3tot WITH ptOt
      REPLACE ftM3dtr WITH pdEt
      STORE tbAs+ftM3net TO tbAs
      STORE tiGv+ftM3igv TO tiGv
      STORE ttOt+ftM3tot TO ttOt
      STORE tdTr+ftM3dtr TO tdTr
      DO CASE
           CASE prEg=1
                SELECT caB_fact
           CASE prEg=2
                SELECT caB_fact2
           CASE prEg=3
                SELECT caB_fact3
           CASE prEg=4
                SELECT caB_fact4
           CASE prEg=5
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
 RELEASE ptDo, psEr, pdOc, pfEm, pfVe, pmOn, ppIg, pnEt, piGv, ptOt, ptCa, peSt
 RELEASE pnOm, prUc, pcOd, ptO2, ptIp, pdTr, ppDt, pdEt
ENDPROC
*
PROCEDURE Fac_1320a
 PARAMETER prEg, pfOr
 DO CASE
      CASE ptDo="FA" .AND. SUBSTR(psEr, 1, 1)="T"
           STORE "TF" TO ptD1
      CASE ptDo="BO" .AND. SUBSTR(psEr, 1, 1)="T"
           STORE "TB" TO ptD1
 ENDCASE
 SELECT caMbio
 SEEK pfEm
 IF EOF()
      STORE "Tipo de Cambio del "+DTOC(pfEm)+" no registrado..." TO mmSj
      DO poNmsj
      = INKEY(10)
      STORE k_Esc TO mkEy
      RETURN
 ENDIF
 STORE f9111tc1 TO ptCa
 SELECT tiPo_doc
 SEEK ptDo
 IF  .NOT. EOF()
      STORE f9311td1 TO ptD1
 ELSE
      STORE "00" TO ptD1
 ENDIF
 DO seR_1320a WITH ptDo, psEr
 STORE psRx TO psR1
 STORE "0"+pdOc TO pdO1
 SELECT teMporal
 SEEK ptD1+ALLTRIM(psR1)+"*"+ALLTRIM(pdO1)+"*"
 IF  .NOT. EOF()
      WAIT WINDOW NOCLEAR NOWAIT
      STORE "Documento duplicado:"+ptDo+"-"+psEr+"-"+pdOc+ ;
            "... Presionar una Tecla..." TO mmSj
      DO poNmsj
      = INKEY(0)
      STORE 99999 TO mkEy
      RETURN
 ENDIF
 DO CASE
      CASE prEg=1
           SELECT caB_fact
      CASE prEg=2
           SELECT caB_fact2
      CASE prEg=3
           SELECT caB_fact3
      CASE prEg=4
           SELECT caB_fact4
      CASE prEg=5
           SELECT caB_fact5
 ENDCASE
 IF pfOr="1"
      DO CASE
           CASE (ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC" .OR. ptDo="TF"  ;
                .OR. (ptDo="TK" .AND. LEN(ALLTRIM(f1300ruc))<>0)) .AND.  ;
                f1300tdi<>"6"
                @ 1, 1 SAY "Grabando TDI en Factura "+f1300ser+"-"+ ;
                  f1300doc+" "+DTOC(f1300fem) FONT "Arial", 8 STYLE "NQ"  ;
                  SIZE 1, 50
                REPLACE f1300tdi WITH "6"
                REPLACE f1300ele WITH " "
           CASE f1300est$"89"
                @ 1, 1 SAY "Grabando TDI en: "+ptDo+":"+psEr+"-"+pdOc  ;
                  FONT "Arial", 8 STYLE "NQ" SIZE 1, 50
                IF LEN(ALLTRIM(f1300tdi))=0
                     REPLACE f1300tdi WITH " "
                ENDIF
                IF ptDo="BO" .AND. LEN(ALLTRIM(f1300ele))<>0
                     REPLACE f1300ele WITH SPACE(11)
                ENDIF
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB"  ;
                .OR. (ptDo="TK" .AND. LEN(ALLTRIM(f1300ruc))=0)
                @ 1, 1 SAY "Grabando TDI en Boleta "+psEr+"-"+pdOc+" "+ ;
                  DTOC(f1300fem) FONT "Arial", 8 STYLE "NQ" SIZE 1, 50
                IF LEN(ALLTRIM(f1300ele))=0 .AND. LEN(ALLTRIM(f1300ruc))<> ;
                   0 .AND. SUBSTR(f1300ruc, 1, 1)="1" .AND. f1300tdi$" 1"
                     REPLACE f1300ele WITH SUBSTR(f1300ruc, 3, 8)
                     REPLACE f1300ruc WITH " "
                ENDIF
                IF LEN(ALLTRIM(f1300ele))=0
                     REPLACE f1300tdi WITH " "
                     REPLACE f1300ruc WITH " "
                     REPLACE f1300ele WITH " "
                ELSE
                     IF f1300tdi=" "
                          REPLACE f1300tdi WITH "1"
                     ENDIF
                ENDIF
      ENDCASE
      UNLOCK
 ENDIF
 STORE f1300fem+f1300dia TO pfVe
 STORE f1300cm1 TO pcM1
 STORE f1300nom TO pnOm
 STORE f1300tdi TO ptDi
 STORE f1300ruc TO prUc
 STORE f1300ele TO pdNi
 STORE f1300mon TO pmOn
 STORE f1300pig TO ppIg
 STORE f1300igv TO piGv
 STORE f1300net TO pnEt
 STORE f1300tot TO ptOt
 STORE f1300est TO peSt
 IF pmOn=2
      STORE ptOt*ptCa TO ptOt
      STORE ROUND(ptOt/(1+(ppIg/100)), 2) TO pnEt
      STORE ptOt-pnEt TO piGv
 ENDIF
 DO CASE
      CASE piGv<>0
           STORE 0 TO peXo
           STORE pnEt TO pbAs
           STORE piGv TO piGv
      OTHERWISE
           STORE 0 TO pbAs, piGv
           STORE pnEt TO peXo
 ENDCASE
 IF ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB" .OR. (ptDo= ;
    "TK" .AND. LEN(ALLTRIM(prUc))=0)
      STORE pdNi TO prUc
 ENDIF
 IF peSt$"89"
      STORE 0 TO pbAs, pnEt, piGv, ptOt
      STORE "2" TO peS1
      IF peSt="8"
           STORE "DE BAJA" TO pnOm
      ELSE
           STORE "ANULADO" TO pnOm
      ENDIF
      IF (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TB" .OR.  ;
         ptDo="TK") .AND. LEN(ALLTRIM(prUc))=0
           STORE " " TO ptDi, prUc
      ENDIF
 ELSE
      STORE "1" TO peS1
 ENDIF
 STORE 0 TO tcOs
 IF pfOr="1"
      DO CASE
           CASE prEg=1
                SELECT deT_fact
           CASE prEg=2
                SELECT deT_fact2
           CASE prEg=3
                SELECT deT_fact3
           CASE prEg=4
                SELECT deT_fact4
           CASE prEg=5
                SELECT deT_fact5
      ENDCASE
      GOTO TOP
      SEEK ptDo+psEr+pdOc
      DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=ptDo+psEr+pdOc
           STORE f1301cod TO pcOd
           STORE f1301can TO pcAn
           SELECT prOductos
           SEEK ALLTRIM(pcOd)+"*"
           IF EOF() .OR. f2111tpo<>1
                DO CASE
                     CASE prEg=1
                          SELECT deT_fact
                     CASE prEg=2
                          SELECT deT_fact2
                     CASE prEg=3
                          SELECT deT_fact3
                     CASE prEg=4
                          SELECT deT_fact4
                     CASE prEg=5
                          SELECT deT_fact5
                ENDCASE
                SKIP
                LOOP
           ENDIF
           SELECT deT_cpras
           SEEK ALLTRIM(pcOd)+"*"
           STORE CTOD("  /  /    ") TO pfEc
           STORE 00 TO ppRe
           DO WHILE  .NOT. EOF() .AND. ALLTRIM(f2401cod)+"*"=ALLTRIM(pcOd)+"*"
                STORE f2401tdo TO ptD2
                STORE f2401ser TO psR2
                STORE f2401doc TO pdO2
                SELECT caB_cpras
                SEEK ptD2+psR2+pdO2
                IF  .NOT. EOF() .AND. f2400est<>"9" .AND. f2400fem>pfEc  ;
                    .AND. f2400td1<>"NC" .AND. f2400fem<=hfEm
                     STORE f2400fem TO pfEc
                     SELECT deT_cpras
                     STORE f2401pre TO ppRe
                ENDIF
                SELECT deT_cpras
                SKIP
           ENDDO
           SELECT prOductos
           IF ppRe=0
                STORE (f2111vcs/1.18) TO pvCs
           ELSE
                STORE ppRe TO pvCs
           ENDIF
           STORE tcOs+(pvCs*pcAn) TO tcOs
           DO CASE
                CASE prEg=1
                     SELECT deT_fact
                CASE prEg=2
                     SELECT deT_fact2
                CASE prEg=3
                     SELECT deT_fact3
                CASE prEg=4
                     SELECT deT_fact4
                CASE prEg=5
                     SELECT deT_fact5
           ENDCASE
           SKIP
      ENDDO
 ENDIF
 SELECT teMporal
 APPEND BLANK
 REPLACE f9702per WITH daNo+dmEs+"00"
 REPLACE f9702reg WITH " "
 REPLACE f9702asi WITH " "
 REPLACE f9702fem WITH DTOC(pfEm)
 REPLACE f9702fve WITH DTOC(pfEm)
 REPLACE f9702tcp WITH ptD1
 REPLACE f9702scp WITH psR1
 REPLACE f9702ncp WITH pdO1
 REPLACE f9702ncu WITH " "
 REPLACE f9702tdi WITH ptDi
 REPLACE f9702ruc WITH prUc
 REPLACE f9702nom WITH pnOm
 REPLACE f9702bae WITH 0
 REPLACE f9702bas WITH pbAs
 REPLACE f9702dct WITH 0
 REPLACE f9702igv WITH piGv
 REPLACE f9702dci WITH 0
 REPLACE f9702exo WITH peXo
 REPLACE f9702ina WITH 0
 REPLACE f9702isc WITH 0
 REPLACE f9702ba2 WITH 0
 REPLACE f9702iva WITH 0
 REPLACE f9702otr WITH 0
 REPLACE f9702tot WITH ptOt
 REPLACE f9702cm1 WITH pcM1
 IF pmOn=1
      REPLACE f9702mon WITH "PEN"
 ELSE
      REPLACE f9702mon WITH "USD"
 ENDIF
 REPLACE f9702tca WITH ptCa
 REPLACE f9702fe2 WITH "01/01/0001"
 REPLACE f9702tc2 WITH "00"
 REPLACE f9702sr2 WITH "-"
 REPLACE f9702do2 WITH "-"
 REPLACE f9702cto WITH " "
 REPLACE f9702err WITH " "
 REPLACE f9702fpa WITH "1"
 REPLACE f9702est WITH peS1
ENDPROC
*
PROCEDURE Cre_1320a
 PARAMETER prEg, pfOr
 STORE f3610tdo TO ptDo
 STORE f3610doc TO pdOc
 STORE SUBSTR(f3610cm1, 1, 2) TO ptD1
 STORE SUBSTR(f3610cm1, 4, 3) TO psR1
 STORE SUBSTR(f3610cm1, 8, 7) TO pdO1
 STORE "0"+pdOc TO pdO2
 STORE "0"+pdO1 TO pdO3
 STORE f3610fre TO pfRe
 DO CASE
      CASE ptDo="NC" .OR. ptDo="ND"
           STORE "0"+psEr TO psR2
      CASE ptDo="N1" .OR. ptDo="N2"
           STORE SUBSTR(psEr, 1, 1)+"0"+SUBSTR(psEr, 2, 2) TO psR2
      CASE (ptDo="N3" .OR. ptDo="N4") .AND. SUBSTR(ptD1, 1, 1)="F"
           STORE SUBSTR(psEr, 1, 1)+"0"+SUBSTR(psEr, 2, 2) TO psR2
      CASE (ptDo="N3" .OR. ptDo="N4") .AND. SUBSTR(ptD1, 1, 1)="B"
           STORE SUBSTR(psEr, 1, 2)+"0"+SUBSTR(psEr, 3, 1) TO psR2
 ENDCASE
 IF SUBSTR(psR1, 4, 1)="T"
      IF ptD1="FA" .OR. ptD1="TF"
           STORE "TF" TO ptD1
      ELSE
           STORE "TB" TO ptD1
      ENDIF
 ENDIF
 DO seR_1320a WITH ptD1, psR1
 STORE psRx TO psR3
 SELECT caMbio
 SEEK pfRe
 IF EOF()
      STORE "Tipo de Cambio del "+DTOC(pfRe)+" no registrado..." TO mmSj
      DO poNmsj
      = INKEY(10)
      STORE k_Esc TO mkEy
      RETURN
 ENDIF
 STORE f9111tc1 TO ptCa
 SELECT tiPo_doc
 SEEK ptDo
 IF  .NOT. EOF()
      STORE f9311td1 TO ptD2
 ELSE
      STORE "00" TO ptD2
 ENDIF
 SEEK ptD1
 IF  .NOT. EOF()
      STORE f9311td1 TO ptD3
 ELSE
      STORE "00" TO ptD3
 ENDIF
 SELECT teMporal
 SEEK ptD2+ALLTRIM(psR2)+"*"+ALLTRIM(pdO2)+"*"
 IF  .NOT. EOF()
      WAIT WINDOW NOCLEAR NOWAIT
      STORE "Documento duplicado:"+ptDo+":"+psEr+"-"+pdOc TO mmSj
      DO poNmsj
      = INKEY(10)
      STORE k_Esc TO mkEy
      RETURN
 ENDIF
 DO CASE
      CASE prEg=1
           SELECT caB_notas
      CASE prEg=2
           SELECT caB_nota2
      CASE prEg=3
           SELECT caB_nota3
      CASE prEg=4
           SELECT caB_nota4
      CASE prEg=5
           SELECT caB_nota5
 ENDCASE
 IF pfOr="1"
      @ 1, 1 SAY "Revisando TDI" FONT "Arial", 8 STYLE "NQ" SIZE 1, 50
      DO CASE
           CASE f3610est$"89"
                IF f3610tdi<>" "
                     @ 1, 1 SAY "Grabando TDI en "+ptDo+":"+psEr+"-"+pdOc  ;
                       FONT "Arial", 8 STYLE "NQ" SIZE 1, 50
                     REPLACE f3610tdi WITH " "
                ENDIF
           CASE (ptD1="FA" .OR. ptD1="FE" .OR. ptD1="FC" .OR. ptD1="TF")  ;
                .AND. f3610tdi<>"6"
                @ 1, 1 SAY "Grabando TDI en "+ptDo+":"+psEr+"-"+pdOc FONT  ;
                  "Arial", 8 STYLE "NQ" SIZE 1, 50
                REPLACE f3610tdi WITH "6"
           CASE ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC" .OR. ptD1="TB"
                @ 1, 1 SAY "Grabando TDI en "+ptDo+":"+psEr+"-"+pdOc FONT  ;
                  "Arial", 8 STYLE "NQ" SIZE 1, 50
                DO CASE
                     CASE LEN(ALLTRIM(f3610ele))<>0 .AND. f3610tdi<>"1"
                          REPLACE f3610tdi WITH "1"
                     CASE LEN(ALLTRIM(f3610ele))=0
                          REPLACE f3610tdi WITH " "
                ENDCASE
      ENDCASE
      UNLOCK
 ENDIF
 STORE f3610fem TO pfEm
 STORE f3610nom TO pnOm
 STORE f3610ruc TO prUc
 STORE f3610ele TO pdNi
 STORE f3610pig TO ppIg
 STORE f3610mon TO pmOn
 STORE f3610net TO pnEt
 STORE f3610igv TO piGv
 STORE f3610tot TO ptOt
 STORE f3610est TO peSt
 STORE f3610tdi TO ptDi
 STORE CTOD(SUBSTR(f3610cm2, 1, 10)) TO pfE1
 IF pmOn=2
      STORE ptOt*ptCa TO ptOt
      STORE ROUND(ptOt/(1+(ppIg/100)), 2) TO pnEt
      STORE ptOt-pnEt TO piGv
 ENDIF
 IF ptDo="NC" .OR. ptDo="N1" .OR. ptDo="N3"
      STORE pnEt*-1 TO pnEt
      STORE piGv*-1 TO piGv
      STORE ptOt*-1 TO ptOt
 ENDIF
 IF f3610est$"89"
      STORE "2" TO peS1
      STORE "00" TO ptD1
      STORE "-" TO psR1, pdO1
      STORE 0 TO pnEt, piGv, ptOt
      STORE CTOD("01/01/0001") TO pfE1
      IF peSt="8"
           STORE "DE BAJA" TO pnOm
      ELSE
           STORE "ANULADO" TO pnOm
      ENDIF
 ELSE
      IF ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC" .OR. ptD1="TB" .OR.  ;
         (ptD1="TK" .AND. LEN(ALLTRIM(prUc))=0)
           STORE pdNi TO prUc
      ENDIF
      STORE "1" TO peS1
      IF LEN(ALLTRIM(prUc))=0
           STORE " " TO prUc
      ENDIF
 ENDIF
 DO CASE
      CASE piGv<>0
           STORE pnEt TO pbAs
           STORE piGv TO piGv
           STORE 0 TO peXo
      OTHERWISE
           STORE 0 TO pbAs, piGv
           STORE pnEt TO peXo
 ENDCASE
 SELECT teMporal
 APPEND BLANK
 REPLACE f9702per WITH daNo+dmEs+"00"
 REPLACE f9702reg WITH " "
 REPLACE f9702asi WITH " "
 REPLACE f9702fem WITH DTOC(pfEm)
 REPLACE f9702fve WITH DTOC(pfEm)
 REPLACE f9702tcp WITH ptD2
 REPLACE f9702scp WITH psR2
 REPLACE f9702ncp WITH pdO2
 REPLACE f9702ncu WITH " "
 REPLACE f9702tdi WITH ptDi
 REPLACE f9702ruc WITH prUc
 REPLACE f9702nom WITH pnOm
 REPLACE f9702bae WITH 0
 REPLACE f9702bas WITH pbAs
 REPLACE f9702dct WITH 0
 REPLACE f9702igv WITH piGv
 REPLACE f9702dci WITH 0
 REPLACE f9702exo WITH peXo
 REPLACE f9702ina WITH 0
 REPLACE f9702isc WITH 0
 REPLACE f9702ba2 WITH 0
 REPLACE f9702iva WITH 0
 REPLACE f9702otr WITH 0
 REPLACE f9702tot WITH ptOt
 IF pmOn=1
      REPLACE f9702mon WITH "PEN"
 ELSE
      REPLACE f9702mon WITH "USD"
 ENDIF
 REPLACE f9702tca WITH ptCa
 REPLACE f9702fe2 WITH DTOC(pfE1)
 REPLACE f9702tc2 WITH ptD3
 REPLACE f9702sr2 WITH psR3
 REPLACE f9702do2 WITH pdO3
 REPLACE f9702cto WITH " "
 IF SUBSTR(DTOC(pfRe), 4, 7)<>SUBSTR(DTOC(pfEm), 4, 7)
      REPLACE f9702err WITH "1"
 ELSE
      REPLACE f9702err WITH " "
 ENDIF
 REPLACE f9702fpa WITH " "
 REPLACE f9702est WITH peS1
ENDPROC
*
PROCEDURE Cuo_1320a
 PRIVATE pnUm, psUb, pfEm, prEg, pcUo, ptDo, psEr, pdOc, paLt
 STORE "05" TO psUb
 STORE 0 TO pnUm
 SELECT teMporal
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE pnUm+1 TO pnUm
      STORE CTOD(f9702fem) TO pfEm
      STORE f9702tcp TO ptDo
      STORE f9702scp TO psEr
      STORE f9702ncp TO pdOc
      IF pnUm>9999
           STORE 1 TO pnUm
           STORE STRTRAN(STR(VAL(ALLTRIM(psUb))+1, 2, 0), " ", "0") TO psUb
      ENDIF
      STORE ALLTRIM(psUb)+STRTRAN(STR(pnUm, 4, 0), " ", "0") TO prEg
      DO CASE
           CASE mcIa="MV" .AND. pnUm=1 .AND. SUBSTR(DTOC(pfEm), 4, 2)="01"
                STORE "A"+psUb+STRTRAN(STR(pnUm, 4, 0), " ", "0") TO pcUo
           CASE mcIa="MV"
                STORE "M"+psUb+STRTRAN(STR(pnUm, 4, 0), " ", "0") TO pcUo
           CASE pnUm=1 .AND. SUBSTR(DTOC(pfEm), 4, 2)="01"
                STORE "A"+STRTRAN(STR(pnUm, 6, 0), " ", "0") TO pcUo
           OTHERWISE
                STORE "M"+STRTRAN(STR(pnUm, 6, 0), " ", "0") TO pcUo
      ENDCASE
      REPLACE f9702reg WITH prEg
      REPLACE f9702asi WITH pcUo
      SELECT teMporal_3
      SEEK ptDo+ALLTRIM(psEr)+"*"+ALLTRIM(pdOc)+"*"
      IF  .NOT. EOF()
           STORE ftM3tdd TO ptDo
           STORE ftM3srd TO psEr
           STORE ftM3dod TO pdOc
           STORE 0 TO paLt
           @ 1, 1 SAY "Grabando CUO: "+ptDo+":"+psEr+"-"+pdOc STYLE "BQ"  ;
             SIZE 1, 20
           DO CASE
                CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC" .OR. ptDo= ;
                     "BO" .OR. ptDo="BE" .OR. ptDo="BC" .OR. ptDo="TK"  ;
                     .OR. ptDo="TF" .OR. ptDo="TB"
                     SELECT caB_fact
                     SEEK ptDo+psEr+pdOc
                     IF  .NOT. EOF()
                          STORE 1 TO paLt
                     ENDIF
                     IF vaL2=1 .AND. paLt=0
                          SELECT caB_fact2
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 2 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL3=1 .AND. paLt=0
                          SELECT caB_fact3
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 3 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL4=1 .AND. paLt=0
                          SELECT caB_fact4
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 4 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL5=1 .AND. paLt=0
                          SELECT caB_fact5
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 5 TO paLt
                          ENDIF
                     ENDIF
                     IF  .NOT. EOF()
                          REPLACE f1300cuo WITH pcUo
                     ENDIF
                OTHERWISE
                     SELECT caB_notas
                     SEEK ptDo+psEr+pdOc
                     IF  .NOT. EOF()
                          STORE 1 TO paLt
                     ENDIF
                     IF vaL2=1 .AND. paLt=0
                          SELECT caB_nota2
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 2 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL3=1 .AND. paLt=0
                          SELECT caB_nota3
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 3 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL4=1 .AND. paLt=0
                          SELECT caB_nota4
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 4 TO paLt
                          ENDIF
                     ENDIF
                     IF vaL5=1 .AND. paLt=0
                          SELECT caB_nota5
                          SEEK ptDo+psEr+pdOc
                          IF  .NOT. EOF()
                               STORE 5 TO paLt
                          ENDIF
                     ENDIF
                     IF  .NOT. EOF()
                          REPLACE f3610cuo WITH pcUo
                     ENDIF
           ENDCASE
      ENDIF
      SELECT teMporal
      SKIP
 ENDDO
 RELEASE pnUm, psUb, pfEm, prEg, pcUo, ptDo, psEr, pdOc, paLt
ENDPROC
*
PROCEDURE Ser_1320a
 PARAMETER qtDo, qsEr
 DO CASE
      CASE mcIa="MB" .AND. qtDo="TF" .AND. qsEr="T1F"
           STORE "2291114030410128" TO psRx
      CASE mcIa="MB" .AND. qtDo="TF" .AND. qsEr="T4F"
           STORE "2291115020600071" TO psRx
      CASE mcIa="MB" .AND. qtDo="TF" .AND. qsEr="T5F"
           STORE "2291115020600020" TO psRx
      CASE mcIa="MB" .AND. qtDo="TB" .AND. qsEr="T1B"
           STORE "2291114030410112" TO psRx
      CASE mcIa="MB" .AND. qtDo="TB" .AND. qsEr="T4B"
           STORE "2291115020600034" TO psRx
      CASE mcIa="MB" .AND. qtDo="TB" .AND. qsEr="T5B"
           STORE "2291113020410111" TO psRx
      CASE mcIa="EC" .AND. (qtDo="TF" .OR. qtDo="TB")
           STORE "2291114030410454" TO psRx
      CASE qtDo="FE"
           STORE "F"+qsEr TO psRx
      CASE qtDo="BE"
           STORE "B"+qsEr TO psRx
      CASE qtDo="FC"
           STORE "E"+qsEr TO psRx
      CASE qtDo="BC"
           STORE "EB"+SUBSTR(qsEr, 2, 2) TO psRx
      OTHERWISE
           STORE "0"+qsEr TO psRx
 ENDCASE
ENDPROC
*
PROCEDURE Clp_1320a
 = INKEY(0.01)
 STORE 0 TO ciTx
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Enter TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.80
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfI1-0.35 .AND. mfIl<=vfI1+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>1
           IF voPc=2
                STORE 4 TO viTe
           ENDIF
           STORE 1 TO voPc
           DO opC_1320a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI2-0.35 .AND. mfIl<=vfI2+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>2
           STORE 2 TO voPc
           DO opC_1320a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI3-0.35 .AND. mfIl<=vfI3+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>3
           IF voPc=2
                STORE 4 TO viTe
           ENDIF
           STORE 3 TO voPc
           DO opC_1320a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI4-0.35 .AND. mfIl<=vfI4+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>4
           IF voPc=2
                STORE 4 TO viTe
           ENDIF
           STORE 4 TO voPc
           DO opC_1320a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI1+2.428 .AND. mfIl<=vfI1+4.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>1
           STORE 01 TO viTe
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+4.428 .AND. mfIl<=vfI1+6.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>2
           STORE 02 TO ciTx
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+6.428 .AND. mfIl<=vfI1+8.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>3
           STORE 03 TO ciTx
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+8.428 .AND. mfIl<=vfI1+10.00 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>4
           STORE 04 TO ciTx
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+10.428 .AND. mfIl<=vfI1+12.00 .AND. voPc=2 .AND.  ;
           mcCc>=vcO1+70.8 .AND. mcCc<=vcO1+100.2 .AND. viTe<>5
           STORE 05 TO ciTx
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
 IF ciTx<>0
      DO WHILE viTe<ciTx .AND. mkEy<>99
           DO veR_1320a
           IF mkEy=k_Esc
                EXIT
           ENDIF
           IF mkEy<>99
                STORE viTe+1 TO viTe
           ENDIF
      ENDDO
 ENDIF
ENDPROC
*
PROCEDURE Hlp_1320a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0.2 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Este Programa tiene varias opciones para ordenar la información de Ven-"
 @ pfIl+01, 02 SAY "tas por pantalla o impresora."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 20 SAY ":" STYLE "BT"
 @ pfIl+06, 20 SAY ":" STYLE "BT"
 @ pfIl+07, 20 SAY ":" STYLE "BT"
 @ pfIl+08, 20 SAY ":" STYLE "BT"
 @ pfIl+10, 20 SAY ":" STYLE "BT"
 @ pfIl+11, 20 SAY ":" STYLE "BT"
 @ pfIl+12, 20 SAY ":" STYLE "BT"
 @ pfIl+05, 02 SAY "ESC" STYLE "BT"
 @ pfIl+06, 02 SAY "F10" STYLE "BT"
 @ pfIl+07, 02 SAY "F1" STYLE "BT"
 @ pfIl+08, 02 SAY "ENTER, CTRL ->," STYLE "BT"
 @ pfIl+09, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+10, 02 SAY "TAB" STYLE "BT"
 @ pfIl+11, 02 SAY "FLECHA ARRIBA" STYLE "BT"
 @ pfIl+12, 02 SAY "ALT S" STYLE "BT"
 @ pfIl+05, 22 SAY "Regresar a la pantalla anterior"
 @ pfIl+06, 22 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 22 SAY "Ayuda del Programa"
 @ pfIl+08, 22 SAY "Ir al siguiente campo, al final ingresa a la Consulta"
 @ pfIl+10, 22 SAY "Ir a la Consulta"
 @ pfIl+11, 22 SAY "Campo anterior"
 @ pfIl+12, 22 SAY "Fijar las Cuentas Contables"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE viTe, viT1, ciTx, vxLs, vpAg, vhOr, vpLe, vsW0, vsW1, vfI1, vfI2,  ;
         vfI3, vfI4
 RELEASE vcO1, vcL1, vcL2, vnUf, ifIl, ufIl, vfIl, ffIl, cfIl, ifFs, ufFs,  ;
         vfFs, ffFs
 RELEASE cfFs, dfEm, hfEm, cdFe, chFe, dsEr, hsEr, cdSe, chSe, vdAo, cdAo,  ;
         voPc, coPc
 RELEASE xoPc, ddIa, dmEs, daNo, vtDo, itDo, utDo, ctDo, xtDo, vsEr, isEr,  ;
         usEr, csEr
 RELEASE xsEr, vdOc, idOc, udOc, cdOc, xdOc, vdEb, vdE2, vdE3, vdE4, vhAb,  ;
         vhA2, vhA3
 RELEASE vhA4, vcOd, vaLt, vpT2, vpT3, vpT4, vpT5, vnO1, vnO2, vnO3, vnO4,  ;
         vnO5, vaL2
 RELEASE vaL3, vaL4, vaL5, vaB1, vaB2, vaB3, vaB4, vaB5, tnFa, tnBo, tbAe,  ;
         tbAs, teXo
 RELEASE tiNa, tiSc, tiGv, tbA2, tiVa, toTr, ttOt, tnCr, tnDe, tpEr, tdTr,  ;
         vaA1, vaA2
 RELEASE vaA3, vaA4, vaA5, tcOs
 RELEASE vpAn_11, vpAn_99
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 DO deL_file2 WITH "3", "S"
 DO deL_file2 WITH "4", "S"
 DO deL_file2 WITH "5", "S"
 RELEASE ntM1, ntM2, ntM3, ntM4, ntM5
ENDPROC
*
