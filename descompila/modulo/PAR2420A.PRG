 SET CENTURY ON
 PUBLIC ntM1, ntM2, afIl, x
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE 01 TO meRr
 DIMENSION afIl[84, 4]
 STORE 1 TO x
 afIl[x, 1] = "F9701PER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701REG"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ASI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP3"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701FEM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP4"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701FVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP5"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701TCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP6"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701SCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP7"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ADU"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP8"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701NCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP9"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701NCU"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP10"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701TDI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP11"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP12"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 100
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP13"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701BA1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP14"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701IG1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP15"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701BA2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP16"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701IG2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP17"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701BA3"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP18"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701IG3"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP19"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701VAN"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP20"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ISC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP21"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701OTR"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP22"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "SEP23"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701MON"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP24"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 5
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "SEP25"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701FE2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP26"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701TC2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP27"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701SR2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP28"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701CDA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP29"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701DO2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP30"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701FDE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP31"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701NDE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 24
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP32"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701MAR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP33"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701CLA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP34"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701CTO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 12
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP35"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ERR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP36"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ER2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP37"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ER3"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP38"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701ER4"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP39"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP40"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701EST"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP41"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "F9701CM1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 55
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "SEP42"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ALLTRIM(f9701ruc)+"*"+f9701tcp+ALLTRIM(f9701scp)+"*"+ ;
       ALLTRIM(f9701ncp)+"*" TAG f9701doc
 INDEX ON SUBSTR(f9701fem, 7, 4)+SUBSTR(f9701fem, 4, 2)+SUBSTR(f9701fem,  ;
       1, 2)+f9701tcp+ALLTRIM(f9701ruc)+"*"+ALLTRIM(f9701scp)+"*"+ ;
       ALLTRIM(f9701ncp)+"*" TAG f9701fem
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[13, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM2TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2SCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NCP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2RUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FEM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NET"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2INA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2IGV"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 2
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM2tdo+ftM2ser+ftM2doc TAG ftM2doc
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 STORE 99 TO mkEy
 SELECT 1
 DO abR_0000a IN PUX0000A WITH "2400", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared Alias Cab_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 GOTO TOP
 IF BOF() .OR. EOF()
      STORE "Archivo de Documentos de Compras no puede estar vacío" TO mmSj
      STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
            "PRESIONAR UNA TECLA PARA REGRESAR AL MENÚ..." TO mmSj
      WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
      WAIT CLEAR
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2400REG
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 DO abR_0000a IN PUX0000A WITH "2401", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2401DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 DO abR_0000a IN PUX0000A WITH "2101", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Proveedores
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2101COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 DO abR_0000a IN PUX0000A WITH "3520", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3520NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 DO abR_0000a IN PUX0000A WITH "3521", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3521NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 DO abR_0000a IN PUX0000A WITH "3540", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3540NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 DO abR_0000a IN PUX0000A WITH "3541", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3541NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 DO abR_0000a IN PUX0000A WITH "9000", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared Alias Datos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 DO abR_0000a IN PUX0000A WITH "9111", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cambio
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9111FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 11
 DO abR_0000a IN PUX0000A WITH "9211", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tip_Prod
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9211TIP
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 12
 DO abR_0000a IN PUX0000A WITH "9216", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Grupos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9216COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 13
 DO abR_0000a IN PUX0000A WITH "9311", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tipo_Doc
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9311TDO
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 14
 DO abR_0000a IN PUX0000A WITH "9991", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Tiendas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9991COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 15
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9701DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 16
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Tmp_Doc
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM2DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 17 TO muLt
 SELECT caB_cpra
 STORE 00 TO meRr
 PUBLIC vsW1, viTe, vfI1, vfI2, vfI3, vfI4, vcO1, ifIl, ufIl, vfIl, ffIl,  ;
        ifFs, ufFs
 PUBLIC vfFs, ffFs, vcL1, vcL2, voPc, coPc, vdAo, cdAo, dfEm, hfEm, vfEm,  ;
        ifEm, ufEm
 PUBLIC vfE2, cdFe, chFe, vtCp, itCp, utCp, vsCp, isCp, usCp, vnCp, inCp,  ;
        unCp, vrUc
 PUBLIC irUc, urUc, vnUf, ddIa, dmEs, daNo, vhOr, vnUm, vaL2, vaL3, vaL4,  ;
        vaL5, vsEl
 PUBLIC vcOd, vpT2, vpT3, vpT4, vpT5, vtCa, vtD1, vtD2, vtDo, ctDo, vtDi,  ;
        vsEr, vdOc
 PUBLIC vdO2, vsR1, vsR2, vfAc, vnOm, vnO1, vnO2, vnO3, vnO4, vnO5, vfVe,  ;
        vpIg, vmOn
 PUBLIC vnEt, viGv, vtOt, ttOt, vrEg, vpLe, vtB1, tbA1, tiG1, tbA2, tiG2,  ;
        tbA3, tiG3
 PUBLIC tvAn, tiSc, toTr, vpEr, vdEb, vhAb, vhA2, viNa
 PUBLIC vpAn_11, vpAn_99
 STORE SPACE(30) TO vnO1, vnO2, vnO3, vnO4, vnO5, vpT2, vpT3, vpT4, vpT5
 STORE CTOD("01"+SUBSTR(DTOC(DATE()), 3, 8)) TO dfEm
 STORE CTOD("  /  /    ") TO cdFe, chFe
 STORE DATE() TO hfEm
 STORE 99 TO mkEy
 STORE mdAo TO vdAo
 STORE 01 TO voPc, viTe, vsW1
 STORE 00 TO coPc, cdAo, vnUf, tbA1, tiG1, tbA2, tiG2, tbA3, tiG3
 STORE 00 TO vaL2, vaL3, vaL4, vaL5, tvAn, tiSc, toTr, ttOt
 STORE 17 TO vsEl
 SELECT daTos
 GOTO TOP
 STORE f9000emp TO veMp
 STORE f9000csb TO vsUb
 STORE f9000cd1 TO vdEb
 STORE f9000cd2 TO vdE2
 STORE f9000ch1 TO vhAb
 STORE f9000ch2 TO vhA2
 SELECT tiEndas
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE f9991cod TO vcOd
      DO CASE
           CASE vcOd="01"
                STORE f9991nom TO vnO1
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO1)+"..." STYLE "BQ"
                SKIP
                LOOP
           CASE vcOd="02"
                SKIP
                LOOP
           CASE vcOd="03"
                STORE f9991nom TO vnO2
                STORE f9991pth TO vpT2
           CASE vcOd="04"
                STORE f9991nom TO vnO3
                STORE f9991pth TO vpT3
           CASE vcOd="05"
                STORE f9991nom TO vnO4
                STORE f9991pth TO vpT4
           CASE vcOd="06"
                STORE f9991nom TO vnO5
                STORE f9991pth TO vpT5
           OTHERWISE
                EXIT
      ENDCASE
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO2)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT2)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO2)+" APAG" TO vnO2
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Cpra2
                STORE 1 TO vaL2, vaA2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO3)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT3)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO3)+" APAG" TO vnO3
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Cpra3
                STORE 1 TO vaL3, vaA3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO4)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT4)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO4)+" APAG" TO vnO4
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Cpra4
                STORE 1 TO vaL4, vaA4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO: CAB "+ALLTRIM(vnO5)+"..." STYLE "BQ"
                STORE ALLTRIM(vpT5)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE ALLTRIM(vnO5)+" APAG" TO vnO5
                     STORE 99 TO mkEy
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Shared Alias Cab_Cpra5
                STORE 1 TO vaL5, vaA5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F2400REG
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      SELECT tiEndas
      SKIP
 ENDDO
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 WAIT CLEAR
 SET READBORDER ON
 DO p00_2420a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 SET READBORDER ON
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO p00_2420a WITH "1"
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_2420a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hlP_2420a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO p00_2420a WITH "1"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Alt_s
                DO q1_0000a
                SAVE SCREEN TO vpAn_11
                DO coLbln
                @ vfI1+06, vcO1+28 CLEAR TO vfI1+23, vcO1+89
                @ vfI1+06, vcO1+28 TO vfI1+23, vcO1+89
                @vFI1+07,vCO1+32 Say "Empresa"    Font "&mLetRom",14 Style "BQ"
                @vFI1+10,vCO1+32 Say "Sub-Diario" Font "&mLetRom",14 Style "BQ"
                @vFI1+13,vCO1+32 Say "Debe"       Font "&mLetRom",14 Style "BQ"
                @vFI1+15,vCO1+32 Say "Debe-2"     Font "&mLetRom",14 Style "BQ"
                @vFI1+18,vCO1+32 Say "Haber"      Font "&mLetRom",14 Style "BQ"
                @vFI1+20,vCO1+32 Say "Haber-2"    Font "&mLetRom",14 Style "BQ"
                ON KEY LABEL ESC DO P_ESC
                ON KEY LABEL TAB DO P_TAB
                DO WHILE .T.
                     @vFI1+07,vCO1+53 Get vEMP Font "&mLetRom",14 Style "NQ" Size 1,06 Pict "@S04" Color ,&mColBlN
                     @vFI1+10,vCO1+53 Get vSUB Font "&mLetRom",14 Style "NQ" Size 1,06 Pict "@S04" Color ,&mColBlN
                     @vFI1+13,vCO1+53 Get vDEB Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+15,vCO1+53 Get vDE2 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+18,vCO1+53 Get vHAB Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     @vFI1+20,vCO1+53 Get vHA2 Font "&mLetRom",14 Style "NQ" Size 1,18 Pict "@S12" Color ,&mColBlN
                     SET CONFIRM ON
                     SET CURSOR ON
                     READ
                     SET CURSOR OFF
                     SET CONFIRM OFF
                     SELECT daTos
                     IF mkEy=k_Esc .OR. mkEy=k_Tab
                          EXIT
                     ENDIF
                ENDDO
                IF mkEy=k_Tab
                     REPLACE f9000emp WITH veMp
                     REPLACE f9000csb WITH vsUb
                     REPLACE f9000cd1 WITH vdEb
                     REPLACE f9000cd2 WITH vdE2
                     REPLACE f9000ch1 WITH vhAb
                     REPLACE f9000ch2 WITH vhA2
                     UNLOCK
                ELSE
                     STORE f9000emp TO veMp
                     STORE f9000csb TO vsUb
                     STORE f9000cd1 TO vdEb
                     STORE f9000cd2 TO vdE2
                     STORE f9000ch1 TO vhAb
                     STORE f9000ch2 TO vhA2
                ENDIF
                DO p1_0000a
                STORE 99 TO mkEy
                RESTORE SCREEN FROM vpAn_11
           CASE mkEy=k_Ctrl_home .AND. viTe=1
                STORE "Estás en el primer campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=2 .AND. voPc<>2
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=3
                STORE "Estás en el último campo..." TO mmSj
           CASE mkEy=k_Ctrl_left
                STORE "No hay campos a la izquierda..." TO mmSj
           CASE mkEy=k_Up .AND. viTe=1
                STORE "No hay más campos arriba..." TO mmSj
           CASE mkEy=k_Esc .OR. mkEy=k_Ctrl_home
                STORE 99 TO mkEy
                STORE 01 TO viTe
           CASE mkEy=k_Up
                STORE viTe-1 TO viTe
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Ctrl_right
                DO veR_2420a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99
                     DO CASE
                          CASE viTe=3 .AND. voPc=2
                               SAVE SCREEN TO vpAn_11
                               DO paR2420c
                               STORE dfEm TO cdFe
                               STORE hfEm TO chFe
                               STORE vdAo TO cdAo
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               RESTORE SCREEN FROM vpAn_11
                          CASE viTe=2
                               SAVE SCREEN TO vpAn_11
                               DO CASE
                                    CASE voPc=1
                                         SELECT teMporal
                                         SET ORDER TO F9701FEM
                                         DO paR2420b
                                         SELECT teMporal
                                         SET ORDER TO F9701DOC
                                    CASE voPc=3
                                         DO paR2420d
                                    CASE voPc=4
                                         DO paR2420e
                               ENDCASE
                               STORE dfEm TO cdFe
                               STORE hfEm TO chFe
                               STORE vdAo TO cdAo
                               STORE 01 TO viTe
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               RESTORE SCREEN FROM vpAn_11
                          OTHERWISE
                               STORE viTe+1 TO viTe
                     ENDCASE
                ENDIF
           CASE mkEy=k_Ctrl_end
                DO veR_2420a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                DO CASE
                     CASE voPc<>2
                          IF mkEy<>99
                               STORE 2 TO viTe
                          ENDIF
                     CASE voPc=2
                          IF mkEy<>99 .AND. viTe<2
                               STORE 2 TO viTe
                               DO veR_2420a
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                          ENDIF
                          IF mkEy<>99
                               STORE 3 TO viTe
                          ENDIF
                ENDCASE
           CASE mkEy=k_Tab
                DO veR_2420a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy<>99 .AND. viTe<2
                     STORE 2 TO viTe
                     DO veR_2420a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                ENDIF
                IF mkEy<>99 .AND. viTe<3 .AND. voPc=2
                     STORE 3 TO viTe
                     DO veR_2420a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                ENDIF
                IF mkEy<>99
                     SAVE SCREEN TO vpAn_11
                     DO CASE
                          CASE voPc=1
                               SELECT teMporal
                               SET ORDER TO F9701FEM
                               DO paR2420b
                               SELECT teMporal
                               SET ORDER TO F9701DOC
                          CASE voPc=2
                               DO paR2420c
                          CASE voPc=3
                               DO paR2420d
                          CASE voPc=4
                               DO paR2420e
                     ENDCASE
                     STORE dfEm TO cdFe
                     STORE hfEm TO chFe
                     STORE vdAo TO cdAo
                     STORE 01 TO viTe
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     RESTORE SCREEN FROM vpAn_11
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      STORE k_Enter TO mkEy
      DO coLbln
      DO CASE
           CASE viTe=1
                @vFI1+2.5,vCO1+85.0 Get dFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=2
                @vFI1+4.5,vCO1+85.0 Get hFEM Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
           CASE viTe=3 .AND. voPc=2
                @vFI1+6.5,vCO1+87.3 Get vDAO Font "&mLetRom",12 Style "NQ" Size 1,10 Color ,&mColBlN Pict "999999"
      ENDCASE
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE P00_2420a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 STORE 03 TO vnUf
 STORE 14 TO muFi
 STORE 110 TO muCo
 STORE (mwFi-muFi)/2-1 TO vfI1
 STORE (mwCo-muCo)/2 TO vcO1
 STORE vfI1+vnUf TO vfI2
 STORE vfI2+vnUf TO vfI3
 STORE vfI3+vnUf TO vfI4
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mfI0+1.3 TO ifIl, ufIl, vfIl
 STORE ifIl+INT(muFi)-1 TO ffIl
 STORE ifIl+0.5 TO ifFs, ufFs, vfFs
 STORE ifFs+(ffIl-ifIl) TO ffFs
 STORE mcO0+150.7 TO vcL1
 Define Popup vTB1 from mFI0,mCO0+06 to mFI0+mUFI+2,mCO0+mUCO-06 Font "&mLetCou",14 Style "NQU" Prompt Field " "+FTM2TDO+":"+FTM2SER+"-"+FTM2DOC+" Emision:"+FTM2FEM+" Vcto:"+FTM2FVE+" Base:"+Str(FTM2NET,12,2)+" IGV:"+Str(FTM2IGV,12,2)+" Total:"+Str(FTM2TOT,12,2) Scroll Color Scheme 10 Footer "CONSULTA DE COMPRAS"
 ON SELECTION POPUP vtB1 DO TB1_0000A
 DO tiT_0000a WITH "Reportes Especiales de SUNAT"
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 SAVE SCREEN TO vpAn_99
 DO coL_beige
 DO cuAdro WITH vfI1, vcO1+66, vfI1+8.8, vcO1+106
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLneb
 DO CASE
      CASE mrEs="3"
           @vFI1-4.0,vCO1+8.0 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
           DO coLbln
           @vFI1-3.9,vCO1+8.2 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
      OTHERWISE
           @vFI1-4.0,vCO1+8.0 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
           DO coLbln
           @vFI1-3.9,vCO1+8.2 Say "Tipo de Reportes" Font "&mLetAri",18 Style "BT"
 ENDCASE
 DO coLblz
 @vFI1+0.2,vCO1+14.0 Say "Registro de Compras"      Font "&mLetAri",10 Style "BT"
 @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
 @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
 @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 DO opC_2420a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_beige
 @vFI1+00.5,vCO1+71 Say "Fechas:"    Font "&mLetRom",14 Style "BQ"
 @vFI1+02.5,vCO1+71 Say "Desde"      Font "&mLetRom",14 Style "NQ"
 @vFI1+04.5,vCO1+71 Say "Hasta"      Font "&mLetRom",14 Style "NQ"
 @vFI1+02.5,vCO1+85 Get dFEM         Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 @vFI1+04.5,vCO1+85 Get hFEM         Font "&mLetRom",12 Style "NQ" Size 1,12 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO p01_2420a
ENDPROC
*
PROCEDURE P01_2420a
 DO coL_beige
 IF voPc=2
      @vFI1+06.5,vCO1+71.0 Say "Mímimo:" Font "&mLetRom",14 Style "BQ"
      @vFI1+06.5,vCO1+87.3 Get vDAO      Font "&mLetRom",12 Style "NQ" Size 1,10 Color ,&mColBlN Pict "999,999"
      READ TIMEOUT 0.01
 ELSE
      @ vfI1+06.3, vcO1+70 CLEAR TO vfI1+8.1, vcO1+100
 ENDIF
ENDPROC
*
PROCEDURE Opc_2420a
 DO CASE
      CASE coPc=1
           DO prEsiona WITH "1", "ITEM0", vfI1, vcO1+2
      CASE coPc=2
           DO prEsiona WITH "1", "ITEM0", vfI2, vcO1+2
      CASE coPc=3
           DO prEsiona WITH "1", "ITEM0", vfI3, vcO1+2
      CASE coPc=4
           DO prEsiona WITH "1", "ITEM0", vfI4, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLblz
 DO CASE
      CASE coPc=1
           @vFI1+0.2,vCO1+14.0 Say "Registro de Compras"      Font "&mLetAri",10 Style "BT"
      CASE coPc=2
           @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
      CASE coPc=3
           @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
      CASE coPc=4
           @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 ENDCASE
 DO CASE
      CASE voPc=1
           DO prEsiona WITH "2", "ITEM0", vfI1, vcO1+2
      CASE voPc=2
           DO prEsiona WITH "2", "ITEM0", vfI2, vcO1+2
      CASE voPc=3
           DO prEsiona WITH "2", "ITEM0", vfI3, vcO1+2
      CASE voPc=4
           DO prEsiona WITH "2", "ITEM0", vfI4, vcO1+2
 ENDCASE
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(253,242,47,0,0,0)
 DO CASE
      CASE voPc=1
           @vFI1+0.2,vCO1+14.0 Say "Registro de Compras"      Font "&mLetAri",10 Style "BT"
      CASE voPc=2
           @vFI2+0.2,vCO1+17.0 Say "Reporte DAOT"             Font "&mLetAri",10 Style "BT"
      CASE voPc=3
           @vFI3+0.2,vCO1+11.0 Say "Registro de Percepciones" Font "&mLetAri",10 Style "BT"
      CASE voPc=4
           @vFI4+0.2,vCO1+11.0 Say "Registro de Detracciones" Font "&mLetAri",10 Style "BT"
 ENDCASE
 IF coPc=2 .OR. voPc=2
      DO p01_2420a
 ENDIF
 STORE voPc TO coPc
ENDPROC
*
PROCEDURE Ver_2420a
 DO CASE
      CASE viTe=1 .AND. AT(" ", DTOC(dfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. AT(" ", DTOC(hfEm))<>0
           STORE "Fecha no puede tener espacios vacíos..." TO mmSj
      CASE viTe=2 .AND. dfEm>hfEm
           STORE "Fecha inicial no puede ser mayor a final..." TO mmSj
      CASE (viTe=2 .AND. voPc<>2) .OR. (viTe=3 .AND. voPc=2)
           STORE SUBSTR(DTOC(dfEm), 1, 2) TO ddIa
           STORE SUBSTR(DTOC(dfEm), 4, 2) TO dmEs
           STORE SUBSTR(DTOC(dfEm), 7, 4) TO daNo
           SELECT caB_cpra
           SET DELETED OFF
           GOTO TOP
           SET DELETED ON
           SET NEAR ON
           SEEK daNo+dmEs+ddIa
           SET NEAR OFF
           DO CASE
                CASE EOF() .OR. f2400fem>hfEm
                     STORE "No hay datos en este rango de Fecha..." TO mmSj
                CASE dfEm<>cdFe .OR. hfEm<>chFe .OR. (voPc=2 .AND. vdAo<>cdAo)
                     STORE 0 TO vnUm
                     STORE TIME() TO vhOr
                     SELECT teMporal
                     ZAP
                     WAIT WINDOW NOWAIT  ;
                          "L E Y E N D O  FA/BO... Presionar ESC para Salir"+ ;
                          CHR(13)+"Hora Inicial de Lectura: "+vhOr
                     SET ESCAPE ON
                     ON ESCAPE STORE 9000 TO MKEY
                     DO CASE
                          CASE voPc=1
                               STORE 0 TO tbA1, tiG1, tbA2, tiG2, tbA3,  ;
                                     tiG3, tvAn, tiSc, toTr, ttOt
                               DO prC_2420a WITH 1
                               IF vaL2=1
                                    DO prC_2420a WITH 2
                               ENDIF
                               IF vaL3=1
                                    DO prC_2420a WITH 3
                               ENDIF
                               IF vaL4=1
                                    DO prC_2420a WITH 4
                               ENDIF
                               IF vaL5=1
                                    DO prC_2420a WITH 5
                               ENDIF
                               SELECT teMporal
                               REPLACE seP1 WITH "|" ALL
                               REPLACE seP2 WITH "|" ALL
                               REPLACE seP3 WITH "|" ALL
                               REPLACE seP4 WITH "|" ALL
                               REPLACE seP5 WITH "|" ALL
                               REPLACE seP6 WITH "|" ALL
                               REPLACE seP7 WITH "|" ALL
                               REPLACE seP8 WITH "|" ALL
                               REPLACE seP9 WITH "|" ALL
                               REPLACE seP10 WITH "|" ALL
                               REPLACE seP11 WITH "|" ALL
                               REPLACE seP12 WITH "|" ALL
                               REPLACE seP13 WITH "|" ALL
                               REPLACE seP14 WITH "|" ALL
                               REPLACE seP15 WITH "|" ALL
                               REPLACE seP16 WITH "|" ALL
                               REPLACE seP17 WITH "|" ALL
                               REPLACE seP18 WITH "|" ALL
                               REPLACE seP19 WITH "|" ALL
                               REPLACE seP20 WITH "|" ALL
                               REPLACE seP21 WITH "|" ALL
                               REPLACE seP22 WITH "|" ALL
                               REPLACE seP23 WITH "|" ALL
                               REPLACE seP24 WITH "|" ALL
                               REPLACE seP25 WITH "|" ALL
                               REPLACE seP26 WITH "|" ALL
                               REPLACE seP27 WITH "|" ALL
                               REPLACE seP28 WITH "|" ALL
                               REPLACE seP29 WITH "|" ALL
                               REPLACE seP30 WITH "|" ALL
                               REPLACE seP31 WITH "|" ALL
                               REPLACE seP32 WITH "|" ALL
                               REPLACE seP33 WITH "|" ALL
                               REPLACE seP34 WITH "|" ALL
                               REPLACE seP35 WITH "|" ALL
                               REPLACE seP36 WITH "|" ALL
                               REPLACE seP37 WITH "|" ALL
                               REPLACE seP38 WITH "|" ALL
                               REPLACE seP39 WITH "|" ALL
                               REPLACE seP40 WITH "|" ALL
                               REPLACE seP41 WITH "|" ALL
                               REPLACE seP42 WITH "|" ALL
                               SUM f9701ba1 TO tbA1 ALL
                               SUM f9701ig1 TO tiG1 ALL
                               SUM f9701ba2 TO tbA2 ALL
                               SUM f9701ig2 TO tiG2 ALL
                               SUM f9701ba3 TO tbA3 ALL
                               SUM f9701ig3 TO tiG3 ALL
                               SUM f9701van TO tvAn ALL
                               SUM f9701isc TO tiSc ALL
                               SUM f9701otr TO toTr ALL
                               SUM f9701tot TO ttOt ALL
                               WAIT WINDOW NOWAIT  ;
                                    "G R A B A N D O  C U O..."+vhOr
                               DO cuO_2420a
                          CASE voPc=2
                          CASE voPc=3
                          CASE voPc=4
                     ENDCASE
                     ON ESCAPE
                     SET ESCAPE OFF
                     WAIT WINDOW NOWAIT "Hora Final de Lectura: "+TIME()
                     = INKEY(0.5)
                     WAIT CLEAR
                     IF mkEy=9000
                          STORE "Proceso Interrumpido..." TO mmSj
                     ELSE
                          SELECT teMporal
                          GOTO TOP
                          IF BOF()
                               STORE "No hay datos en este rango de Fecha..."  ;
                                     TO mmSj
                          ENDIF
                     ENDIF
           ENDCASE
 ENDCASE
 IF LEN(ALLTRIM(mmSj))<>0
      DO poNmsj
      STORE 99 TO mkEy
 ENDIF
ENDPROC
*
PROCEDURE PrC_2420a
 PARAMETER prEg
 DO CASE
      CASE prEg=1
           SELECT caB_cpra
      CASE prEg=2
           SELECT caB_cpra2
      CASE prEg=3
           SELECT caB_cpra3
      CASE prEg=4
           SELECT caB_cpra4
      CASE prEg=5
           SELECT caB_cpra5
 ENDCASE
 SET DELETED OFF
 GOTO TOP
 SET DELETED ON
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f2400reg>=dfEm .AND. f2400reg<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f2400td1="  " .OR. f2400est$"89" .OR. f2400tdo="PR"
           SKIP
           LOOP
      ENDIF
      IF (f2400td1="NC" .OR. f2400td1="ND") .AND. LEN(ALLTRIM(f2400cm1))=0
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+ ;
                 " No tiene referencia..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      IF UPPER(ALLTRIM(f2400sr1))+"*"<>ALLTRIM(f2400sr1)+"*"
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+" Error en Serie..."  ;
                 TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      IF UPPER(ALLTRIM(f2400fac))+"*"<>ALLTRIM(f2400fac)+"*"
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+ ;
                 " Error en Numero de Documento..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      IF LEN(ALLTRIM(f2400sr1))=0
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+ ;
                 " Error en Serie de Documento..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      IF LEN(ALLTRIM(f2400fac))=0
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+ ;
                 " Error en Numero de Documento..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      IF (f2400td1="NC" .OR. f2400td1="ND") .AND. LEN(ALLTRIM(f2400cm2))=0
           STORE f2400td1+":"+f2400sr1+"-"+f2400fac+ ;
                 " No tiene Fecha de Referencia..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"("+f2400tdo+":"+f2400ser+"-"+ ;
                 f2400doc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      DO CASE
           CASE LEN(ALLTRIM(f2400ruc))<>0
                @ 1, 1 SAY "Grabando TDI en Factura "+f2400ser+"-"+ ;
                  f2400doc FONT "Arial", 8 STYLE "NQ" SIZE 1, 40
                REPLACE f2400tdi WITH "6"
           CASE f2400est$"89"
                @ 1, 1 SAY "Grabando TDI en: "+ptDo+":"+psEr+"-"+pdOc  ;
                  FONT "Arial", 8 STYLE "NQ" SIZE 1, 40
                IF LEN(ALLTRIM(f2400tdi))=0
                     REPLACE f2400tdi WITH " "
                ENDIF
           CASE f2400td1="BO" .OR. f2400td1="BE" .OR. f2400td1="BC" .OR.  ;
                f2400td1="TB" .OR. (f2400td1="TK" .AND.  ;
                LEN(ALLTRIM(f2400ruc))=0)
                @ 1, 1 SAY "Grabando TDI en Boleta "+psEr+"-"+pdOc FONT  ;
                  "Arial", 8 STYLE "NQ" SIZE 1, 40
                IF LEN(ALLTRIM(f2400ruc))<>0 .AND. SUBSTR(f2400ruc, 1, 1)= ;
                   "1" .AND. f2400tdi$" 1"
                     REPLACE f2400ruc WITH " "
                ENDIF
                IF f2400tdi=" "
                     REPLACE f2400tdi WITH "1"
                ENDIF
      ENDCASE
      STORE f2400ser TO vsEr
      STORE f2400doc TO vdOc
      STORE f2400fem TO vfEm
      STORE f2400td1 TO vtD1
      SELECT caMbio
      SEEK vfEm
      IF EOF()
           STORE "Tipo de Cambio del "+DTOC(vfEm)+" no registrado..." TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+"(CO:"+vsEr+"-"+vdOc+")" TO mmSj
           STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                 "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
           STORE 99 TO mkEy
           WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
           = INKEY(5)
           WAIT CLEAR
           EXIT
      ENDIF
      STORE f9111tc1 TO vtCa
      SELECT tiPo_doc
      SEEK vtD1
      IF  .NOT. EOF()
           STORE f9311td1 TO ctDo
      ELSE
           STORE "00" TO ctDo
      ENDIF
      DO CASE
           CASE prEg=1
                SELECT caB_cpra
           CASE prEg=2
                SELECT caB_cpra2
           CASE prEg=3
                SELECT caB_cpra3
           CASE prEg=4
                SELECT caB_cpra4
           CASE prEg=5
                SELECT caB_cpra5
      ENDCASE
      STORE f2400reg TO vrEg
      STORE f2400tdo TO vtDo
      STORE f2400ruc TO vrUc
      STORE f2400nom TO vnOm
      STORE f2400tdi TO vtDi
      STORE f2400sr1 TO vsR1
      STORE f2400fac TO vfAc
      STORE f2400pig TO vpIg
      STORE f2400mon TO vmOn
      STORE f2400per TO vpEr
      IF vpIg=0
           STORE 0 TO vnEt
           STORE 0 TO viGv
           STORE f2400tot TO vtOt
           STORE f2400net TO viNa
      ELSE
           STORE f2400net TO vnEt
           STORE f2400igv TO viGv
           STORE f2400tot TO vtOt
           STORE 0 TO viNa
      ENDIF
      DO CASE
           CASE ctDo="05" .OR. ctDo="55" .OR. ctDo="56"
                STORE SUBSTR(vfAc, 1, 11) TO vfAc
           CASE ctDo="11"
                STORE SUBSTR(vfAc, 1, 15) TO vfAc
           CASE (ctDo>="12" .AND. ctDo<="21") .OR. (ctDo>="26" .AND. ctDo<= ;
                "32") .OR. (ctDo>="37" .AND. ctDo<="45") .OR. (ctDo>="87"  ;
                .AND. ctDo<="88") .OR. ctDo="00" .OR. ctDo="24" .OR. ctDo="49"
                STORE SUBSTR(vfAc, 1, 20) TO vfAc
           CASE ctDo="23" .OR. ctDo="25" .OR. ctDo="34" .OR. ctDo="35"  ;
                .OR. ctDo="48"
                STORE SUBSTR(vfAc, 4, 7) TO vfAc
           OTHERWISE
                STORE SUBSTR(vfAc, 3, 8) TO vfAc
      ENDCASE
      IF ctDo="14"
           STORE f2400fem+f2400dia TO vfVe
           SELECT caMbio
           SEEK vfVe
           IF EOF()
                STORE "Tipo de Cambio de Fecha de Vencimiento "+ ;
                      DTOC(vfVe)+" no registrado..." TO mmSj
                STORE mmSj+"..."+CHR(13)+CHR(13)+"(CO:"+vsEr+"-"+vdOc+")"  ;
                      TO mmSj
                STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                      "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
                STORE 99 TO mkEy
                WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
                = INKEY(5)
                WAIT CLEAR
                EXIT
           ENDIF
           STORE f9111tc1 TO vtCa
           DO CASE
                CASE prEg=1
                     SELECT caB_cpra
                CASE prEg=2
                     SELECT caB_cpra2
                CASE prEg=3
                     SELECT caB_cpra3
                CASE prEg=4
                     SELECT caB_cpra4
                CASE prEg=5
                     SELECT caB_cpra5
           ENDCASE
      ELSE
           STORE f2400fem TO vfVe
      ENDIF
      IF vrEg<>CTOD("  /  /    ") .AND. SUBSTR(DTOC(vfEm), 4, 7)<> ;
         SUBSTR(DTOC(vrEg), 4, 7)
           STORE CTOD("01/"+SUBSTR(DTOC(vrEg), 4, 7)) TO vrEg
      ELSE
           STORE vfEm TO vrEg
      ENDIF
      IF f2400td1="NC" .OR. f2400td1="ND"
           STORE SUBSTR(f2400cm1, 1, 02) TO vtD2
           STORE SUBSTR(f2400cm1, 4, 04) TO vsR2
           STORE SUBSTR(f2400cm1, 9, 10) TO vdO2
           STORE SUBSTR(f2400cm2, 1, 10) TO vfE2
           STORE SUBSTR(vdO2, 3, 8) TO vdO2
           SELECT tiPo_doc
           SEEK vtD2
           IF  .NOT. EOF()
                STORE f9311td1 TO vtD2
           ELSE
                STORE "00" TO vtD2
           ENDIF
           SELECT caMbio
           SEEK CTOD(vfE2)
           IF EOF()
                STORE "Tipo de Cambio de Documento Relacionado en NC "+ ;
                      vfE2+" no registrado..." TO mmSj
                STORE mmSj+"..."+CHR(13)+CHR(13)+"(CO:"+vsEr+"-"+vdOc+")"  ;
                      TO mmSj
                STORE mmSj+"..."+CHR(13)+CHR(13)+ ;
                      "PRESIONAR UNA TECLA PARA CONTINUAR..." TO mmSj
                STORE 99 TO mkEy
                WAIT WINDOW NOCLEAR ALLTRIM(mmSj)
                = INKEY(5)
                WAIT CLEAR
                EXIT
           ENDIF
           STORE f9111tc1 TO vtCa
      ELSE
           STORE "00" TO vtD2
           STORE "-" TO vsR2, vdO2
           STORE "01/01/0001" TO vfE2
      ENDIF
      IF vmOn=2
           STORE vtOt*vtCa TO vtOt
           IF vpIg=0
                STORE 0 TO vnEt, viGv
                STORE viNa*vtCa TO viNa
           ELSE
                STORE ROUND(vtOt/(1+(vpIg/100)), 2) TO vnEt
                STORE vtOt-vnEt TO viGv
           ENDIF
      ENDIF
      IF ctDo="07"
           STORE viNa*-1 TO viNa
           STORE vnEt*-1 TO vnEt
           STORE viGv*-1 TO viGv
           STORE vtOt*-1 TO vtOt
           STORE vpEr*-1 TO vpEr
      ENDIF
      IF LEN(ALLTRIM(vrUc))=0
           STORE "-" TO vrUc
      ELSE
           STORE vrUc TO vrUc
      ENDIF
      SELECT tmP_doc
      APPEND BLANK
      REPLACE ftM2tdo WITH vtDo
      REPLACE ftM2ser WITH vsEr
      REPLACE ftM2doc WITH vdOc
      REPLACE ftM2tcp WITH ctDo
      REPLACE ftM2scp WITH ALLTRIM(UPPER(vsR1))
      REPLACE ftM2ncp WITH vfAc
      REPLACE ftM2fem WITH DTOC(vfEm)
      REPLACE ftM2fve WITH DTOC(vfVe)
      REPLACE ftM2ruc WITH vrUc
      REPLACE ftM2net WITH vnEt
      REPLACE ftM2ina WITH viNa
      REPLACE ftM2igv WITH viGv
      REPLACE ftM2tot WITH vtOt
      SELECT teMporal
      SEEK ALLTRIM(vrUc)+"*"+ctDo+ALLTRIM(vsR1)+"*"+ALLTRIM(vfAc)+"*"
      IF EOF()
           APPEND BLANK
           REPLACE f9701per WITH daNo+dmEs+"00"
           REPLACE f9701reg WITH " "
           REPLACE f9701fem WITH DTOC(vfEm)
           REPLACE f9701fve WITH DTOC(vfVe)
           REPLACE f9701tcp WITH ctDo
           REPLACE f9701scp WITH ALLTRIM(UPPER(vsR1))
           REPLACE f9701adu WITH " "
           REPLACE f9701ncp WITH vfAc
           REPLACE f9701tdi WITH vtDi
           REPLACE f9701ruc WITH vrUc
           REPLACE f9701nom WITH vnOm
           REPLACE f9701ba1 WITH 0
           REPLACE f9701ig1 WITH 0
           REPLACE f9701ba2 WITH 0
           REPLACE f9701ig2 WITH 0
           REPLACE f9701ba3 WITH 0
           REPLACE f9701ig3 WITH 0
           REPLACE f9701van WITH 0
           REPLACE f9701isc WITH 0
           REPLACE f9701otr WITH 0
           REPLACE f9701tot WITH 0
           REPLACE f9701tca WITH vtCa
           REPLACE f9701fe2 WITH vfE2
           REPLACE f9701tc2 WITH vtD2
           REPLACE f9701sr2 WITH vsR2
           REPLACE f9701do2 WITH vdO2
           REPLACE f9701fde WITH "01/01/0001"
           REPLACE f9701nde WITH "0"
           REPLACE f9701mar WITH " "
           DO CASE
                CASE SUBSTR(DTOC(vrEg), 7, 4)=SUBSTR(DTOC(vfEm), 7, 4)  ;
                     .AND. SUBSTR(DTOC(vrEg), 4, 2)=SUBSTR(DTOC(vfEm), 4, 2)
                     REPLACE f9701est WITH "1"
                CASE (vrEg-vfEm)/30<=12
                     REPLACE f9701est WITH "6"
                OTHERWISE
                     REPLACE f9701est WITH "7"
           ENDCASE
      ENDIF
      IF vpIg=0
           REPLACE f9701ba2 WITH f9701ba2+vtOt
      ELSE
           REPLACE f9701ba1 WITH f9701ba1+vnEt
           REPLACE f9701ig1 WITH f9701ig1+viGv
      ENDIF
      REPLACE f9701otr WITH f9701otr+vpEr
      REPLACE f9701tot WITH f9701ba1+f9701ig1+f9701ba2+f9701ig2+f9701ba3+ ;
              f9701ig3+f9701isc+f9701otr
      DO CASE
           CASE prEg=1
                SELECT caB_cpra
           CASE prEg=2
                SELECT caB_cpra2
           CASE prEg=3
                SELECT caB_cpra3
           CASE prEg=4
                SELECT caB_cpra4
           CASE prEg=5
                SELECT caB_cpra5
      ENDCASE
      SKIP
 ENDDO
 DO CASE
      CASE prEg=1
           SELECT caB_cpra
      CASE prEg=2
           SELECT caB_cpra2
      CASE prEg=3
           SELECT caB_cpra3
      CASE prEg=4
           SELECT caB_cpra4
      CASE prEg=5
           SELECT caB_cpra5
 ENDCASE
 SET DELETED OFF
 GOTO TOP
 SET DELETED ON
 SET NEAR ON
 SEEK daNo+dmEs+ddIa
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. f2400reg>=dfEm .AND. f2400reg<=hfEm
      IF mkEy=9000
           RETURN
      ENDIF
      IF f2400td1="  " .OR. f2400est$"89" .OR. f2400tdo<>"PR" .OR.  ;
         DTOC(f2400fem)<>ALLTRIM(f2400cm2)
           SKIP
           LOOP
      ENDIF
      STORE f2400tot TO vtOt
      STORE f2400ruc TO vrUc
      STORE SUBSTR(f2400cm1, 1, 02) TO vtD1
      STORE SUBSTR(f2400cm1, 4, 04) TO vsR1
      STORE SUBSTR(f2400cm1, 9, 10) TO vfAc
      SELECT tiPo_doc
      SEEK vtD1
      IF  .NOT. EOF()
           STORE f9311td1 TO ctDo
      ELSE
           STORE "00" TO ctDo
      ENDIF
      SELECT teMporal
      SEEK ALLTRIM(vrUc)+"*"+ctDo+ALLTRIM(vsR1)+"*"+ALLTRIM(vfAc)+"*"
      IF  .NOT. EOF()
           REPLACE f9701van WITH f9701van+vtOt
      ENDIF
      DO CASE
           CASE prEg=1
                SELECT caB_cpra
           CASE prEg=2
                SELECT caB_cpra2
           CASE prEg=3
                SELECT caB_cpra3
           CASE prEg=4
                SELECT caB_cpra4
           CASE prEg=5
                SELECT caB_cpra5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE Cuo_2420a
 PRIVATE pnUm, psUb, pfEm, prEg, pcUo, ptDo, psEr, pdOc, paLt, prUc
 STORE "04" TO psUb
 STORE 0 TO pnUm
 IF mcIa="MV"
      STORE "02" TO psUb
 ENDIF
 SELECT teMporal
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE pnUm+1 TO pnUm
      STORE CTOD(f9701fem) TO pfEm
      STORE f9701tcp TO ptDo
      STORE f9701scp TO psEr
      STORE f9701ncp TO pdOc
      STORE f9701ruc TO prUc
      IF pnUm>9999
           STORE 1 TO pnUm
           STORE STRTRAN(STR(VAL(ALLTRIM(psUb))+1, 2, 0), " ", "0") TO psUb
      ENDIF
      STORE ALLTRIM(psUb)+STRTRAN(STR(pnUm, 4, 0), " ", "0") TO prEg
      DO CASE
           CASE mcIa="MV"
                STORE psUb+STRTRAN(STR(pnUm, 6, 0), " ", "0") TO pcUo
           CASE pnUm=1 .AND. SUBSTR(DTOC(pfEm), 4, 2)="01"
                STORE "A"+STRTRAN(STR(pnUm, 6, 0), " ", "0") TO pcUo
           OTHERWISE
                STORE "M"+STRTRAN(STR(pnUm, 6, 0), " ", "0") TO pcUo
      ENDCASE
      REPLACE f9701reg WITH prEg
      REPLACE f9701asi WITH pcUo
      SELECT tmP_doc
      SET FILTER TO ALLTRIM(ftM2ruc)+"*"+ALLTRIM(ftM2tcp)+"*"+ALLTRIM(ftM2scp)+"*"+ALLTRIM(ftM2ncp)+"*"=ALLTRIM(prUc)+"*"+ALLTRIM(ptDo)+"*"+ALLTRIM(psEr)+"*"+ALLTRIM(pdOc)+"*"
      GOTO TOP
      STORE ftM2tdo TO ptDo
      STORE ftM2ser TO psEr
      STORE ftM2doc TO pdOc
      STORE 0 TO paLt
      @ 1, 1 SAY "Grabando CUO: "+ptDo+":"+psEr+"-"+pdOc STYLE "BQ" SIZE 1, 20
      SELECT caB_cpra
      SEEK ptDo+psEr+pdOc
      IF  .NOT. EOF()
           STORE 1 TO paLt
      ENDIF
      IF vaL2=1 .AND. paLt=0
           SELECT caB_cpra2
           SEEK ptDo+psEr+pdOc
           IF  .NOT. EOF()
                STORE 2 TO paLt
           ENDIF
      ENDIF
      IF vaL3=1 .AND. paLt=0
           SELECT caB_cpra3
           SEEK ptDo+psEr+pdOc
           IF  .NOT. EOF()
                STORE 3 TO paLt
           ENDIF
      ENDIF
      IF vaL4=1 .AND. paLt=0
           SELECT caB_cpra4
           SEEK ptDo+psEr+pdOc
           IF  .NOT. EOF()
                STORE 4 TO paLt
           ENDIF
      ENDIF
      IF vaL5=1 .AND. paLt=0
           SELECT caB_cpra5
           SEEK ptDo+psEr+pdOc
           IF  .NOT. EOF()
                STORE 5 TO paLt
           ENDIF
      ENDIF
      IF  .NOT. EOF()
           REPLACE f2400cuo WITH pcUo
      ENDIF
      SELECT tmP_doc
      SET FILTER TO
      SELECT teMporal
      SKIP
 ENDDO
 RELEASE pnUm, psUb, pfEm, prEg, pcUo, ptDo, psEr, pdOc, paLt, prUc
ENDPROC
*
PROCEDURE Clp_2420a
 = INKEY(0.01)
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Enter TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.80
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfI1-0.35 .AND. mfIl<=vfI1+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>1
           STORE 1 TO voPc
           DO opC_2420a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI2-0.35 .AND. mfIl<=vfI2+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>2
           STORE 2 TO voPc
           DO opC_2420a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI3-0.35 .AND. mfIl<=vfI3+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>3
           STORE 3 TO voPc
           DO opC_2420a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI4-0.35 .AND. mfIl<=vfI4+1.536 .AND. mcCc>=vcO1+2  ;
           .AND. mcCc<=vcO1+51 .AND. voPc<>4
           STORE 4 TO voPc
           DO opC_2420a
           IF mkEy=k_Esc
                RETURN
           ENDIF
      CASE mfIl>=vfI1+2.428 .AND. mfIl<=vfI1+4.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>1
           STORE 01 TO viTe
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+4.428 .AND. mfIl<=vfI1+6.000 .AND. mcCc>=vcO1+70.8  ;
           .AND. mcCc<=vcO1+100.2 .AND. viTe<>2
           IF viTe=1
                DO veR_2420a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 2 TO viTe
           ENDIF
           STORE 99 TO mkEy
      CASE mfIl>=vfI1+6.428 .AND. mfIl<=vfI1+8.000 .AND. voPc=2 .AND.  ;
           mcCc>=vcO1+70.8 .AND. mcCc<=vcO1+100.2 .AND. viTe<>3
           IF viTe=1
                DO veR_2420a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF viTe<3
                STORE 2 TO viTe
                DO veR_2420a
                IF mkEy=k_Esc
                     RETURN
                ENDIF
           ENDIF
           IF mkEy<>99
                STORE 3 TO viTe
           ENDIF
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
ENDPROC
*
PROCEDURE Hlp_2420a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0.2 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Este Programa tiene varias opciones para ordenar la información de Com-"
 @ pfIl+01, 02 SAY "pras por pantalla o impresora."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 20 SAY ":" STYLE "BT"
 @ pfIl+06, 20 SAY ":" STYLE "BT"
 @ pfIl+07, 20 SAY ":" STYLE "BT"
 @ pfIl+08, 20 SAY ":" STYLE "BT"
 @ pfIl+10, 20 SAY ":" STYLE "BT"
 @ pfIl+11, 20 SAY ":" STYLE "BT"
 @ pfIl+12, 20 SAY ":" STYLE "BT"
 @ pfIl+05, 02 SAY "ESC" STYLE "BT"
 @ pfIl+06, 02 SAY "F10" STYLE "BT"
 @ pfIl+07, 02 SAY "F1" STYLE "BT"
 @ pfIl+08, 02 SAY "ENTER, CTRL ->," STYLE "BT"
 @ pfIl+09, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+10, 02 SAY "TAB" STYLE "BT"
 @ pfIl+11, 02 SAY "FLECHA ARRIBA" STYLE "BT"
 @ pfIl+12, 02 SAY "ALT S" STYLE "BT"
 @ pfIl+05, 22 SAY "Regresar a la pantalla anterior"
 @ pfIl+06, 22 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 22 SAY "Ayuda del Programa"
 @ pfIl+08, 22 SAY "Ir al siguiente campo, al final ingresa a la Consulta"
 @ pfIl+10, 22 SAY "Ir a la Consulta"
 @ pfIl+11, 22 SAY "Campo anterior"
 @ pfIl+12, 22 SAY "Fijar las Cuentas Contables"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE vsW1, viTe, vfI1, vfI2, vfI3, vfI4, vcO1, ifIl, ufIl, vfIl, ffIl,  ;
         ifFs, ufFs
 RELEASE vfFs, ffFs, vcL1, vcL2, voPc, coPc, vdAo, cdAo, dfEm, hfEm, vfEm,  ;
         ifEm, ufEm
 RELEASE vfE2, cdFe, chFe, vtCp, itCp, utCp, vsCp, isCp, usCp, vnCp, inCp,  ;
         unCp, vrUc
 RELEASE irUc, urUc, vnUf, ddIa, dmEs, daNo, vhOr, vnUm, vaL2, vaL3, vaL4,  ;
         vaL5, vsEl
 RELEASE vcOd, vpT2, vpT3, vpT4, vpT5, vtCa, vtD1, vtD2, vtDo, ctDo, vtDi,  ;
         vsEr, vdOc
 RELEASE vdO2, vsR1, vsR2, vfAc, vnOm, vnO1, vnO2, vnO3, vnO4, vnO5, vfVe,  ;
         vpIg, vmOn
 RELEASE vnEt, viGv, vtOt, ttOt, vrEg, vpLe, vtB1, tbA1, tiG1, tbA2, tiG2,  ;
         tbA3, tiG3
 RELEASE tvAn, tiSc, toTr, vpEr, vdEb, vhAb, vhA2, viNa
 RELEASE vpAn_11, vpAn_99
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 RELEASE ntM1, ntM2
ENDPROC
*
