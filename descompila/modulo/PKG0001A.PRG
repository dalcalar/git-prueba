 SET CENTURY ON
 PUBLIC ntM1, ntM2, ntM3, ntM4, ntM5, afIl, x
 STORE 01 TO meRr, wsW0
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE "0002" TO ntM3
 STORE "0003" TO ntM4
 STORE "0004" TO ntM5
 DIMENSION afIl[28, 4]
 STORE 1 TO x
 afIl[x, 1] = "DOCUM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCTA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 18
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANOMES"
 afIl[x, 2] = "C"
 afIl[x, 3] = 6
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FSUB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCOMPR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FREGIS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANEXO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCODCLI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTIPDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 21
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FEMISION"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTDOREF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMREF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 21
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FIGV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 18
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTASAIGV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTOTAL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 18
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCONV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTPOCAM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOSA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOMOV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANULAD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FDEBHAB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FRUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNOMBRE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCENCOS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FVENCIM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FFECDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FEXPORT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON doCum+fcTa TAG doCum
 CLOSE INDEXES
 CLOSE DATABASES
 DIMENSION afIl[1, 4]
 STORE 1 TO x
 afIl[x, 1] = "FFRA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 254
 afIl[x, 4] = 0
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 CLOSE DATABASES
 DIMENSION afIl[14, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCOD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FRUC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 100
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FDIR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 100
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 15
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTPE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FAPP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FAPM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNO1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNO2"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNAC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FSEX"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM3+meXt TO mdBf
 DO WHILE .T.
      ntM3 = STRTRAN(STR(VAL(ntM3)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM3+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM3="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftIp+fcOd TAG fcOd
 CLOSE INDEXES
 CLOSE DATABASES
 DIMENSION afIl[37, 4]
 STORE 1 TO x
 afIl[x, 1] = "DOCUM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCTA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 18
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANOMES"
 afIl[x, 2] = "C"
 afIl[x, 3] = 6
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FSUB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCOMPR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FEMISION"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANEXO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCODPRV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTIPDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 21
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FVENCIM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FIGV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTASAIGV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTOTAL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCONV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FREGIS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTPOCAM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOSA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTPODES"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FPORCPR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FVALCIF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTDOREF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMREF"
 afIl[x, 2] = "C"
 afIl[x, 3] = 21
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCENCOS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FAFEDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FFECDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FFECDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOMOV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANULAD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FIGVAPL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCODDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 5
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FIMPORT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FDEBHAB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTASDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FIMPDET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FEXPORT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM4+meXt TO mdBf
 DO WHILE .T.
      ntM4 = STRTRAN(STR(VAL(ntM4)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM4+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM4="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON doCum+fcTa TAG doCum
 CLOSE INDEXES
 CLOSE DATABASES
 DIMENSION afIl[21, 4]
 STORE 1 TO x
 afIl[x, 1] = "FCTA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 18
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANOMES"
 afIl[x, 2] = "C"
 afIl[x, 3] = 6
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FSUB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCOMPR"
 afIl[x, 2] = "C"
 afIl[x, 3] = 4
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FEMISION"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANEXO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCODANX"
 afIl[x, 2] = "C"
 afIl[x, 3] = 11
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTIPDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FNUMDOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 21
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FVENCIM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FMON"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTOTAL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 13
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCONV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FREGIS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTPOCAM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOSA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FCENCOS"
 afIl[x, 2] = "C"
 afIl[x, 3] = 10
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FGLOMOV"
 afIl[x, 2] = "C"
 afIl[x, 3] = 60
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FANULAD"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FDEBHAB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FMEDPAG"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE "TM01"+ntM5+meXt TO mdBf
 DO WHILE .T.
      ntM5 = STRTRAN(STR(VAL(ntM5)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM5+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM5="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 CLOSE DATABASES
 RELEASE afIl, x
 STORE 99 TO mkEy
 STORE 01 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "1301", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1301DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "2400", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Cpras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2400REG
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "2401", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Cpras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2401DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3510", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3510NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3511", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3511FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3530", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3530NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3531", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3531FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3610", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Notas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3610FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "3611", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Notas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3611DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "9111", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cambio
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9111FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "9991", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive NoUpdate Alias Tiendas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9991COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 DO abR_0000a IN PUX0000A WITH "9311", "U"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive NoUpdate Alias Tipo_Doc
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F9311TDO
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_Vtas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_Fra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 STORE "TM01"+ntM3+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_Anx
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FCOD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 STORE "TM01"+ntM4+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_Cpras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE muLt+1 TO muLt
 DO seL_0000a WITH muLt
 STORE "TM01"+ntM5+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 20 TO muLt
 PUBLIC vtAb, vaNo, vmEs, vcOd, vpT2, vpT3, vpT4, vpT5, vaL2, vaL3, vaL4,  ;
        vaL5, vdBf
 PUBLIC urEc, vnO2, vnO3, vnO4, vnO5
 PUBLIC vpAn_99
 STORE "06" TO vmEs
 STORE "2018" TO vaNo
 STORE 24 TO muFi
 STORE 86 TO muCo
 STORE 00 TO vaL2, vaL3, vaL4, vaL5
 SELECT tiEndas
 GOTO TOP
 DO WHILE  .NOT. EOF()
      STORE f9991cod TO vcOd
      DO CASE
           CASE vcOd="01"
                SKIP
                LOOP
           CASE vcOd="02"
                SKIP
                LOOP
           CASE vcOd="03"
                STORE f9991pth TO vpT2
                STORE f9991nom TO vnO2
           CASE vcOd="04"
                STORE f9991pth TO vpT3
                STORE f9991nom TO vnO3
           CASE vcOd="05"
                STORE f9991pth TO vpT4
                STORE f9991nom TO vnO4
           CASE vcOd="06"
                STORE f9991pth TO vpT5
                STORE f9991nom TO vnO5
           OTHERWISE
                EXIT
      ENDCASE
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO - "+ALLTRIM(vnO2) STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FV011300.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Fact2
                STORE 1 TO vaL2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO - "+ALLTRIM(vnO3) STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FV011300.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Fact3
                STORE 1 TO vaL3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO - "+ALLTRIM(vnO4) STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FV011300.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Fact4
                STORE 1 TO vaL4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO - "+ALLTRIM(vnO5) STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FV011300.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Fact5
                STORE 1 TO vaL5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1300FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO DETALLE DE - "+ALLTRIM(vnO2) STYLE  ;
                  "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Fact2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO DETALLE DE - "+ALLTRIM(vnO3) STYLE  ;
                  "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Fact3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO DETALLE DE - "+ALLTRIM(vnO4) STYLE  ;
                  "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Fact4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO DETALLE DE - "+ALLTRIM(vnO5) STYLE  ;
                  "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FV011301.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Fact5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F1301DOC
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO NOTA DE - "+ALLTRIM(vnO2) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Nota2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO NOTA DE - "+ALLTRIM(vnO3) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Nota3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO NOTA DE - "+ALLTRIM(vnO4) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Nota4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO NOTA DE - "+ALLTRIM(vnO5) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013610.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Nota5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3610FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO DETALLE DE NOTA DE - "+ALLTRIM(vnO2)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013611.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Nota2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO DETALLE DE NOTA DE - "+ALLTRIM(vnO3)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013611.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Nota3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO DETALLE DE NOTA DE - "+ALLTRIM(vnO4)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013611.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Nota4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO DETALLE DE NOTA DE - "+ALLTRIM(vnO5)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013611.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Nota5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3611DOC
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO COMPRA - "+ALLTRIM(vnO2) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Cpra2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO COMPRA - "+ALLTRIM(vnO3) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Cpra3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO COMPRA - "+ALLTRIM(vnO4) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Cpra4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO COMPRA - "+ALLTRIM(vnO5) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FA012400.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Cpra5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F2400REG
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO DETALLE DE COMPRA - "+ALLTRIM(vnO2)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FA012401.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Cpra2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO DETALLE DE COMPRA - "+ALLTRIM(vnO3)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FA012401.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Cpra3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO DETALLE DE COMPRA - "+ALLTRIM(vnO4)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FA012401.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Cpra4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO DETALLE DE COMPRA - "+ALLTRIM(vnO5)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FA012401.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Cpra5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F2401DOC
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO CAJA - "+ALLTRIM(vnO2) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013510.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Caja2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO CAJA - "+ALLTRIM(vnO3) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013510.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Caja3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO CAJA - "+ALLTRIM(vnO4) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013510.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Caja4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO CAJA - "+ALLTRIM(vnO5) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013510.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Caja5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3510NUM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO DETALLE DE CAJA - "+ALLTRIM(vnO2)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013511.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Caja2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO DETALLE DE CAJA - "+ALLTRIM(vnO3)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013511.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Caja3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO DETALLE DE CAJA - "+ALLTRIM(vnO4)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013511.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Caja4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO DETALLE DE CAJA - "+ALLTRIM(vnO5)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013511.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Caja5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3511FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO BANCOS - "+ALLTRIM(vnO2) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013530.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Bancos2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO BANCOS - "+ALLTRIM(vnO3) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013530.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Bancos3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO BANCOS - "+ALLTRIM(vnO4) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013530.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Bancos4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO BANCOS - "+ALLTRIM(vnO5) STYLE "BQ"  ;
                  SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013530.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Cab_Bancos5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3530NUM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      DO seL_0000a WITH muLt
      DO CASE
           CASE vcOd="03"
                @ 1, 1 SAY "ABRIENDO DETALLE DE BANCOS - "+ALLTRIM(vnO2)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT2)+"FC013531.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL2
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO2)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Bancos2
           CASE vcOd="04"
                @ 1, 1 SAY "ABRIENDO DETALLE DE BANCOS - "+ALLTRIM(vnO3)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT3)+"FC013531.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL3
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO3)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Bancos3
           CASE vcOd="05"
                @ 1, 1 SAY "ABRIENDO DETALLE DE BANCOS - "+ALLTRIM(vnO4)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT4)+"FC013531.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL4
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO4)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Bancos4
           CASE vcOd="06"
                @ 1, 1 SAY "ABRIENDO DETALLE DE BANCOS - "+ALLTRIM(vnO5)  ;
                  STYLE "BQ" SIZE 1, 50
                STORE ALLTRIM(vpT5)+"FC013531.DBF" TO mdBf
                DO veR_0000a IN PUX0000A
                IF mkEy=k_Esc
                     STORE 99 TO mkEy
                     STORE 00 TO vaL5
                     WAIT WINDOW NOWAIT "NO SE PUEDE CONECTAR CON "+ ;
                          ALLTRIM(vnO5)
                     mkEy = INKEY(5)
                     WAIT CLEAR
                     SELECT tiEndas
                     SKIP
                     LOOP
                ENDIF
                Use &mDBF Exclusive Alias Det_Bancos5
      ENDCASE
      IF mkEy=k_Esc
           EXIT
      ENDIF
      SET ORDER TO F3531FEM
      IF mkEy=k_Esc
           EXIT
      ENDIF
      STORE muLt+1 TO muLt
      SELECT tiEndas
      SKIP
 ENDDO
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 WAIT CLEAR
 SET READBORDER ON
 DO p00_0001a WITH "0"
 DO meS_0001a
 ON SELECTION BAR 1 OF vtAb DO ANX_0001A
 ON SELECTION BAR 2 OF vtAb DO VTA_0001A
 ON SELECTION BAR 3 OF vtAb DO CPR_0001A
 ON SELECTION BAR 4 OF vtAb DO CAJ_0001A
 ACTIVATE POPUP vtAb
 RELEASE POPUPS vtAb
 STORE 99 TO mkEy
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE Mes_0001a
 @mFI0+01.5,mCO0+40 Get vMES Font "&mLetRom",11 Style "NQ" Size 1,2.7 Color ,&mColBlN
 SET CURSOR ON
 READ
 SET CURSOR OFF
ENDPROC
*
PROCEDURE P00_0001a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 STORE (mwFi-muFi)/2 TO mfI0
 STORE (mwCo-muCo)/2 TO mcO0
 Define Popup vTAB from mFI0+1,mCO0+52 to mFI0+10,mCO0+mUCO-5 Scroll Font "&mLetAri",mTAM-1 Color Scheme 3
 DEFINE BAR 1 OF vtAb PROMPT "   ANEXOS     "
 DEFINE BAR 2 OF vtAb PROMPT "   VENTAS     "
 DEFINE BAR 3 OF vtAb PROMPT "   COMPRAS    "
 DEFINE BAR 4 OF vtAb PROMPT "  CAJA/BANCOS "
 DO tiT_0000a WITH "Interfase StarSoft"
 DO coLbln
 DO cuAdro WITH mfI0, mcO0, mfI0+11, mcO0+muCo
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO cuAdro WITH mfI0+14, mcO0, mfI0+16, mcO0+muCo
 IF mkEy=k_Esc
      RETURN
 ENDIF
 @ mfI0+01.0, mcO0+02 TO mfI0+03.5, mcO0+48
 @mFI0+01.3,mCO0+05 Say "Año:                 Mes:"      Font "&mLetRom",15 Style "BT"
 @mFI0+01.5,mCO0+15 Get vANO                             Font "&mLetRom",11 Style "NQ" Size 1,4.9 Color ,&mColBlN
 @mFI0+01.5,mCO0+40 Get vMES                             Font "&mLetRom",11 Style "NQ" Size 1,2.7 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO coLbln
 @mFI0+07.5,mCO0+01 Say "Escoger de la Tabla adjunta la" Font "&mLetRom",14 Style "BTI"
 @mFI0+09.0,mCO0+01 Say "opción a convertir."            Font "&mLetRom",14 Style "BTI"
ENDPROC
*
PROCEDURE Vta_0001a
 PUBLIC pcOm, ptDo, psEr, pdOc, pfEm, pfVe, pfRe, pmOn, pcLi, pnOm, pnO1,  ;
        ppIg, ppI1
 PUBLIC ppGd, ptOt, peSt, ptOp, ptOs, ptOa, pcOd, ptPp, pnUm, pnEt, piGv,  ;
        piG1, psUb
 PUBLIC paNx, pgLo, pcOn, pcTa, prUc, prU1, pcCo, ptD1, psR1, pdO1, ptD2,  ;
        pdO3, pfE1
 PUBLIC ptGe, ptNe, ptIg, psTo, pnMr, ptMm, pnNn, pdNi, plLl, pfRa, ptTt, ptD3
 STORE "02" TO psUb
 STORE "02" TO paNx
 STORE "VTA" TO pcOn
 STORE "Venta de Mercaderia" TO pgLo
 STORE 0 TO pnUm
 SELECT teMporal_vtas
 SET ORDER TO
 ZAP
 DO vt1_0001a WITH "1"
 IF vaL2=1
      DO vt1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      DO vt1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      DO vt1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      DO vt1_0001a WITH "5"
 ENDIF
 DO nv1_0001a WITH "1"
 IF vaL2=1
      DO nv1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      DO nv1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      DO nv1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      DO nv1_0001a WITH "5"
 ENDIF
 SELECT teMporal_vtas
 SET ORDER TO DOCUM
 GOTO TOP
 STORE SPACE(07) TO pdOc
 STORE 0 TO pnUm
 DO WHILE  .NOT. EOF()
      IF pdOc<>doCum
           STORE doCum TO pdOc
           STORE pnUm+1 TO pnUm
      ENDIF
      REPLACE fcOmpr WITH STRTRAN(STR(pnUm, 4, 0), " ", "0")
      SKIP
 ENDDO
 SELECT teMporal_vtas
 GOTO BOTTOM
 STORE RECNO() TO urEc
 GOTO TOP
 DO coLbln
 DO WHILE  .NOT. EOF()
      @ mfI0+14.6, mcO0+6 SAY "Grabando: "+STR(RECNO(), 6, 0)+" de "+ ;
        STR(urEc, 6, 0) STYLE "BQ" SIZE 1, 50
      STORE "" TO pfRa
      STORE pfRa+ALLTRIM(fcTa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNomes)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fsUb)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOmpr)+"|" TO pfRa
      STORE pfRa+ALLTRIM(frEgis)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNexo)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOdcli)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftIpdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(feMision)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftDoref)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmref)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fiGv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftAsaigv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftOtal)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOnv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftPocam)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLosa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLomov)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNulad)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fdEbhab)+"|" TO pfRa
      STORE pfRa+ALLTRIM(frUc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnOmbre)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcEncos)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fvEncim)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ffEcdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(feXport)+"|" TO pfRa
      SELECT teMporal_fra
      APPEND BLANK
      REPLACE ffRa WITH pfRa
      SELECT teMporal_vtas
      SKIP
 ENDDO
 IF  .NOT. DIRECTORY("PLE")
      MD PLE
 ENDIF
 DO coLbln
 @ mfI0+14.6, mcO0+6 SAY "Pasando Archivo a TXT..." STYLE "BQ" SIZE 1, 50
 STORE "PLE\V_"+vaNo+vmEs+"_StartSoft.txt" TO vdBf
 SELECT teMporal_fra
 GOTO TOP
 Copy to &vDBF SDF
 RELEASE pcOm, ptDo, psEr, pdOc, pfEm, pfVe, pfRe, pmOn, pcLi, pnOm, pnO1,  ;
         ppIg, ppI1
 RELEASE ppGd, ptOt, peSt, ptOp, ptOs, ptOa, pcOd, ptPp, pnUm, pnEt, piGv,  ;
         piG1, psUb
 RELEASE paNx, pgLo, pcOn, pcTa, prUc, prU1, pcCo, ptD1, psR1, pdO1, ptD2,  ;
         pdO3, pfE1
 RELEASE ptGe, ptNe, ptIg, psTo, pnMr, ptMm, pnNn, pdNi, plLl, pfRa, ptTt, ptD3
 DEACTIVATE POPUP vtAb
 RETURN
ENDPROC
*
PROCEDURE Vt1_0001a
 PARAMETER pvTa
 STORE " " TO ptD1, psR1, pdO1, pfE1
 DO CASE
      CASE pvTa="1"
           SELECT caB_fact
      CASE pvTa="2"
           SELECT caB_fact2
      CASE pvTa="3"
           SELECT caB_fact3
      CASE pvTa="4"
           SELECT caB_fact4
      CASE pvTa="5"
           SELECT caB_fact5
 ENDCASE
 DO coLbln
 GOTO TOP
 IF maDm<>1
      mkEy = INKEY(50)
 ENDIF
 SEEK vaNo+vmEs
 IF maDm<>1
      mkEy = INKEY(50)
 ENDIF
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f1300fem), 7, 4)+ ;
    SUBSTR(DTOC(f1300fem), 4, 2)=vaNo+vmEs
      IF f1300tdo<>"FA" .AND. f1300tdo<>"FE" .AND. f1300tdo<>"FC" .AND.  ;
         f1300tdo<>"BO" .AND. f1300tdo<>"BE" .AND. f1300tdo<>"BC"
           SKIP
           IF maDm<>1
                mkEy = INKEY(50)
           ENDIF
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Ventas..."+f1300tdo+":"+ ;
        f1300ser+"-"+f1300doc STYLE "BQ" SIZE 1, 50
      STORE f1300tdo TO ptDo, ptD3
      STORE f1300ser TO psEr
      STORE f1300doc TO pdOc
      STORE f1300fem TO pfEm
      STORE f1300mon TO pmOn
      STORE f1300nom TO pnOm
      STORE f1300dir TO pdIr
      STORE f1300dis TO pdIs
      STORE f1300pig TO ppIg
      STORE f1300pgd TO ppGd
      STORE pfEm+f1300dia TO pfVe
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC"
                STORE f1300ruc TO pcLi
                STORE f1300ruc TO prUc
                STORE " " TO pdNi
           CASE (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC") .AND.  ;
                LEN(ALLTRIM(f1300ele))>7 .AND. VAL(f1300ele)>0 .AND.  ;
                VAL(f1300ele)<99999999
                STORE f1300ele TO pcLi
                STORE f1300ele TO prUc, pdNi
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
                STORE "99999999999" TO pcLi, pdNi
                STORE " " TO prUc
      ENDCASE
      DO caM_0001a
      STORE SUBSTR(pnOm, 1, 50) TO pnOm
      DO CASE
           CASE f1300est="9"
                STORE "1" TO peSt
                STORE 0 TO ptGe, ptNe, ptIg
           OTHERWISE
                STORE "0" TO peSt
                STORE f1300igv TO ptIg
                STORE f1300net TO ptNe
                STORE f1300tot TO ptGe
      ENDCASE
      SELECT tiPo_doc
      SEEK ptDo
      IF  .NOT. EOF()
           STORE f9311td1 TO ptD2
      ELSE
           STORE "00" TO ptD2
      ENDIF
      STORE ptD2+psEr+pdOc TO pdO3
      SELECT caMbio
      SEEK pfEm
      IF  .NOT. EOF()
           STORE f9111tc1 TO ptCa
      ELSE
           STORE 3.30 TO ptCa
      ENDIF
      STORE 0 TO ptOp, ptOs, ptOa
      IF peSt="0"
           DO CASE
                CASE pvTa="1"
                     SELECT deT_fact
                CASE pvTa="2"
                     SELECT deT_fact2
                CASE pvTa="3"
                     SELECT deT_fact3
                CASE pvTa="4"
                     SELECT deT_fact4
                CASE pvTa="5"
                     SELECT deT_fact5
           ENDCASE
           SEEK ptDo+psEr+pdOc
           DO WHILE  .NOT. EOF() .AND. f1301tdo+f1301ser+f1301doc=ptDo+ ;
              psEr+pdOc
                STORE f1301cod TO pcOd
                SELECT prOductos
                SEEK ALLTRIM(pcOd)+"*"
                IF  .NOT. EOF()
                     STORE f2111tpo TO ptPp
                ELSE
                     STORE 1 TO ptPp
                ENDIF
                DO CASE
                     CASE pvTa="1"
                          SELECT deT_fact
                     CASE pvTa="2"
                          SELECT deT_fact2
                     CASE pvTa="3"
                          SELECT deT_fact3
                     CASE pvTa="4"
                          SELECT deT_fact4
                     CASE pvTa="5"
                          SELECT deT_fact5
                ENDCASE
                STORE f1301to2 TO ptTt
                DO CASE
                     CASE ptPp=1
                          STORE ptOp+ptTt TO ptOp
                     CASE ptPp=2
                          STORE ptOs+ptTt TO ptOs
                     CASE ptPp=3
                          STORE ptOa+ptTt TO ptOa
                ENDCASE
                SKIP
                IF maDm<>1
                     mkEy = INKEY(50)
                ENDIF
           ENDDO
           IF ppGd<>0
                DO CASE
                     CASE ptOp>0 .AND. ptOp>ppGd
                          STORE ptOp-ppGd TO ptOp
                     CASE ptOs>0 .AND. ptOs>ppGd
                          STORE ptOs-ppGd TO ptOs
                     CASE ptOa>0 .AND. ptOa>ppGd
                          STORE ptOa-ppGd TO ptOa
                     OTHERWISE
                          IF ptOp>0
                               STORE ppGd-ptOp TO ptOp
                               STORE 0 TO ptOp
                          ENDIF
                          IF ptOs>0 .AND. ptOs>ppGd
                               STORE ptOs-ppGd TO ptOs
                          ELSE
                               STORE ppGd-ptOs TO ptOs
                               STORE 0 TO ptOs
                          ENDIF
                          IF ptOa>0 .AND. ptOa>ppGd
                               STORE ptOa-ppGd TO ptOa
                          ELSE
                               STORE ppGd-ptOa TO ptOa
                               STORE 0 TO ptOa
                          ENDIF
                ENDCASE
           ENDIF
      ENDIF
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC"
                STORE "FT" TO ptDo
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
                STORE "BV" TO ptDo
      ENDCASE
      STORE pnUm+1 TO pnUm
      STORE " " TO pcCo
      STORE 0 TO piGv
      IF ptGe<>0 .OR. peSt="1"
           DO CASE
                CASE pmOn=1
                     STORE "1212111" TO pcTa
                CASE pmOn=2
                     STORE "1212112" TO pcTa
           ENDCASE
           STORE "D" TO ptPc
           STORE prUc TO prU1
           STORE pnOm TO pnO1
           IF peSt="0"
                STORE ptGe/(1+(ppIg/100)) TO pnEt
                STORE ptGe-pnEt TO piGv
                STORE ALLTRIM(STR(piGv, 12, 2)) TO piG1
                STORE ALLTRIM(STR(ptGe, 12, 2)) TO ptOt
           ELSE
                STORE 0 TO pnEt, piGv
                STORE "0.00" TO piG1, ptOt
           ENDIF
           STORE STR(ppIg, 2, 0) TO ppI1
           DO vtG_0001a
           STORE "H" TO ptPc
           STORE ptGe/(1+(ppIg/100)) TO pnEt
           STORE ptGe-pnEt TO piGv
           STORE ALLTRIM(STR(piGv, 12, 2)) TO ptOt
           STORE "4011111" TO pcTa
           STORE " " TO piG1, ppI1, prU1, pnO1
           DO vtG_0001a
      ENDIF
      STORE " " TO piG1, ppI1, prU1, pnO1
      STORE "H" TO ptPc
      DO CASE
           CASE peSt="1"
                STORE 0 TO pnEt, piGv
                STORE ALLTRIM(STR(0, 12, 2)) TO ptOt
                STORE "7011111" TO pcTa
                DO vtG_0001a
           OTHERWISE
                IF ptD3="FC" .AND. pdOc="0000001"
                     @ 1, 1 SAY ptOp PICTURE "999,999.99"
                ENDIF
                STORE ROUND(ptOp/(1+(ppIg/100)), 2) TO ptOp
                STORE ROUND(ptOs/(1+(ppIg/100)), 2) TO ptOs
                STORE ROUND(ptOa/(1+(ppIg/100)), 2) TO ptOa
                STORE ptOp+ptOs+ptOa TO psTo
                DO CASE
                     CASE ROUND(psTo+piGv, 2)>ROUND(ptGe, 2)
                          IF ptOp>0
                               STORE ptOp-ROUND(psTo+piGv-ptGe, 2) TO ptOp
                          ELSE
                               IF ptOs>0
                                    STORE ptOs-ROUND(psTo+piGv-ptGe, 2) TO ptOs
                               ELSE
                                    IF ptOa>0
                                         STORE ptOa-ROUND(psTo+piGv-ptGe,  ;
                                          2) TO ptOa
                                    ENDIF
                               ENDIF
                          ENDIF
                     CASE ROUND(psTo+piGv, 2)<ROUND(ptGe, 2)
                          IF ptOp>0
                               STORE ptOp+ROUND(ptGe-(psTo+piGv), 2) TO ptOp
                          ELSE
                               IF ptOs>0
                                    STORE ptOs+ROUND(ptGe-(psTo+piGv), 2)  ;
                                     TO ptOs
                               ELSE
                                    IF ptOa>0
                                         STORE ptOa+ROUND(ptGe-(psTo+ ;
                                          piGv), 2) TO ptOa
                                    ENDIF
                               ENDIF
                          ENDIF
                ENDCASE
                IF ptOp<>0
                     STORE ALLTRIM(STR(ptOp, 12, 2)) TO ptOt
                     STORE "7011111" TO pcTa
                     DO vtG_0001a
                ENDIF
                IF ptOs<>0
                     STORE ALLTRIM(STR(ptOs, 12, 2)) TO ptOt
                     STORE "7041111" TO pcTa
                     DO vtG_0001a
                ENDIF
                IF ptOa<>0
                     STORE ALLTRIM(STR(ptOa, 12, 2)) TO ptOt
                     STORE "7561" TO pcTa
                     DO vtG_0001a
                ENDIF
      ENDCASE
      DO CASE
           CASE pvTa="1"
                SELECT caB_fact
           CASE pvTa="2"
                SELECT caB_fact2
           CASE pvTa="3"
                SELECT caB_fact3
           CASE pvTa="4"
                SELECT caB_fact4
           CASE pvTa="5"
                SELECT caB_fact5
      ENDCASE
      SKIP
      IF maDm<>1
           mkEy = INKEY(50)
      ENDIF
 ENDDO
ENDPROC
*
PROCEDURE Nv1_0001a
 PARAMETER pvTa
 STORE "Devolucion de Mercaderia" TO pgLo
 DO CASE
      CASE pvTa="1"
           SELECT caB_notas
      CASE pvTa="2"
           SELECT caB_nota2
      CASE pvTa="3"
           SELECT caB_nota3
      CASE pvTa="4"
           SELECT caB_nota4
      CASE pvTa="5"
           SELECT caB_nota5
 ENDCASE
 DO coLbln
 GOTO TOP
 SET NEAR ON
 SEEK vaNo+vmEs
 SET NEAR OFF
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f3610fem), 7, 4)+ ;
    SUBSTR(DTOC(f3610fem), 4, 2)=vaNo+vmEs
      IF mkEy=9000
           RETURN
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Notas..."+f3610tdo+":"+f3610ser+ ;
        "-"+f3610doc STYLE "BQ" SIZE 1, 50
      STORE f3610tdo TO ptDo, ptD3
      STORE f3610ser TO psEr
      STORE f3610doc TO pdOc
      STORE f3610fem TO pfEm, pfVe
      STORE f3610fre TO pfRe
      STORE f3610mon TO pmOn
      STORE f3610nom TO pnOm
      STORE f3610pig TO ppIg
      STORE SUBSTR(f3610cm1, 1, 2) TO ptD1
      STORE SUBSTR(f3610cm1, 4, 3) TO psR1
      STORE SUBSTR(f3610cm1, 8, 7) TO pdO1
      STORE SUBSTR(f3610cm2, 1, 12) TO pfE1
      STORE SUBSTR(pfE1, 1, 2)+"/"+SUBSTR(pfE1, 4, 2)+"/"+SUBSTR(pfE1, 9,  ;
            2) TO pfE1
      DO CASE
           CASE ptD1="FA" .OR. ptD1="FE" .OR. ptD1="FC"
                STORE f3610ruc TO pcLi
                STORE f3610ruc TO prUc
           CASE (ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC") .AND.  ;
                LEN(ALLTRIM(f3610ele))>7 .AND. VAL(f3610ele)>0 .AND.  ;
                VAL(f3610ele)<99999999
                STORE f3610ele TO pcLi
                STORE f3610ele TO prUc
           CASE ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC"
                STORE "99999999999" TO pcLi
                STORE " " TO prUc
      ENDCASE
      DO CASE
           CASE f3610est="9"
                STORE "1" TO peSt
                STORE 00 TO ptGe, ptNe, piGv
                STORE " " TO ptD1, psR1, pdO1, pfE1
           OTHERWISE
                STORE f3610net TO ptNe
                STORE f3610igv TO piGv
                STORE f3610tot TO ptGe
                STORE "0" TO peSt
      ENDCASE
      SELECT tiPo_doc
      SEEK ptDo
      IF  .NOT. EOF()
           STORE f9311td1 TO ptD2
      ELSE
           STORE "00" TO ptD2
      ENDIF
      STORE ptD2+psEr+pdOc TO pdO3
      SELECT caMbio
      SEEK pfRe
      IF  .NOT. EOF()
           STORE f9111tc1 TO ptCa
      ELSE
           STORE 3.30 TO ptCa
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT deT_notas
           CASE pvTa="2"
                SELECT deT_nota2
           CASE pvTa="3"
                SELECT deT_nota3
           CASE pvTa="4"
                SELECT deT_nota4
           CASE pvTa="5"
                SELECT deT_nota5
      ENDCASE
      SEEK ptDo+psEr+pdOc
      STORE 0 TO ptOp, ptOs, ptOa
      DO WHILE  .NOT. EOF() .AND. f3611tdo+f3611ser+f3611doc=ptDo+psEr+pdOc
           STORE f3611cod TO pcOd
           SELECT prOductos
           SEEK ALLTRIM(pcOd)+"*"
           IF  .NOT. EOF()
                STORE f2111tpo TO ptPp
           ELSE
                STORE 1 TO ptPp
           ENDIF
           DO CASE
                CASE pvTa="1"
                     SELECT deT_notas
                CASE pvTa="2"
                     SELECT deT_nota2
                CASE pvTa="3"
                     SELECT deT_nota3
                CASE pvTa="4"
                     SELECT deT_nota4
                CASE pvTa="5"
                     SELECT deT_nota5
           ENDCASE
           STORE f3611tot TO ptTt
           DO CASE
                CASE ptPp=1
                     STORE ptOp+ptTt TO ptOp
                CASE ptPp=2
                     STORE ptOs+ptTt TO ptOs
                CASE ptPp=3
                     STORE ptOa+ptTt TO ptOa
           ENDCASE
           SKIP
      ENDDO
      DO CASE
           CASE ptDo="NC" .OR. ptDo="N1" .OR. ptDo="N3"
                STORE "CC" TO ptDo
           CASE ptDo="ND" .OR. ptDo="N2" .OR. ptDo="N4"
                STORE "CD" TO ptDo
      ENDCASE
      STORE pnUm+1 TO pnUm
      IF ptGe<>0 .OR. peSt="1"
           STORE "H" TO ptPc
           STORE prUc TO prU1
           STORE pnOm TO pnO1
           STORE " " TO pcCo
           DO CASE
                CASE pmOn=1
                     STORE "1212111" TO pcTa
                CASE pmOn=2
                     STORE "1212112" TO pcTa
           ENDCASE
           IF peSt="0"
                STORE ptNe TO pnEt
                STORE ALLTRIM(STR(piGv, 12, 2)) TO piG1
                STORE ALLTRIM(STR(ptGe, 12, 2)) TO ptOt
           ELSE
                STORE 0 TO pnEt, piGv
                STORE "0.00" TO piG1, ptOt
           ENDIF
           STORE STR(ppIg, 2, 0) TO ppI1
           DO vtG_0001a
           STORE "D" TO ptPc
           STORE ptGe-ptNe TO piGv
           STORE ALLTRIM(STR(piGv, 12, 2)) TO ptOt
           STORE "4011111" TO pcTa
           STORE " " TO piG1, ppI1, prU1, pnO1
           DO vtG_0001a
      ENDIF
      STORE " " TO piG1, ppI1, prU1, pnO1
      STORE "D" TO ptPc
      DO CASE
           CASE peSt="1"
                STORE 0 TO pnEt, piGv
                STORE ALLTRIM(STR(0, 12, 2)) TO ptOt
                STORE "7011111" TO pcTa
                DO vtG_0001a
           OTHERWISE
                STORE ROUND(ptOp/(1+(ppIg/100)), 2) TO ptOp
                STORE ROUND(ptOs/(1+(ppIg/100)), 2) TO ptOs
                STORE ROUND(ptOa/(1+(ppIg/100)), 2) TO ptOa
                STORE ptOp+ptOs+ptOa TO psTo
                DO CASE
                     CASE ROUND(psTo+piGv, 2)>ROUND(ptGe, 2)
                          IF ptOp>0
                               STORE ptOp-ROUND(psTo+piGv-ptGe, 2) TO ptOp
                          ELSE
                               IF ptOs>0
                                    STORE ptOs-ROUND(psTo+piGv-ptGe, 2) TO ptOs
                               ELSE
                                    IF ptOa>0
                                         STORE ptOa-ROUND(psTo+piGv-ptGe,  ;
                                          2) TO ptOa
                                    ENDIF
                               ENDIF
                          ENDIF
                     CASE ROUND(psTo+piGv, 2)<ROUND(ptGe, 2)
                          IF ptOp>0
                               STORE ptOp+ROUND(ptGe-(psTo+piGv), 2) TO ptOp
                          ELSE
                               IF ptOs>0
                                    STORE ptOs+ROUND(ptGe-(psTo+piGv), 2)  ;
                                     TO ptOs
                               ELSE
                                    IF ptOa>0
                                         STORE ptOa+ROUND(ptGe-(psTo+ ;
                                          piGv), 2) TO ptOa
                                    ENDIF
                               ENDIF
                          ENDIF
                ENDCASE
                IF ptOp<>0
                     STORE ALLTRIM(STR(ptOp, 12, 2)) TO ptOt
                     STORE "7011111" TO pcTa
                     DO vtG_0001a
                ENDIF
                IF ptOs<>0
                     STORE ALLTRIM(STR(ptOs, 12, 2)) TO ptOt
                     STORE "7041111" TO pcTa
                     DO vtG_0001a
                ENDIF
                IF ptOa<>0
                     STORE ALLTRIM(STR(ptOa, 12, 2)) TO ptOt
                     STORE "7561" TO pcTa
                     DO vtG_0001a
                ENDIF
      ENDCASE
      DO CASE
           CASE pvTa="1"
                SELECT caB_notas
           CASE pvTa="2"
                SELECT caB_nota2
           CASE pvTa="3"
                SELECT caB_nota3
           CASE pvTa="4"
                SELECT caB_nota4
           CASE pvTa="5"
                SELECT caB_nota5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE VtG_0001a
 SELECT teMporal_vtas
 APPEND BLANK
 REPLACE doCum WITH pdO3
 REPLACE fcTa WITH pcTa
 REPLACE faNomes WITH vaNo+vmEs
 REPLACE fsUb WITH psUb
 REPLACE fcOmpr WITH STRTRAN(STR(pnUm, 4, 0), " ", "0")
 REPLACE frEgis WITH SUBSTR(DTOC(pfEm), 1, 2)+"/"+SUBSTR(DTOC(pfEm), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfEm), 9, 2)
 REPLACE faNexo WITH paNx
 REPLACE fcOdcli WITH pcLi
 REPLACE ftIpdoc WITH ptDo
 DO CASE
      CASE ptD3="FE"
           REPLACE fnUmdoc WITH "F"+psEr+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"F"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH psR1+" "+pdO1
      CASE ptD3="FC"
           REPLACE fnUmdoc WITH "E"+psEr+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"E"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH psR1+" "+pdO1
      CASE ptD3="BE"
           REPLACE fnUmdoc WITH "B"+psEr+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"B"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH psR1+" "+pdO1
      CASE ptD3="BC"
           REPLACE fnUmdoc WITH "BE"+SUBSTR(psEr, 2, 2)+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"BE"+SUBSTR(psEr, 2, 2)+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH psR1+" "+pdO1
      CASE ptD3="N1"
           REPLACE fnUmdoc WITH "F"+psEr+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"F"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           IF ptD1="FT"
                REPLACE fnUmref WITH "F"+psR1+pdO1
           ELSE
                REPLACE fnUmref WITH "E"+psR1+pdO1
           ENDIF
      CASE ptD3="N2"
           REPLACE fnUmdoc WITH "F"+psEr+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"F"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           IF ptD1="FT"
                REPLACE fnUmref WITH "F"+psR1+pdO1
           ELSE
                REPLACE fnUmref WITH "E"+psR1+pdO1
           ENDIF
      CASE ptD3="N3" .AND. psEr="E0"
           REPLACE fnUmdoc WITH "E0"+SUBSTR(psEr, 2, 2)+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"E0"+SUBSTR(psEr, 2, 2)+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH "E0"+SUBSTR(psR1, 2, 2)+pdO1
      CASE ptD3="N3" .AND. psEr="EB"
           REPLACE fnUmdoc WITH "EB0"+SUBSTR(psEr, 3, 1)+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"EB0"+SUBSTR(psEr, 3, 1)+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH "EB0"+SUBSTR(psR1, 3, 1)+pdO1
      CASE ptD3="N4" .AND. psEr="E0"
           REPLACE fnUmdoc WITH "E0"+SUBSTR(psEr, 2, 2)+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"E0"+SUBSTR(psEr, 2, 2)+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH "E0"+SUBSTR(psR1, 2, 2)+pdO1
      CASE ptD3="N4" .AND. psEr="EB"
           REPLACE fnUmdoc WITH "EB0"+SUBSTR(psEr, 3, 1)+pdOc
           REPLACE fgLosa WITH ptDo+"/"+"EB0"+SUBSTR(psEr, 3, 1)+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH "EB0"+SUBSTR(psR1, 3, 1)+pdO1
      OTHERWISE
           REPLACE fnUmdoc WITH psEr+" "+pdOc
           REPLACE fgLosa WITH ptDo+"/"+psEr+" "+pdOc
           REPLACE ftDoref WITH ptD1
           REPLACE fnUmref WITH psR1+" "+pdO1
 ENDCASE
 REPLACE feMision WITH SUBSTR(DTOC(pfEm), 1, 2)+"/"+SUBSTR(DTOC(pfEm), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfEm), 9, 2)
 REPLACE fcOnv WITH pcOn
 REPLACE ftPocam WITH ALLTRIM(STR(ptCa, 5, 3))
 REPLACE fgLomov WITH pgLo
 REPLACE faNulad WITH peSt
 REPLACE fdEbhab WITH ptPc
 REPLACE fvEncim WITH SUBSTR(DTOC(pfVe), 1, 2)+"/"+SUBSTR(DTOC(pfVe), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfVe), 9, 2)
 REPLACE feXport WITH "0"
 REPLACE ffEcdoc WITH pfE1
 REPLACE frUc WITH prU1
 REPLACE fnOmbre WITH pnO1
 REPLACE fiGv WITH piG1
 REPLACE ftAsaigv WITH ppI1
 REPLACE ftOtal WITH ptOt
 REPLACE fcEncos WITH pcCo
ENDPROC
*
PROCEDURE Anx_0001a
 PUBLIC pcLi, prUc, pdNi, ptDo, ptPe, pnOm, pdIr, pdIs, pdEp, paPp, paPm,  ;
        pnO1, pnO2
 PUBLIC ptD1, pnMr, ptMm, pnNn, plLl, pfRa
 SELECT teMporal_anx
 ZAP
 DO cl1_0001a WITH "1"
 IF vaL2=1
      DO cl1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      DO cl1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      DO cl1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      DO cl1_0001a WITH "5"
 ENDIF
 DO pr1_0001a WITH "1"
 IF vaL2=1
      DO pr1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      DO pr1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      DO pr1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      DO pr1_0001a WITH "5"
 ENDIF
 SELECT teMporal_anx
 GOTO BOTTOM
 STORE RECNO() TO urEc
 GOTO TOP
 DO coLbln
 DO WHILE  .NOT. EOF()
      @ mfI0+14.6, mcO0+6 SAY "Grabando: "+STR(RECNO(), 6, 0)+" de "+ ;
        STR(urEc, 6, 0) STYLE "BQ" SIZE 1, 50
      STORE "" TO pfRa
      STORE pfRa+ALLTRIM(ftIp)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOd)+"|" TO pfRa
      STORE pfRa+ALLTRIM(frUc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnOm)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fdIr)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftDo)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fdOc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftPe)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faPp)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faPm)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnO1)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnO2)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnAc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fsEx) TO pfRa
      SELECT teMporal_fra
      APPEND BLANK
      REPLACE ffRa WITH pfRa
      SELECT teMporal_anx
      SKIP
 ENDDO
 IF  .NOT. DIRECTORY("PLE")
      MD PLE
 ENDIF
 DO coLbln
 @ mfI0+14.6, mcO0+6 SAY "Pasando Archivo a TXT..." STYLE "BQ" SIZE 1, 50
 STORE "PLE\Anexo_"+vaNo+vmEs+".txt" TO vdBf
 SELECT teMporal_fra
 GOTO TOP
 Copy to &vDBF SDF
 RELEASE pcLi, prUc, pdNi, ptDo, ptPe, pnOm, pdIr, pdIs, pdEp, paPp, paPm,  ;
         pnO1, pnO2
 RELEASE ptD1, pnMr, ptMm, pnNn, plLl, pfRa
 DEACTIVATE POPUP vtAb
 RETURN
ENDPROC
*
PROCEDURE Cl1_0001a
 PARAMETER pvTa
 DO CASE
      CASE pvTa="1"
           SELECT caB_fact
      CASE pvTa="2"
           SELECT caB_fact2
      CASE pvTa="3"
           SELECT caB_fact3
      CASE pvTa="4"
           SELECT caB_fact4
      CASE pvTa="5"
           SELECT caB_fact5
 ENDCASE
 DO coLbln
 GOTO TOP
 SEEK vaNo+vmEs
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f1300fem), 7, 4)+ ;
    SUBSTR(DTOC(f1300fem), 4, 2)=vaNo+vmEs
      IF f1300tdo<>"FA" .AND. f1300tdo<>"FE" .AND. f1300tdo<>"FC" .AND.  ;
         f1300tdo<>"BO" .AND. f1300tdo<>"BE" .AND. f1300tdo<>"BC"
           SKIP
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Ventas..."+f1300tdo+":"+ ;
        f1300ser+"-"+f1300doc STYLE "BQ" SIZE 1, 50
      STORE f1300tdo TO ptDo
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC"
                STORE f1300ruc TO pcLi
                STORE f1300ruc TO prUc
                STORE " " TO pdNi
                STORE "6" TO ptD1
                STORE "02" TO ptPe
           CASE (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC") .AND.  ;
                LEN(ALLTRIM(f1300ele))>7 .AND. VAL(f1300ele)>0 .AND.  ;
                VAL(f1300ele)<99999999
                STORE f1300ele TO pcLi, pdNi
                STORE " " TO prUc
                STORE "1" TO ptD1
                STORE "01" TO ptPe
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
                STORE "99999999999" TO pcLi
                STORE " " TO prUc, pdNi
                STORE "-" TO ptD1
                STORE "01" TO ptPe
      ENDCASE
      STORE f1300nom TO pnOm
      STORE f1300dir TO pdIr
      STORE f1300dis TO pdIs
      DO caM_0001a
      IF pcLi="99999999999"
           STORE " " TO prUc, pdNi
           STORE "-" TO ptD1
           STORE "01" TO ptPe
           STORE "VARIOS" TO paPp, paPm, pnO1
      ENDIF
      SELECT teMporal_anx
      SEEK "02"+pcLi
      IF EOF()
           APPEND BLANK
           REPLACE ftIp WITH "02"
           REPLACE fcOd WITH pcLi
           REPLACE frUc WITH prUc
           DO CASE
                CASE LEN(ALLTRIM(pdIr))>0 .AND. LEN(ALLTRIM(pdIs))>0
                     REPLACE fdIr WITH SUBSTR(ALLTRIM(pdIr)+","+ ;
                             ALLTRIM(pdIs), 1, 100)
                CASE LEN(ALLTRIM(pdIr))>0
                     REPLACE fdIr WITH ALLTRIM(pdIr)
                CASE LEN(ALLTRIM(pdIs))>0
                     REPLACE fdIr WITH ALLTRIM(pdIs)
           ENDCASE
           REPLACE fnOm WITH pnOm
           REPLACE ftDo WITH ptD1
           REPLACE fdOc WITH pdNi
           REPLACE ftPe WITH ptPe
           REPLACE faPp WITH paPp
           REPLACE faPm WITH paPm
           REPLACE fnO1 WITH pnO1
           REPLACE fnO2 WITH pnO2
           REPLACE fnAc WITH "9589"
           REPLACE fsEx WITH "0"
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT caB_fact
           CASE pvTa="2"
                SELECT caB_fact2
           CASE pvTa="3"
                SELECT caB_fact3
           CASE pvTa="4"
                SELECT caB_fact4
           CASE pvTa="5"
                SELECT caB_fact5
      ENDCASE
      SKIP
 ENDDO
 DO CASE
      CASE pvTa="1"
           SELECT caB_notas
      CASE pvTa="2"
           SELECT caB_nota2
      CASE pvTa="3"
           SELECT caB_nota3
      CASE pvTa="4"
           SELECT caB_nota4
      CASE pvTa="5"
           SELECT caB_nota5
 ENDCASE
 DO coLbln
 GOTO TOP
 SEEK vaNo+vmEs
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f3610fem), 7, 4)+ ;
    SUBSTR(DTOC(f3610fem), 4, 2)=vaNo+vmEs
      IF SUBSTR(f3610cm1, 1, 2)<>"FA" .AND. SUBSTR(f3610cm1, 1, 2)<>"FE"  ;
         .AND. SUBSTR(f3610cm1, 1, 2)<>"FC" .AND. SUBSTR(f3610cm1, 1, 2)<> ;
         "BO" .AND. SUBSTR(f3610cm1, 1, 2)<>"BE" .AND. SUBSTR(f3610cm1, 1,  ;
         2)<>"BC"
           SKIP
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Notas Contables..."+f3610tdo+ ;
        ":"+f3610ser+"-"+f3610doc STYLE "BQ" SIZE 1, 50
      STORE SUBSTR(f3610cm1, 1, 2) TO ptDo
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC"
                STORE f3610ruc TO pcLi
                STORE f3610ruc TO prUc
                STORE " " TO pdNi
                STORE "6" TO ptD1
                STORE "02" TO ptPe
           CASE (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC") .AND.  ;
                LEN(ALLTRIM(f3610ele))>7 .AND. VAL(f3610ele)>0 .AND.  ;
                VAL(f3610ele)<99999999
                STORE f3610ele TO pcLi, pdNi
                STORE " " TO prUc
                STORE "1" TO ptD1
                STORE "01" TO ptPe
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
                STORE "99999999999" TO pcLi
                STORE " " TO prUc, pdNi
                STORE "-" TO ptD1
                STORE "01" TO ptPe
      ENDCASE
      STORE f3610nom TO pnOm
      STORE f3610dir TO pdIr
      STORE f3610dis TO pdIs
      DO caM_0001a
      IF pcLi="99999999999"
           STORE " " TO prUc, pdNi
           STORE "-" TO ptD1
           STORE "01" TO ptPe
           STORE "VARIOS" TO paPp, paPm, pnO1
      ENDIF
      SELECT teMporal_anx
      SEEK "02"+pcLi
      IF EOF()
           APPEND BLANK
           REPLACE ftIp WITH "02"
           REPLACE fcOd WITH pcLi
           REPLACE frUc WITH prUc
           DO CASE
                CASE LEN(ALLTRIM(pdIr))>0 .AND. LEN(ALLTRIM(pdIs))>0
                     REPLACE fdIr WITH SUBSTR(ALLTRIM(pdIr)+","+ ;
                             ALLTRIM(pdIs), 1, 100)
                CASE LEN(ALLTRIM(pdIr))>0
                     REPLACE fdIr WITH ALLTRIM(pdIr)
                CASE LEN(ALLTRIM(pdIs))>0
                     REPLACE fdIr WITH ALLTRIM(pdIs)
           ENDCASE
           REPLACE fnOm WITH pnOm
           REPLACE ftDo WITH ptD1
           REPLACE fdOc WITH pdNi
           REPLACE ftPe WITH ptPe
           REPLACE faPp WITH paPp
           REPLACE faPm WITH paPm
           REPLACE fnO1 WITH pnO1
           REPLACE fnO2 WITH pnO2
           REPLACE fnAc WITH "9589"
           REPLACE fsEx WITH "0"
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT caB_notas
           CASE pvTa="2"
                SELECT caB_nota2
           CASE pvTa="3"
                SELECT caB_nota3
           CASE pvTa="4"
                SELECT caB_nota4
           CASE pvTa="5"
                SELECT caB_nota5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE Pr1_0001a
 PARAMETER pvTa
 DO CASE
      CASE pvTa="1"
           SELECT caB_cpras
      CASE pvTa="2"
           SELECT caB_cpra2
      CASE pvTa="3"
           SELECT caB_cpra3
      CASE pvTa="4"
           SELECT caB_cpra4
      CASE pvTa="5"
           SELECT caB_cpra5
 ENDCASE
 DO coLbln
 GOTO TOP
 SEEK vaNo+vmEs
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f2400reg), 7, 4)+ ;
    SUBSTR(DTOC(f2400reg), 4, 2)=vaNo+vmEs
      IF f2400td1="BO" .OR. f2400td1="  "
           SKIP
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Compras..."+f2400tdo+":"+ ;
        f2400ser+"-"+f2400doc STYLE "BQ" SIZE 1, 50
      STORE f2400ruc TO pcLi
      STORE f2400ruc TO prUc
      STORE " " TO pdNi
      STORE "6" TO ptD1
      STORE "02" TO ptPe
      STORE f2400nom TO pnOm
      STORE f2400dir TO pdIr
      STORE f2400dis TO pdIs
      STORE " " TO paPp, paPm, pnO1, pnO2
      SELECT teMporal_anx
      SEEK "03"+pcLi
      IF EOF()
           APPEND BLANK
           REPLACE ftIp WITH "03"
           REPLACE fcOd WITH pcLi
           REPLACE frUc WITH prUc
           REPLACE fnOm WITH pnOm
           REPLACE fdIr WITH ALLTRIM(pdIr)+","+ALLTRIM(pdIs)
           REPLACE ftDo WITH ptD1
           REPLACE fdOc WITH pdNi
           REPLACE ftPe WITH ptPe
           REPLACE faPp WITH paPp
           REPLACE faPm WITH paPm
           REPLACE fnO1 WITH pnO1
           REPLACE fnO2 WITH pnO2
           REPLACE fnAc WITH "9589"
           REPLACE fsEx WITH "0"
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT caB_cpras
           CASE pvTa="2"
                SELECT caB_cpra2
           CASE pvTa="3"
                SELECT caB_cpra3
           CASE pvTa="4"
                SELECT caB_cpra4
           CASE pvTa="5"
                SELECT caB_cpra5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE Cam_0001a
 IF AT("'", pnOm)<>0
      STORE AT("'", pnOm) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT("'", pnOm)<>0
      STORE AT("'", pnOm) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT("'", pnOm)<>0
      STORE AT("'", pnOm) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT('"', pnOm)<>0
      STORE AT('"', pnOm) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT('"', pnOm)<>0
      STORE AT('"', pnOm) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT('"', pnOm)<>0
      STORE AT('"', pnOm) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT("", pnOm)<>0
      STORE AT("", pnOm) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT("", pnOm)<>0
      STORE AT("", pnOm) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF AT("'", pdIr)<>0
      STORE AT("'", pdIr) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("'", pdIr)<>0
      STORE AT("'", pdIr) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("'", pdIr)<>0
      STORE AT("'", pdIr) TO pnMr
      STORE LEN("'") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT('"', pdIr)<>0
      STORE AT('"', pdIr) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT('"', pdIr)<>0
      STORE AT('"', pdIr) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT('"', pdIr)<>0
      STORE AT('"', pdIr) TO pnMr
      STORE LEN('"') TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("(", pdIr)<>0
      STORE AT("(", pdIr) TO pnMr
      STORE LEN("(") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("(", pdIr)<>0
      STORE AT("(", pdIr) TO pnMr
      STORE LEN("(") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT(")", pdIr)<>0
      STORE AT(")", pdIr) TO pnMr
      STORE LEN(")") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("", pdIr)<>0
      STORE AT("", pdIr) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("", pdIr)<>0
      STORE AT("", pdIr) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pdIr, 1, pnMr-1)+SUBSTR(pdIr, pnMr+ptMm, 70) TO pdIr
 ENDIF
 IF AT("", pdIs)<>0
      STORE AT("", pdIs) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pdIs, 1, pnMr-1)+SUBSTR(pdIs, pnMr+ptMm, 70) TO pdIs
 ENDIF
 IF AT("", pdIs)<>0
      STORE AT("", pdIs) TO pnMr
      STORE LEN("") TO ptMm
      STORE SUBSTR(pdIs, 1, pnMr-1)+SUBSTR(pdIs, pnMr+ptMm, 70) TO pdIs
 ENDIF
 IF (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC") .AND. SUBSTR(ALLTRIM(pnOm),  ;
    LEN(ALLTRIM(pnOm)), 1)="."
      STORE RAT(".", pnOm) TO pnMr
      STORE LEN(".") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 IF (ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC") .AND. SUBSTR(ALLTRIM(pnOm),  ;
    LEN(ALLTRIM(pnOm)), 1)="."
      STORE RAT(".", pnOm) TO pnMr
      STORE LEN(".") TO ptMm
      STORE SUBSTR(pnOm, 1, pnMr-1)+SUBSTR(pnOm, pnMr+ptMm, 70) TO pnOm
 ENDIF
 STORE SUBSTR(pnOm, 1, 100) TO pnOm
 STORE SUBSTR(pdIr, 1, 100) TO pdIr
 STORE SUBSTR(pdIs, 1, 100) TO pdIs
 STORE " " TO paPp, paPm, pnO1, pnO2
 IF LEN(ALLTRIM(pdIr))=0
      STORE "." TO pdIr
 ENDIF
 IF LEN(ALLTRIM(pdIs))=0
      STORE "." TO pdIs
 ENDIF
 IF ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
      IF LEN(ALLTRIM(pdNi))>7 .AND. VAL(pdNi)>0 .AND. VAL(pdNi)<99999999
           STORE ALLTRIM(pnOm) TO pnNn
           STORE AT(" ", pnNn, 1) TO plLl
           STORE SUBSTR(pnNn, 1, plLl-1) TO paPp
           STORE ALLTRIM(paPp) TO paPp
           STORE SUBSTR(pnNn, plLl+1, 100) TO pnNn
           STORE ALLTRIM(pnNn) TO pnNn
           STORE AT(" ", pnNn, 1) TO plLl
           IF plLl<>0 .OR. LEN(ALLTRIM(pnNn))<>0
                IF plLl<>0
                     STORE SUBSTR(pnNn, 1, plLl-1) TO paPm
                     STORE SUBSTR(pnNn, plLl+1, 100) TO pnNn
                ELSE
                     STORE SUBSTR(pnNn, 1, 20) TO paPm
                     STORE "" TO pnNn
                ENDIF
                STORE ALLTRIM(pnNn) TO pnNn
                STORE AT(" ", pnNn, 1) TO plLl
           ENDIF
           IF plLl<>0 .OR. LEN(ALLTRIM(pnNn))<>0
                IF plLl<>0
                     STORE SUBSTR(pnNn, 1, plLl-1) TO pnO1
                     STORE SUBSTR(pnNn, plLl+1, 100) TO pnNn
                ELSE
                     STORE SUBSTR(pnNn, 1, 20) TO pnO1
                     STORE "" TO pnNn
                ENDIF
                STORE ALLTRIM(pnNn) TO pnNn
                STORE AT(" ", pnNn, 1) TO plLl
           ENDIF
           IF LEN(ALLTRIM(pnNn))<>0
                STORE SUBSTR(pnNn, 1, 20) TO pnO2
           ENDIF
           DO CASE
                CASE LEN(ALLTRIM(paPm))=0 .AND. LEN(ALLTRIM(pnO1))=0  ;
                     .AND. LEN(ALLTRIM(pnO2))=0
                     STORE "99999999999" TO pcLi, prUc
                     STORE "VARIOS" TO paPp, paPm, pnO1
                CASE LEN(ALLTRIM(pnO1))=0 .AND. LEN(ALLTRIM(pnO2))=0
                     STORE "99999999999" TO pcLi, prUc
                     STORE "VARIOS" TO paPp, paPm, pnO1
           ENDCASE
      ENDIF
 ENDIF
 IF UPPER(ALLTRIM(pnOm))+"*"=ALLTRIM(pnOm)+"*"
      STORE LOWER(pnOm) TO pnOm
      STORE UPPER(SUBSTR(pnOm, 1, 1))+SUBSTR(pnOm, 2, 100) TO pnOm
 ENDIF
 IF UPPER(ALLTRIM(pdIr))+"*"=ALLTRIM(pdIr)+"*"
      STORE LOWER(pdIr) TO pdIr
      STORE UPPER(SUBSTR(pdIr, 1, 1))+SUBSTR(pdIr, 2, 100) TO pdIr
 ENDIF
 IF UPPER(ALLTRIM(pdIs))+"*"=ALLTRIM(pdIs)+"*"
      STORE LOWER(pdIs) TO pdIs
      STORE UPPER(SUBSTR(pdIs, 1, 1))+SUBSTR(pdIs, 2, 100) TO pdIs
 ENDIF
ENDPROC
*
PROCEDURE Cpr_0001a
 PUBLIC ptDo, psEr, pdOc, pfEm, pmOn, ppRv, prUc, pnOm, ppIg, ptD1, psR1,  ;
        pfAc, ppGd
 PUBLIC pfVe, ptD2, psR2, pdO2, pfE2, ptD3, pdO3, ptCa, ptOp, ptOs, ptOa,  ;
        pcOd, ptPp
 PUBLIC pnUm, pcTa, pfRa, peSt, psUb, paNx, ptGe, pcOn, pfRe, pgLo, pcCo,  ;
        ptPc, piPl
 PUBLIC piGv, piG1, pnEt, ptOt, ppI1, ppMx, pcIf, paDe, pnDe, pfDe, pcDe,  ;
        piMp, ptDe
 PUBLIC piDe, psTo, psW0, pcT1, pdSt, ptNe, ptTt
 STORE "0" TO peSt, piPl, piMp
 STORE "01" TO psUb
 STORE "03" TO paNx
 STORE "VTA" TO pcOn
 STORE "Compra de Mercaderia" TO pgLo
 STORE 0 TO pnUm
 STORE " " TO pcCo, ppMx, pcIf, paDe, pnDe
 STORE " " TO pfDe, pcDe, ptDe, piDe
 SELECT teMporal_cpras
 SET ORDER TO
 ZAP
 DO cp1_0001a WITH "1"
 IF vaL2=1
      DO cp1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      DO cp1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      DO cp1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      DO cp1_0001a WITH "5"
 ENDIF
 SELECT teMporal_cpras
 GOTO BOTTOM
 STORE RECNO() TO urEc
 GOTO TOP
 DO coLbln
 DO WHILE  .NOT. EOF()
      @ mfI0+14.6, mcO0+6 SAY "Grabando: "+STR(RECNO(), 6, 0)+" de "+ ;
        STR(urEc, 6, 0) STYLE "BQ" SIZE 1, 50
      STORE "" TO pfRa
      STORE pfRa+ALLTRIM(fcTa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNomes)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fsUb)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOmpr)+"|" TO pfRa
      STORE pfRa+ALLTRIM(feMision)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNexo)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOdprv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftIpdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fvEncim)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fiGv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftAsaigv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftOtal)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOnv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(frEgis)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftPocam)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLosa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftPodes)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fpOrcpr)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fvAlcif)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftDoref)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmref)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcEncos)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faFedet)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmdet)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ffEcdet)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ffEcdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLomov)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNulad)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fiGvapl)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOddet)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fiMport)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fdEbhab)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftAsdet)+"|" TO pfRa
      SELECT teMporal_fra
      APPEND BLANK
      REPLACE ffRa WITH pfRa
      SELECT teMporal_cpras
      SKIP
 ENDDO
 IF  .NOT. DIRECTORY("PLE")
      MD PLE
 ENDIF
 DO coLbln
 @ mfI0+14.6, mcO0+6 SAY "Pasando Archivo a TXT..." STYLE "BQ" SIZE 1, 50
 STORE "PLE\C_"+vaNo+vmEs+"_StartSoft.txt" TO vdBf
 SELECT teMporal_fra
 GOTO TOP
 Copy to &vDBF SDF
 RELEASE ptDo, psEr, pdOc, pfEm, pmOn, ppRv, prUc, pnOm, ppIg, ptD1, psR1,  ;
         pfAc, ppGd
 RELEASE pfVe, ptD2, psR2, pdO2, pfE2, ptD3, pdO3, ptCa, ptOp, ptOs, ptOa,  ;
         pcOd, ptPp
 RELEASE pnUm, pcTa, pfRa, peSt, psUb, paNx, ptGe, pcOn, pfRe, pgLo, pcCo,  ;
         ptPc, piPl
 RELEASE piGv, piG1, pnEt, ptOt, ppI1, ppMx, pcIf, paDe, pnDe, pfDe, pcDe,  ;
         piMp, ptDe
 RELEASE piDe, psTo, psW0, pcT1, pdSt, ptNe, ptTt
 DEACTIVATE POPUP vtAb
 RETURN
ENDPROC
*
PROCEDURE Cp1_0001a
 PARAMETER pvTa
 DO CASE
      CASE pvTa="1"
           SELECT caB_cpras
      CASE pvTa="2"
           SELECT caB_cpra2
      CASE pvTa="3"
           SELECT caB_cpra3
      CASE pvTa="4"
           SELECT caB_cpra4
      CASE pvTa="5"
           SELECT caB_cpra5
 ENDCASE
 DO coLbln
 GOTO TOP
 SEEK vaNo+vmEs
 DO WHILE  .NOT. EOF() .AND. SUBSTR(DTOC(f2400reg), 7, 4)+ ;
    SUBSTR(DTOC(f2400reg), 4, 2)=vaNo+vmEs
      IF f2400td1=" " .OR. f2400sr1=" " .OR. f2400fac=" " .OR. f2400est="9"
           SKIP
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Compra..."+f2400tdo+":"+ ;
        f2400ser+"-"+f2400doc STYLE "BQ" SIZE 1, 50
      STORE f2400tdo TO ptDo
      STORE f2400ser TO psEr
      STORE f2400doc TO pdOc
      STORE f2400fem TO pfEm
      STORE f2400reg TO pfRe
      STORE f2400mon TO pmOn
      STORE f2400ruc TO ppRv
      STORE f2400ruc TO prUc
      STORE f2400nom TO pnOm
      STORE f2400pig TO ppIg
      STORE f2400td1 TO ptD1
      STORE f2400sr1 TO psR1
      STORE f2400fac TO pfAc
      STORE f2400dct TO ppGd
      STORE f2400net TO ptNe
      STORE f2400tot TO ptGe
      STORE f2400cuo TO pnUm
      STORE pfEm+f2400dia TO pfVe
      STORE ppGd*(1+(ppIg/100)) TO ppGd
      STORE SUBSTR(f2400cm1, 1, 2) TO ptD2
      STORE SUBSTR(f2400cm1, 4, 4) TO psR2
      STORE SUBSTR(f2400cm1, 9, 10) TO pdO2
      STORE SUBSTR(f2400cm2, 1, 12) TO pfE2
      STORE SUBSTR(pfE2, 1, 2)+"/"+SUBSTR(pfE2, 4, 2)+"/"+SUBSTR(pfE2, 9,  ;
            2) TO pfE2
      IF ptD1<>"NC" .AND. ptD1<>"ND"
           STORE " " TO ptD2, psR2, pdO2, pfE2
      ENDIF
      SELECT tiPo_doc
      SEEK ptD1
      IF  .NOT. EOF()
           STORE f9311td1 TO ptD3
      ELSE
           STORE "00" TO ptD3
      ENDIF
      IF ptD1<>"NC" .AND. ptD1<>"ND"
           SEEK ptD2
           IF  .NOT. EOF()
                STORE f9311td1 TO ptD2
           ELSE
                STORE "00" TO ptD2
           ENDIF
      ENDIF
      STORE ptD3+psR1+pfAc TO pdO3
      SELECT caMbio
      SEEK pfEm
      IF  .NOT. EOF()
           STORE f9111tc1 TO ptCa
      ELSE
           STORE 3.30 TO ptCa
      ENDIF
      IF pmOn=2
           STORE ROUND(ppGd*ptCa, 2) TO ppGd
           STORE ROUND(ptNe*ptCa, 2) TO ptNe
           STORE ROUND(ptGe*ptCa, 2) TO ptGe
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT deT_cpras
           CASE pvTa="2"
                SELECT deT_cpra2
           CASE pvTa="3"
                SELECT deT_cpra3
           CASE pvTa="4"
                SELECT deT_cpra4
           CASE pvTa="5"
                SELECT deT_cpra5
      ENDCASE
      SEEK ptDo+psEr+pdOc
      STORE 0 TO ptOp, ptOs, ptOa, psW0
      DO WHILE  .NOT. EOF() .AND. f2401tdo+f2401ser+f2401doc=ptDo+psEr+pdOc
           STORE f2401cod TO pcOd
           SELECT prOductos
           SEEK ALLTRIM(pcOd)+"*"
           IF  .NOT. EOF()
                STORE f2111tpo TO ptPp
           ELSE
                STORE 1 TO ptPp
           ENDIF
           DO CASE
                CASE pcOd="G00001"
                     STORE "6561112" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00002"
                     STORE "6561113" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00003"
                     STORE "6011000" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00004"
                     STORE "6251111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00005"
                     STORE "6042   " TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00006"
                     STORE "6363111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00007"
                     STORE "6343111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00008"
                     STORE "6711111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00009"
                     STORE "659911 " TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00010"
                     STORE "6343111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00011"
                     STORE "6599113" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00012"
                     STORE "6343111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00013"
                     STORE "6354111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00014"
                     STORE "6595111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00015"
                     STORE "6365111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00016"
                     STORE "6322111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00017"
                     STORE "6367111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00018"
                     STORE "6329115" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00019"
                     STORE "6361111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00020"
                     STORE "6323112" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00021"
                     STORE "6329115" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00022"
                     STORE "6251111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00023"
                     STORE "6391113" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00024"
                     STORE "6391113" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00025"
                     STORE "6391113" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00026"
                     STORE "6273111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00027"
                     STORE "1891111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00028"
                     STORE "1891111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00029"
                     STORE "6599114" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00030"
                     STORE "6599114" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00031"
                     STORE "6251111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00032"
                     STORE "6343111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00033"
                     STORE "659911 " TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00034"
                     STORE "3351111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00035"
                     STORE "7411111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00036"
                     STORE "4221111" TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                CASE pcOd="G00037"
                     STORE "659911 " TO pcT1
                     STORE 1 TO psW0
                     STORE 2 TO ptPp
                OTHERWISE
                     STORE " " TO pcT1
                     STORE 0 TO psW0
           ENDCASE
           DO CASE
                CASE pvTa="1"
                     SELECT deT_cpras
                CASE pvTa="2"
                     SELECT deT_cpra2
                CASE pvTa="3"
                     SELECT deT_cpra3
                CASE pvTa="4"
                     SELECT deT_cpra4
                CASE pvTa="5"
                     SELECT deT_cpra5
           ENDCASE
           STORE f2401can*f2401pre*(1+(ppIg/100)) TO ptTt
           IF pmOn=2
                STORE ROUND(ptTt*ptCa, 2) TO ptTt
           ENDIF
           DO CASE
                CASE ptPp=1
                     STORE ptOp+ptTt TO ptOp
                CASE ptPp=2
                     STORE ptOs+ptTt TO ptOs
                CASE ptPp=3
                     STORE ptOa+ptTt TO ptOa
           ENDCASE
           SKIP
      ENDDO
      IF ppGd<>0
           DO CASE
                CASE ptOp>0 .AND. ptOp>ppGd
                     STORE ptOp-ppGd TO ptOp
                CASE ptOs>0 .AND. ptOs>ppGd
                     STORE ptOs-ppGd TO ptOs
                CASE ptOa>0 .AND. ptOa>ppGd
                     STORE ptOa-ppGd TO ptOa
                OTHERWISE
                     IF ptOp>0
                          STORE ppGd-ptOp TO ptOp
                          STORE 0 TO ptOp
                     ENDIF
                     IF ptOs>0 .AND. ptOs>ppGd
                          STORE ptOs-ppGd TO ptOs
                     ELSE
                          STORE ppGd-ptOs TO ptOs
                          STORE 0 TO ptOs
                     ENDIF
                     IF ptOa>0 .AND. ptOa>ppGd
                          STORE ptOa-ppGd TO ptOa
                     ELSE
                          STORE ppGd-ptOa TO ptOa
                          STORE 0 TO ptOa
                     ENDIF
           ENDCASE
      ENDIF
      DO CASE
           CASE ptDo="FA" .OR. ptDo="FE" .OR. ptDo="FC"
                STORE "FT" TO ptDo
           CASE ptDo="BO" .OR. ptDo="BE" .OR. ptDo="BC"
                STORE "BV" TO ptDo
           CASE ptD1="NC"
                STORE "CC" TO ptD1
           CASE ptD1="ND"
                STORE "CD" TO ptD1
           CASE ptD1="PU"
                STORE "RC" TO ptD1
           CASE ptD1="TK"
                STORE "TK" TO ptD1
           CASE ptD1="FI"
                STORE "BS" TO ptD1
           CASE ptD1="DU"
                STORE "PU" TO ptD1
           OTHERWISE
                STORE "00" TO ptD1
      ENDCASE
      DO CASE
           CASE pmOn=1
                STORE "4212111" TO pcTa
           CASE pmOn=2
                STORE "4212112" TO pcTa
      ENDCASE
      STORE "H" TO ptPc
      STORE ROUND(ptGe/(1+(ppIg/100)), 2) TO pnEt
      STORE STR(ppIg, 2, 0) TO ppI1
      STORE ptGe-pnEt TO piGv
      STORE ALLTRIM(STR(piGv, 12, 2)) TO piG1
      STORE ALLTRIM(STR(ptGe, 12, 2)) TO ptOt
      DO CASE
           CASE ppIg=0
                STORE "004" TO pdSt
           CASE ppIg=18
                STORE "001" TO pdSt
           OTHERWISE
                STORE "001" TO pdSt
      ENDCASE
      DO cpG_0001a
      STORE "D" TO ptPc
      STORE ALLTRIM(STR(piGv, 12, 2)) TO ptOt
      STORE "4011111" TO pcTa
      STORE " " TO piG1, pcCo
      DO cpG_0001a
      STORE " " TO piG1
      STORE ptOp+ptOs+ptOa TO psTo
      DO CASE
           CASE psTo>ptGe
                IF ptOp>0
                     STORE ptOp-(psTo-ptGe) TO ptOp
                ELSE
                     IF ptOs>0
                          STORE ptOs-(psTo-ptGe) TO ptOs
                     ELSE
                          IF ptOa>0
                               STORE ptOa-(psTo-ptGe) TO ptOa
                          ENDIF
                     ENDIF
                ENDIF
           CASE psTo<ptGe
                IF ptOp>0
                     STORE ptOp+(ptGe-psTo) TO ptOp
                ELSE
                     IF ptOs>0
                          STORE ptOs+(ptGe-psTo) TO ptOs
                     ELSE
                          IF ptOa>0
                               STORE ptOa+(ptGe-psTo) TO ptOa
                          ENDIF
                     ENDIF
                ENDIF
      ENDCASE
      STORE ptOp+ptOs+ptOa TO psTo
      IF ptOp<>0
           STORE ROUND(ptOp/(1+(ppIg/100)), 2) TO ptOp
      ENDIF
      IF ptOs<>0
           STORE ROUND(ptOs/(1+(ppIg/100)), 2) TO ptOs
      ENDIF
      IF ptOa<>0
           STORE ROUND(ptOa/(1+(ppIg/100)), 2) TO ptOa
      ENDIF
      IF ptOp<>0
           STORE ALLTRIM(STR(ptOp, 12, 2)) TO ptOt
           STORE "6011000" TO pcTa
           STORE "2011000" TO pcCo
           DO cpG_0001a
      ENDIF
      IF ptOs<>0
           STORE ALLTRIM(STR(ptOs, 12, 2)) TO ptOt
           IF LEN(ALLTRIM(pcT1))<>0
                STORE pcT1 TO pcTa
           ELSE
                STORE "6327" TO pcTa
           ENDIF
           STORE "9410000" TO pcCo
           DO cpG_0001a
      ENDIF
      IF ptOa<>0
           STORE ALLTRIM(STR(ptOa, 12, 2)) TO ptOt
           STORE " " TO pcCo
           STORE "7561" TO pcTa
           DO cpG_0001a
      ENDIF
      DO CASE
           CASE pvTa="1"
                SELECT caB_cpras
           CASE pvTa="2"
                SELECT caB_cpra2
           CASE pvTa="3"
                SELECT caB_cpra3
           CASE pvTa="4"
                SELECT caB_cpra4
           CASE pvTa="5"
                SELECT caB_cpra5
      ENDCASE
      SKIP
 ENDDO
ENDPROC
*
PROCEDURE CpG_0001a
 SELECT teMporal_cpras
 APPEND BLANK
 REPLACE doCum WITH pdO3
 REPLACE fcTa WITH pcTa
 REPLACE faNomes WITH vaNo+vmEs
 REPLACE fsUb WITH psUb
 REPLACE fcOmpr WITH pnUm
 REPLACE feMision WITH SUBSTR(DTOC(pfEm), 1, 2)+"/"+SUBSTR(DTOC(pfEm), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfEm), 9, 2)
 REPLACE faNexo WITH paNx
 REPLACE fcOdprv WITH ppRv
 REPLACE ftIpdoc WITH ptD1
 REPLACE fnUmdoc WITH SUBSTR(psR1, 1, 4)+ALLTRIM(pfAc)
 REPLACE fvEncim WITH SUBSTR(DTOC(pfVe), 1, 2)+"/"+SUBSTR(DTOC(pfVe), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfVe), 9, 2)
 REPLACE fcOnv WITH pcOn
 REPLACE frEgis WITH SUBSTR(DTOC(pfRe), 1, 2)+"/"+SUBSTR(DTOC(pfRe), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfRe), 9, 2)
 REPLACE ftPocam WITH ALLTRIM(STR(ptCa, 5, 3))
 REPLACE fgLosa WITH pgLo
 REPLACE ftDoref WITH ptD2
 REPLACE fnUmref WITH psR2+pdO2
 REPLACE ffEcdoc WITH pfE2
 REPLACE fcEncos WITH pcCo
 REPLACE fgLomov WITH prUc+"-"+pnOm
 REPLACE faNulad WITH peSt
 REPLACE feXport WITH "0"
 REPLACE fiGvapl WITH piPl
 REPLACE fdEbhab WITH ptPc
 REPLACE ftAsaigv WITH ppI1
 REPLACE fiGv WITH piG1
 REPLACE ftOtal WITH ptOt
 REPLACE ftPodes WITH pdSt
 REPLACE fpOrcpr WITH ppMx
 REPLACE fvAlcif WITH pcIf
 REPLACE faFedet WITH paDe
 REPLACE fnUmdet WITH pnDe
 REPLACE ffEcdet WITH pfDe
 REPLACE fcOddet WITH pcDe
 REPLACE fiMport WITH piMp
 REPLACE ftAsdet WITH ptDe
 REPLACE fiMpdet WITH piDe
ENDPROC
*
PROCEDURE Caj_0001a
 PUBLIC pfRa, psEr, pnU1, pfEm, pmOn, pmNd, ptIp, ptPc, ptCa, ptD1, psR1,  ;
        pfAc, ptOt
 PUBLIC pcTa, psUb, peSt, paNx, pcLi, pfVe, pgLo, pnUm, pcCo, pcOn, ptGe,  ;
        ctD1, csR1
 PUBLIC cfAc, pgL2, ptC1, pdIa, pcAn, ptD3
 STORE "0" TO peSt
 STORE " " TO pcCo
 STORE " " TO pdIa
 STORE "02" TO paNx
 STORE "VTA" TO pcOn
 STORE 0 TO pnUm
 SELECT teMporal_caja
 SET ORDER TO
 ZAP
 STORE 0 TO ptGe
 STORE "04" TO psUb
 DO cj1_0001a WITH "1"
 IF vaL2=1
      STORE 0 TO ptGe
      DO cj1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      STORE 0 TO ptGe
      DO cj1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      STORE 0 TO ptGe
      DO cj1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      STORE 0 TO ptGe
      DO cj1_0001a WITH "5"
 ENDIF
 STORE 0 TO ptGe
 STORE "07" TO psUb
 STORE 0 TO pnUm
 DO bc1_0001a WITH "1"
 IF vaL2=1
      STORE 0 TO ptGe
      DO bc1_0001a WITH "2"
 ENDIF
 IF vaL3=1
      STORE 0 TO ptGe
      DO bc1_0001a WITH "3"
 ENDIF
 IF vaL4=1
      STORE 0 TO ptGe
      DO bc1_0001a WITH "4"
 ENDIF
 IF vaL5=1
      STORE 0 TO ptGe
      DO bc1_0001a WITH "5"
 ENDIF
 SELECT teMporal_caja
 GOTO BOTTOM
 STORE RECNO() TO urEc
 GOTO TOP
 DO coLbln
 DO WHILE  .NOT. EOF()
      @ mfI0+14.6, mcO0+6 SAY "Grabando: "+STR(RECNO(), 6, 0)+" de "+ ;
        STR(urEc, 6, 0) STYLE "BQ" SIZE 1, 50
      STORE "" TO pfRa
      STORE pfRa+ALLTRIM(fcTa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNomes)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fsUb)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOmpr)+"|" TO pfRa
      STORE pfRa+ALLTRIM(feMision)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNexo)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOdanx)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftIpdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fnUmdoc)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fvEncim)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fmOn)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftOtal)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcOnv)+"|" TO pfRa
      STORE pfRa+ALLTRIM(frEgis)+"|" TO pfRa
      STORE pfRa+ALLTRIM(ftPocam)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLosa)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fcEncos)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fgLomov)+"|" TO pfRa
      STORE pfRa+ALLTRIM(faNulad)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fdEbhab)+"|" TO pfRa
      STORE pfRa+ALLTRIM(fmEdpag)+"|" TO pfRa
      SELECT teMporal_fra
      APPEND BLANK
      REPLACE ffRa WITH pfRa
      SELECT teMporal_caja
      SKIP
 ENDDO
 IF  .NOT. DIRECTORY("PLE")
      MD PLE
 ENDIF
 DO coLbln
 @ mfI0+14.6, mcO0+6 SAY "Pasando Archivo a TXT..." STYLE "BQ" SIZE 1, 50
 STORE "PLE\S_"+vaNo+vmEs+"_StartSoft.txt" TO vdBf
 SELECT teMporal_fra
 GOTO TOP
 Copy to &vDBF SDF
 RELEASE pfRa, psEr, pnU1, pfEm, pmOn, pmNd, ptIp, ptPc, ptCa, ptD1, psR1,  ;
         pfAc, ptOt
 RELEASE pcTa, psUb, peSt, paNx, pcLi, pfVe, pgLo, pnUm, pcCo, pcOn, ptGe,  ;
         ctD1, csR1
 RELEASE cfAc, pgL2, ptC1, pdIa, pcAn, ptD3
 DEACTIVATE POPUP vtAb
 RETURN
ENDPROC
*
PROCEDURE Cj1_0001a
 PARAMETER pvTa
 DO CASE
      CASE pvTa="1"
           SELECT caB_fact
      CASE pvTa="2"
           SELECT caB_fact2
      CASE pvTa="3"
           SELECT caB_fact3
      CASE pvTa="4"
           SELECT caB_fact4
      CASE pvTa="5"
           SELECT caB_fact5
 ENDCASE
 SET ORDER TO F1300DOC
 DO CASE
      CASE pvTa="1"
           SELECT deT_caja
      CASE pvTa="2"
           SELECT deT_caja2
      CASE pvTa="3"
           SELECT deT_caja3
      CASE pvTa="4"
           SELECT deT_caja4
      CASE pvTa="5"
           SELECT deT_caja5
 ENDCASE
 DO coLbln
 GOTO TOP
 IF maDm<>1
      mkEy = INKEY(50)
 ENDIF
 SEEK vaNo+vmEs
 IF maDm<>1
      mkEy = INKEY(50)
 ENDIF
 STORE " " TO ctD1, csR1, cfAc
 DO WHILE  .NOT. EOF() .AND. f3511ano+f3511mes=vaNo+vmEs
      IF f3511tdo<>"FA" .AND. f3511tdo<>"BO" .AND. f3511tdo<>"BC" .AND.  ;
         f3511tdo<>"BE" .AND. f3511tdo<>"FC" .AND. f3511tdo<>"FE"
           SKIP
           IF maDm<>1
                mkEy = INKEY(50)
           ENDIF
           LOOP
      ENDIF
      IF f3511tdo+f3511sr1+f3511doc<>ctD1+csR1+cfAc
           IF ptGe<>0
                STORE " " TO pgL2, ptC1
                STORE CTOD(" ") TO pfVe
                STORE ptGe TO ptOt
                STORE "D" TO ptPc
                STORE ctD1 TO ptD3
                DO CASE
                     CASE ctD1="FA" .OR. ctD1="FE" .OR. ctD1="FC"
                          STORE "FT" TO ptD1
                          STORE "CAJA "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                          DO CASE
                               CASE ptD3="FE"
                                    STORE "CAJA "+ptD1+":F"+csR1+"-"+cfAc  ;
                                     TO pgLo
                               CASE ptD3="FC"
                                    STORE "CAJA "+ptD1+":E"+csR1+"-"+cfAc  ;
                                     TO pgLo
                          ENDCASE
                     CASE ctD1="BO" .OR. ctD1="BE" .OR. ctD1="BC"
                          STORE "BV" TO ptD1
                          STORE "CAJA "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                          DO CASE
                               CASE ptD3="BE"
                                    STORE "CAJA "+ptD1+":B"+csR1+"-"+cfAc  ;
                                     TO pgLo
                               CASE ptD3="BC"
                                    STORE "CAJA "+ptD1+":EB"+SUBSTR(csR1,  ;
                                     2, 2)+"-"+cfAc TO pgLo
                          ENDCASE
                ENDCASE
                STORE csR1 TO psR1
                STORE cfAc TO pfAc
                STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
                STORE "1011111" TO pcTa
                STORE " " TO pcAn
                IF pmOn=2
                     STORE "ME" TO pmNd
                ELSE
                     STORE "MN" TO pmNd
                ENDIF
                DO cjJ_0001a
                DO CASE
                     CASE pvTa="1"
                          SELECT deT_caja
                     CASE pvTa="2"
                          SELECT deT_caja2
                     CASE pvTa="3"
                          SELECT deT_caja3
                     CASE pvTa="4"
                          SELECT deT_caja4
                     CASE pvTa="5"
                          SELECT deT_caja5
                ENDCASE
           ENDIF
           STORE f3511tdo TO ctD1
           STORE f3511sr1 TO csR1
           STORE f3511doc TO cfAc
           STORE 0 TO ptGe
           STORE pnUm+1 TO pnUm
      ENDIF
      STORE f3511ser TO psEr
      STORE f3511num TO pnU1
      STORE f3511tdo TO ptD1
      STORE f3511sr1 TO psR1
      STORE f3511doc TO pfAc
      STORE f3511pag TO ptOt
      DO CASE
           CASE pvTa="1"
                SELECT caB_fact
           CASE pvTa="2"
                SELECT caB_fact2
           CASE pvTa="3"
                SELECT caB_fact3
           CASE pvTa="4"
                SELECT caB_fact4
           CASE pvTa="5"
                SELECT caB_fact5
      ENDCASE
      SEEK ptD1+psR1+pfAc
      IF maDm<>1
           mkEy = INKEY(50)
      ENDIF
      STORE f1300fem TO pfEm
      STORE f1300fem+f1300dia TO pfVe
      STORE ptD1 TO ptD3
      DO CASE
           CASE ptD1="FA" .OR. ptD1="FE" .OR. ptD1="FC"
                STORE "FT" TO ptD1
                STORE f1300ruc TO pcLi
           CASE (ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC") .AND.  ;
                LEN(ALLTRIM(f1300ele))>7 .AND. VAL(f1300ele)>0 .AND.  ;
                VAL(f1300ele)<99999999
                STORE "BV" TO ptD1
                STORE f1300ele TO pcLi
           CASE ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC"
                STORE "BV" TO ptD1
                STORE "99999999999" TO pcLi
      ENDCASE
      STORE " " TO pgLo
      STORE "Pago de "+ptD1+":"+psR1+"-"+pfAc TO pgL2
      DO CASE
           CASE ptD3="FE"
                STORE "Pago de "+ptD1+":F"+psR1+"-"+pfAc TO pgL2
           CASE ptD3="BE"
                STORE "Pago de "+ptD1+":B"+psR1+"-"+pfAc TO pgL2
           CASE ptD3="FC"
                STORE "Pago de "+ptD1+":E"+psR1+"-"+pfAc TO pgL2
           CASE ptD3="BC"
                STORE "Pago de "+ptD1+":EB"+SUBSTR(psR1, 2, 2)+"-"+pfAc TO pgL2
      ENDCASE
      DO CASE
           CASE pvTa="1"
                SELECT caB_caja
           CASE pvTa="2"
                SELECT caB_caja2
           CASE pvTa="3"
                SELECT caB_caja3
           CASE pvTa="4"
                SELECT caB_caja4
           CASE pvTa="5"
                SELECT caB_caja5
      ENDCASE
      SEEK vaNo+vmEs+psEr+pnU1
      IF maDm<>1
           mkEy = INKEY(50)
      ENDIF
      IF EOF() .OR. f3510tpo<>3 .OR. f3510est="9" .OR. f3510tip<>"03"
           DO CASE
                CASE pvTa="1"
                     SELECT deT_caja
                CASE pvTa="2"
                     SELECT deT_caja2
                CASE pvTa="3"
                     SELECT deT_caja3
                CASE pvTa="4"
                     SELECT deT_caja4
                CASE pvTa="5"
                     SELECT deT_caja5
           ENDCASE
           SKIP
           IF maDm<>1
                mkEy = INKEY(50)
           ENDIF
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Caja..."+psEr+"-"+pnU1+" "+ptD1+ ;
        ":"+psR1+"-"+pfAc STYLE "BQ" SIZE 1, 50
      STORE CTOD(f3510dia+"/"+vmEs+"/"+vaNo) TO pfEm
      STORE f3510dia TO pdIa
      STORE f3510mon TO pmOn
      STORE f3510tip TO ptIp
      STORE "H" TO ptPc
      IF pmOn=2
           STORE "ME" TO pmNd
           STORE "1212112" TO pcTa
      ELSE
           STORE "MN" TO pmNd
           STORE "1212111" TO pcTa
      ENDIF
      SELECT caMbio
      SEEK pfEm
      IF  .NOT. EOF()
           STORE f9111tc1 TO ptCa
      ELSE
           STORE 3.30 TO ptCa
      ENDIF
      STORE ALLTRIM(STR(ptCa, 5, 3)) TO ptC1
      IF pmOn=2
           STORE ROUND(ptOt*ptCa, 2) TO ptOt
      ENDIF
      STORE ptGe+ptOt TO ptGe
      STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
      STORE "008" TO pcAn
      DO cjJ_0001a
      DO CASE
           CASE pvTa="1"
                SELECT deT_caja
           CASE pvTa="2"
                SELECT deT_caja2
           CASE pvTa="3"
                SELECT deT_caja3
           CASE pvTa="4"
                SELECT deT_caja4
           CASE pvTa="5"
                SELECT deT_caja5
      ENDCASE
      SKIP
      IF maDm<>1
           mkEy = INKEY(50)
      ENDIF
 ENDDO
 IF ptGe<>0
      STORE " " TO pgL2, ptC1
      STORE CTOD(" ") TO pfVe
      STORE ptGe TO ptOt
      STORE "D" TO ptPc
      STORE ctD1 TO ptD3
      DO CASE
           CASE ctD1="FA" .OR. ctD1="FE" .OR. ctD1="FC"
                STORE "FT" TO ptD1
                STORE "CAJA "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                DO CASE
                     CASE ptD3="FE"
                          STORE "CAJA "+ptD1+":F"+csR1+"-"+cfAc TO pgLo
                     CASE ptD3="FC"
                          STORE "CAJA "+ptD1+":E"+csR1+"-"+cfAc TO pgLo
                ENDCASE
           CASE ctD1="BO" .OR. ctD1="BE" .OR. ctD1="BC"
                STORE "BV" TO ptD1
                STORE "CAJA "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                DO CASE
                     CASE ptD3="BE"
                          STORE "CAJA "+ptD1+":B"+csR1+"-"+cfAc TO pgLo
                     CASE ptD3="BC"
                          STORE "CAJA "+ptD1+":EB"+SUBSTR(csR1, 2, 2)+"-"+ ;
                                cfAc TO pgLo
                ENDCASE
      ENDCASE
      STORE csR1 TO psR1
      STORE cfAc TO pfAc
      STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
      STORE "1011111" TO pcTa
      STORE " " TO pcAn
      IF pmOn=2
           STORE "ME" TO pmNd
      ELSE
           STORE "MN" TO pmNd
      ENDIF
      DO cjJ_0001a
 ENDIF
ENDPROC
*
PROCEDURE Bc1_0001a
 PARAMETER pvTa
 DO CASE
      CASE pvTa="1"
           SELECT caB_fact
      CASE pvTa="2"
           SELECT caB_fact2
      CASE pvTa="3"
           SELECT caB_fact3
      CASE pvTa="4"
           SELECT caB_fact4
      CASE pvTa="5"
           SELECT caB_fact5
 ENDCASE
 SET ORDER TO F1300DOC
 DO CASE
      CASE pvTa="1"
           SELECT deT_bancos
      CASE pvTa="2"
           SELECT deT_bancos2
      CASE pvTa="3"
           SELECT deT_bancos3
      CASE pvTa="4"
           SELECT deT_bancos4
      CASE pvTa="5"
           SELECT deT_bancos5
 ENDCASE
 DO coLbln
 GOTO TOP
 SEEK vaNo+vmEs
 STORE " " TO ctD1, csR1, cfAc
 DO WHILE  .NOT. EOF() .AND. f3531ano+f3531mes=vaNo+vmEs
      IF f3531tdo<>"FA" .AND. f3531tdo<>"BO" .AND. f3531tdo<>"BC" .AND.  ;
         f3531tdo<>"BE" .AND. f3531tdo<>"FC" .AND. f3531tdo<>"FE"
           SKIP
           LOOP
      ENDIF
      IF f3531tdo+f3531sr1+f3531doc<>ctD1+csR1+cfAc
           IF ptGe<>0
                STORE " " TO pgL2, ptC1
                STORE CTOD(" ") TO pfVe
                STORE ptGe TO ptOt
                STORE "D" TO ptPc
                STORE ctD1 TO ptD3
                DO CASE
                     CASE ctD1="FA" .OR. ctD1="FE" .OR. ctD1="FC"
                          STORE "FT" TO ptD1
                          STORE "BCOS "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                          DO CASE
                               CASE ptD3="FE"
                                    STORE "BCOS "+ptD1+":F"+csR1+"-"+cfAc  ;
                                     TO pgLo
                               CASE ptD3="FC"
                                    STORE "BCOS "+ptD1+":E"+csR1+"-"+cfAc  ;
                                     TO pgLo
                          ENDCASE
                     CASE ctD1="BO" .OR. ctD1="BE" .OR. ctD1="BC"
                          STORE "BV" TO ptD1
                          STORE "BCOS "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                          DO CASE
                               CASE ptD3="BE"
                                    STORE "BCOS "+ptD1+":B"+csR1+"-"+cfAc  ;
                                     TO pgLo
                               CASE ptD3="BC"
                                    STORE "BCOS "+ptD1+":EB"+SUBSTR(csR1,  ;
                                     2, 2)+"-"+cfAc TO pgLo
                          ENDCASE
                ENDCASE
                STORE csR1 TO psR1
                STORE cfAc TO pfAc
                STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
                STORE "1011111" TO pcTa
                DO CASE
                     CASE ptIp="03"
                          STORE "001" TO pcAn
                     CASE ptIp="04"
                          STORE "007" TO pcAn
                     CASE ptIp="05"
                          STORE "001" TO pcAn
                     CASE ptIp="06"
                          STORE "005" TO pcAn
                     CASE ptIp="07"
                          STORE "005" TO pcAn
                     CASE ptIp="08"
                          STORE "001" TO pcAn
                ENDCASE
                IF pmOn=2
                     STORE "ME" TO pmNd
                     STORE "1041112" TO pcTa
                ELSE
                     STORE "MN" TO pmNd
                     STORE "1041111" TO pcTa
                ENDIF
                DO cjJ_0001a
                DO CASE
                     CASE pvTa="1"
                          SELECT deT_bancos
                     CASE pvTa="2"
                          SELECT deT_bancos2
                     CASE pvTa="3"
                          SELECT deT_bancos3
                     CASE pvTa="4"
                          SELECT deT_bancos4
                     CASE pvTa="5"
                          SELECT deT_bancos5
                ENDCASE
           ENDIF
           STORE f3531tdo TO ctD1
           STORE f3531sr1 TO csR1
           STORE f3531doc TO cfAc
           STORE 0 TO ptGe
           STORE pnUm+1 TO pnUm
      ENDIF
      STORE f3531ser TO psEr
      STORE f3531num TO pnU1
      STORE f3531tdo TO ptD1
      STORE f3531sr1 TO psR1
      STORE f3531doc TO pfAc
      STORE f3531pag TO ptOt
      DO CASE
           CASE pvTa="1"
                SELECT caB_fact
           CASE pvTa="2"
                SELECT caB_fact2
           CASE pvTa="3"
                SELECT caB_fact3
           CASE pvTa="4"
                SELECT caB_fact4
           CASE pvTa="5"
                SELECT caB_fact5
      ENDCASE
      SEEK ptD1+psR1+pfAc
      STORE f1300fem TO pfEm
      STORE f1300fem+f1300dia TO pfVe
      STORE ptD1 TO ptD3
      DO CASE
           CASE ptD1="FA" .OR. ptD1="FE" .OR. ptD1="FC"
                STORE "FT" TO ptD1
                STORE f1300ruc TO pcLi
           CASE (ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC") .AND.  ;
                LEN(ALLTRIM(f1300ele))>7 .AND. VAL(f1300ele)>0 .AND.  ;
                VAL(f1300ele)<99999999
                STORE "BV" TO ptD1
                STORE f1300ele TO pcLi
           CASE ptD1="BO" .OR. ptD1="BE" .OR. ptD1="BC"
                STORE "BV" TO ptD1
                STORE "99999999999" TO pcLi
      ENDCASE
      STORE " " TO pgLo
      STORE "BCOS "+ptD1+":"+psR1+"-"+pfAc TO pgL2
      DO CASE
           CASE ptD3="FE"
                STORE "BCOS "+ptD1+":F"+csR1+"-"+cfAc TO pgL2
           CASE ptD3="FC"
                STORE "BCOS "+ptD1+":E"+csR1+"-"+cfAc TO pgL2
           CASE ptD3="BE"
                STORE "BCOS "+ptD1+":B"+csR1+"-"+cfAc TO pgL2
           CASE ptD3="BC"
                STORE "BCOS "+ptD1+":EB"+SUBSTR(csR1, 2, 2)+"-"+cfAc TO pgL2
      ENDCASE
      DO CASE
           CASE pvTa="1"
                SELECT caB_bancos
           CASE pvTa="2"
                SELECT caB_bancos2
           CASE pvTa="3"
                SELECT caB_bancos3
           CASE pvTa="4"
                SELECT caB_bancos4
           CASE pvTa="5"
                SELECT caB_bancos5
      ENDCASE
      SEEK vaNo+vmEs+psEr+pnU1
      IF EOF() .OR. f3530tpo<>4 .OR. f3530est="9" .OR. f3530tip<"03" .OR.  ;
         f3530tip>"08"
           DO CASE
                CASE pvTa="1"
                     SELECT deT_bancos
                CASE pvTa="2"
                     SELECT deT_bancos2
                CASE pvTa="3"
                     SELECT deT_bancos3
                CASE pvTa="4"
                     SELECT deT_bancos4
                CASE pvTa="5"
                     SELECT deT_bancos5
           ENDCASE
           SKIP
           LOOP
      ENDIF
      @ mfI0+14.6, mcO0+6 SAY "Procesando Bancos..."+psEr+"-"+pnU1+" "+ ;
        ptD1+":"+psR1+"-"+pfAc STYLE "BQ" SIZE 1, 50
      STORE CTOD(f3530dia+"/"+vmEs+"/"+vaNo) TO pfEm
      STORE f3530dia TO pdIa
      STORE f3530mon TO pmOn
      STORE f3530tip TO ptIp
      STORE "H" TO ptPc
      IF pmOn=2
           STORE "ME" TO pmNd
           STORE "1212112" TO pcTa
      ELSE
           STORE "MN" TO pmNd
           STORE "1212111" TO pcTa
      ENDIF
      SELECT caMbio
      SEEK pfEm
      IF  .NOT. EOF()
           STORE f9111tc1 TO ptCa
      ELSE
           STORE 3.30 TO ptCa
      ENDIF
      STORE ALLTRIM(STR(ptCa, 5, 3)) TO ptC1
      IF pmOn=2
           STORE ROUND(ptOt*ptCa, 2) TO ptOt
      ENDIF
      STORE ptGe+ptOt TO ptGe
      STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
      STORE " " TO pcAn
      DO cjJ_0001a
      DO CASE
           CASE pvTa="1"
                SELECT deT_bancos
           CASE pvTa="2"
                SELECT deT_bancos2
           CASE pvTa="3"
                SELECT deT_bancos3
           CASE pvTa="4"
                SELECT deT_bancos4
           CASE pvTa="5"
                SELECT deT_bancos5
      ENDCASE
      SKIP
 ENDDO
 IF ptGe<>0
      STORE " " TO pgL2, ptC1
      STORE CTOD(" ") TO pfVe
      STORE ptGe TO ptOt
      STORE "D" TO ptPc
      STORE ctD1 TO ptD3
      DO CASE
           CASE ctD1="FA" .OR. ctD1="FE" .OR. ctD1="FC"
                STORE "FT" TO ptD1
                STORE "BCOS "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                DO CASE
                     CASE ptD3="FE"
                          STORE "BCOS "+ptD1+":F"+csR1+"-"+cfAc TO pgLo
                     CASE ptD3="FC"
                          STORE "BCOS "+ptD1+":E"+csR1+"-"+cfAc TO pgLo
                ENDCASE
           CASE ctD1="BO" .OR. ctD1="BE" .OR. ctD1="BC"
                STORE "BV" TO ptD1
                STORE "BCOS "+ptD1+":"+csR1+"-"+cfAc TO pgLo
                DO CASE
                     CASE ptD3="BE"
                          STORE "BCOS "+ptD1+":B"+csR1+"-"+cfAc TO pgLo
                     CASE ptD3="BC"
                          STORE "BCOS "+ptD1+":EB"+SUBSTR(csR1, 2, 2)+"-"+ ;
                                cfAc TO pgLo
                ENDCASE
      ENDCASE
      STORE csR1 TO psR1
      STORE cfAc TO pfAc
      STORE ALLTRIM(STR(ptOt, 12, 2)) TO ptOt
      IF pmOn=2
           STORE "ME" TO pmNd
           STORE "1041112" TO pcTa
      ELSE
           STORE "MN" TO pmNd
           STORE "1041111" TO pcTa
      ENDIF
      STORE " " TO pcAn
      DO CASE
           CASE ptIp="03"
                STORE "001" TO pcAn
           CASE ptIp="04"
                STORE "007" TO pcAn
           CASE ptIp="05"
                STORE "001" TO pcAn
           CASE ptIp="06"
                STORE "005" TO pcAn
           CASE ptIp="07"
                STORE "005" TO pcAn
           CASE ptIp="08"
                STORE "001" TO pcAn
      ENDCASE
      DO cjJ_0001a
 ENDIF
ENDPROC
*
PROCEDURE CjJ_0001a
 SELECT teMporal_caja
 APPEND BLANK
 REPLACE fcTa WITH pcTa
 REPLACE faNomes WITH vaNo+vmEs
 REPLACE fsUb WITH psUb
 REPLACE fcOmpr WITH STRTRAN(STR(pnUm, 4, 0), " ", "0")
 REPLACE feMision WITH SUBSTR(DTOC(pfEm), 1, 2)+"/"+SUBSTR(DTOC(pfEm), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfEm), 9, 2)
 REPLACE faNexo WITH paNx
 REPLACE fcOdanx WITH pcLi
 REPLACE ftIpdoc WITH ptD1
 DO CASE
      CASE ptD3="FE"
           REPLACE fnUmdoc WITH "F"+psR1+" "+pfAc
      CASE ptD3="FC"
           REPLACE fnUmdoc WITH "E"+psR1+" "+pfAc
      CASE ptD3="BE"
           REPLACE fnUmdoc WITH "B"+psR1+" "+pfAc
      CASE ptD3="BC"
           REPLACE fnUmdoc WITH "BE"+SUBSTR(psR1, 2, 2)+" "+pfAc
      CASE ptD3="N1"
           REPLACE fnUmdoc WITH "F"+psR1+" "+pfAc
      CASE ptD3="N2"
           REPLACE fnUmdoc WITH "F"+psR1+" "+pfAc
      CASE ptD3="N3" .AND. psR1="E0"
           REPLACE fnUmdoc WITH "E0"+SUBSTR(psR1, 2, 2)+" "+pfAc
      CASE ptD3="N3" .AND. psR1="EB"
           REPLACE fnUmdoc WITH "EB0"+SUBSTR(psR1, 3, 1)+" "+pfAc
      CASE ptD3="N4" .AND. psR1="E0"
           REPLACE fnUmdoc WITH "E0"+SUBSTR(psR1, 2, 2)+" "+pfAc
      CASE ptD3="N4" .AND. psR1="EB"
           REPLACE fnUmdoc WITH "EB0"+SUBSTR(psR1, 3, 1)+" "+pfAc
      OTHERWISE
           REPLACE fnUmdoc WITH " "+psR1+" "+pfAc
 ENDCASE
 DO CASE
      CASE DTOC(pfVe)=" "
           REPLACE fvEncim WITH " "
      OTHERWISE
           REPLACE fvEncim WITH SUBSTR(DTOC(pfVe), 1, 2)+"/"+ ;
                   SUBSTR(DTOC(pfVe), 4, 2)+"/"+SUBSTR(DTOC(pfVe), 9, 2)
 ENDCASE
 REPLACE fmOn WITH pmNd
 REPLACE ftOtal WITH ptOt
 REPLACE fcOnv WITH pcOn
 REPLACE frEgis WITH SUBSTR(DTOC(pfEm), 1, 2)+"/"+SUBSTR(DTOC(pfEm), 4,  ;
         2)+"/"+SUBSTR(DTOC(pfEm), 9, 2)
 REPLACE ftPocam WITH ptC1
 REPLACE fgLosa WITH pgLo
 REPLACE fcEncos WITH pcCo
 REPLACE fgLomov WITH pgL2
 REPLACE faNulad WITH peSt
 REPLACE fdEbhab WITH ptPc
 REPLACE fmEdpag WITH pcAn
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE vtAb, vaNo, vmEs, vcOd, vpT2, vpT3, vpT4, vpT5, vaL2, vaL3, vaL4,  ;
         vaL5, vdBf
 RELEASE urEc, vnO2, vnO3, vnO4, vnO5
 RELEASE vpAn_99
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "N"
 DO deL_file2 WITH "3", "S"
 DO deL_file2 WITH "4", "S"
 DO deL_file2 WITH "5", "N"
 RELEASE ntM1, ntM2, ntM3, ntM4, ntM5
ENDPROC
*
