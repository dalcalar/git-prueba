 SET CENTURY ON
 STORE 01 TO meRr
 STORE 99 TO mkEy
 SELECT 1
 DO abR_0000a IN PUX0000A WITH "2111", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Productos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F2111COD
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 DO abR_0000a IN PUX0000A WITH "2112", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Series
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 DO abR_0000a IN PUX0000A WITH "2106", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Lista
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 DO abR_0000a IN PUX0000A WITH "2401", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 DO abR_0000a IN PUX0000A WITH "2402", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 DO abR_0000a IN PUX0000A WITH "2403", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Cpra
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 DO abR_0000a IN PUX0000A WITH "2601", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Remi
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 DO abR_0000a IN PUX0000A WITH "2602", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Remi
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 DO abR_0000a IN PUX0000A WITH "2603", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Remi
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 DO abR_0000a IN PUX0000A WITH "2604", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Con_Remi
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 11
 DO abR_0000a IN PUX0000A WITH "2701", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Ingr
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 12
 DO abR_0000a IN PUX0000A WITH "2702", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Ingr
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 13
 DO abR_0000a IN PUX0000A WITH "2703", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Ingr
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 14
 DO abR_0000a IN PUX0000A WITH "2801", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Sali
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 15
 DO abR_0000a IN PUX0000A WITH "2802", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Sali
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 16
 DO abR_0000a IN PUX0000A WITH "2803", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Sali
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 17
 DO abR_0000a IN PUX0000A WITH "2911", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Orden
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 18
 DO abR_0000a IN PUX0000A WITH "2920", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Cab_Conjuntos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 19
 DO abR_0000a IN PUX0000A WITH "2921", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Conjuntos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 20
 DO abR_0000a IN PUX0000A WITH "2922", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Alt_Conjuntos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 21
 DO abR_0000a IN PUX0000A WITH "2990", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Kardex
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 22
 DO abR_0000a IN PUX0000A WITH "2991", "A"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Kardex_Series
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 23
 DO abR_0000a IN PUX0000A WITH "1201", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Ped
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 24
 DO abR_0000a IN PUX0000A WITH "1202", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Ped
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 25
 DO abR_0000a IN PUX0000A WITH "1203", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Ped
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 26
 DO abR_0000a IN PUX0000A WITH "1204", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Con_Ped
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 27
 DO abR_0000a IN PUX0000A WITH "1301", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Det_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 28
 DO abR_0000a IN PUX0000A WITH "1302", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ite_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 29
 DO abR_0000a IN PUX0000A WITH "1303", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Ser_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 30
 DO abR_0000a IN PUX0000A WITH "1304", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Exclusive Alias Con_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 31
 DO prO_virtual
 STORE 00 TO meRr
 PUBLIC viTe, vaNt, vnUe, vfFr, ifFr, ufFr, ffFr, cfFr, vsWw, csWw, vsWr,  ;
        vcL0, vcDg
 PUBLIC icDg, ucDg, ccDg, vcD1, vdEs, vdCr, vcOd, ccOd, vdCc, idCc, udCc,  ;
        cdCc, ctPo
 PUBLIC csTo, ctPo, vfB1, vcB1, vfB2, vcB2, vfB3, vcB3, vfB4, vcB4
 PUBLIC vpAn_11
 STORE SPACE(mtMa) TO vaNt, vnUe
 STORE 01 TO viTe
 STORE 99 TO mkEy
 SET READBORDER ON
 DO p00_9996a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO p00_9996a WITH "1"
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_9996a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE (mkEy=k_F2 .OR. mkEy=k_F3 .OR. mkEy=k_F4) .AND. viTe=1
                = INKEY(0.01)
                DO CASE
                     CASE mkEy=k_F2
                          STORE 2 TO vsWw
                          STORE 1 TO vsWr
                          DO prEsiona WITH "2", "CONSU0", vfB1, vcB1
                     CASE mkEy=k_F3
                          STORE 2 TO vsWw
                          STORE 2 TO vsWr
                          DO prEsiona WITH "2", "BUSCA0", vfB2, vcB2
                     CASE mkEy=k_F4
                          STORE 1 TO vsWw
                          STORE 1 TO vsWr
                ENDCASE
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                SAVE SCREEN TO vpAn_11
                DO paC2111w WITH "A"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                RESTORE SCREEN FROM vpAn_11
                DO prEsiona WITH "1", "CONSU0", vfB1, vcB1
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                DO prEsiona WITH "1", "BUSCA0", vfB2, vcB2
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy=k_Enter
                     STORE vcDg TO vaNt
                ENDIF
           CASE (mkEy=k_F2 .OR. mkEy=k_F3 .OR. mkEy=k_F4) .AND. viTe=2
                = INKEY(0.01)
                DO CASE
                     CASE mkEy=k_F2
                          STORE 2 TO vsWw
                          STORE 1 TO vsWr
                          DO prEsiona WITH "2", "CONSU0", vfB3, vcB3
                     CASE mkEy=k_F3
                          STORE 2 TO vsWw
                          STORE 2 TO vsWr
                          DO prEsiona WITH "2", "BUSCA0", vfB4, vcB4
                     CASE mkEy=k_F4
                          STORE 1 TO vsWw
                          STORE 1 TO vsWr
                ENDCASE
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                SAVE SCREEN TO vpAn_11
                DO paC2111w WITH "B"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                RESTORE SCREEN FROM vpAn_11
                DO orD_0000a WITH "2111", "A", "F2111COD", "A"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                DO prEsiona WITH "1", "CONSU0", vfB3, vcB3
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                DO prEsiona WITH "1", "BUSCA0", vfB4, vcB4
                IF mkEy=k_Esc
                     EXIT
                ENDIF
                IF mkEy=k_Enter
                     STORE vcDg TO vnUe
                ENDIF
      ENDCASE
      DO CASE
           CASE mkEy=k_F1
                DO hl1_9996a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO p00_9996a WITH "1"
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc .AND. viTe=01
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Ctrl_home .AND. viTe=01
                STORE "Estás en el primer campo...    " TO mmSj
           CASE mkEy=k_Ctrl_end .AND. viTe=02
                STORE "Estás en el último campo...    " TO mmSj
           CASE mkEy=k_Ctrl_left
                STORE "No hay campos a la izquierda..." TO mmSj
           CASE mkEy=k_Up .AND. viTe=01
                STORE "No hay más campos arriba...    " TO mmSj
           CASE mkEy=k_Esc .OR. mkEy=k_Ctrl_home
                STORE 99 TO mkEy
                STORE 01 TO viTe
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Ctrl_right .OR.  ;
                mkEy=k_Ctrl_end
                DO veR_9996a
                IF mkEy<>99
                     IF viTe=02
                          STORE 99 TO mkEy
                     ELSE
                          STORE viTe+1 TO viTe
                     ENDIF
                ENDIF
           CASE mkEy=k_Up
                STORE viTe-1 TO viTe
           CASE mkEy=k_Tab
                DO veR_9996a
                IF mkEy<>99 .AND. viTe<02
                     STORE 02 TO viTe
                     DO veR_9996a
                ENDIF
                IF mkEy<>99
                     DO caM_9996a
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     STORE 99 TO mkEy
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      STORE k_Enter TO mkEy
      DO coLbln
      DO CASE
           CASE viTe=01
                @mFI0+1,mCO0+26 Get vANT Font "&mLetRom",12 Style "BQ" Size 1,18 Pict "@S20" Color ,&mColBlN
           CASE viTe=02
                @mFI0+3,mCO0+26 Get vNUE Font "&mLetRom",12 Style "BQ" Size 1,18 Pict "@S20" Color ,&mColBlN
      ENDCASE
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE Ver_9996a
 STORE SPACE(100) TO mmSj
 DO CASE
      CASE viTe=01 .AND. LEN(ALLTRIM(vaNt))=0
           STORE "Código no puede estar vacío..." TO mmSj
      CASE viTe=01
           DO coL_beige
           SELECT prOductos
           SEEK ALLTRIM(vaNt)+"*"
           IF EOF()
                STORE "Código de Producto antiguo no registrado..." TO mmSj
                @mFI0+1.1,mCO0+61 Say " "      Font "&mLetAri",10 Style "NQ" Size 1,50 Pict "@S52"
           ELSE
                DO coL_beige
                @mFI0+1.1,mCO0+61 Say F2111DES Font "&mLetAri",10 Style "NQ" Size 1,50 Pict "@S52"
           ENDIF
           DO coLbln
           @mFI0+1,mCO0+26 Say vANT Font "&mLetRom",12 Style "BQ" Size 1,18 Pict "@S15"
      CASE viTe=02 .AND. ALLTRIM(vaNt)+"*"=ALLTRIM(vnUe)+"*"
           STORE "Código de Producto antiguo no puede ser igual al nuevo..."  ;
                 TO mmSj
      CASE viTe=02 .AND. LEN(ALLTRIM(vnUe))=0
           STORE "Código no puede estar vacío..." TO mmSj
      CASE viTe=02
           DO coL_beige
           SELECT prOductos
           SEEK ALLTRIM(vnUe)+"*"
           IF EOF()
                STORE "Código de Producto nuevo no registrado..." TO mmSj
                @mFI0+3.1,mCO0+61 Say " "      Font "&mLetAri",10 Style "NQ" Size 1,50 Pict "@S52"
           ELSE
                @mFI0+3.1,mCO0+61 Say F2111DES Font "&mLetAri",10 Style "NQ" Size 1,50 Pict "@S52"
           ENDIF
           DO coLbln
           @mFI0+3,mCO0+26 Say vNUE Font "&mLetRom",12 Style "BQ" Size 1,18 Pict "@S15"
 ENDCASE
 IF LEN(ALLTRIM(mmSj))<>0
      DO poNmsj
      STORE 99 TO mkEy
 ENDIF
ENDPROC
*
PROCEDURE Cam_9996a
 DO coL_fondo
 @mFI0+5,mCO0+1 Say "Series"                       Font "&mLetCou",8 Style "NQ"
 SELECT seRies
 REPLACE f2112cod WITH vnUe FOR ALLTRIM(f2112cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+6,mCO0+1 Say "Lista de Precios Proveedores" Font "&mLetCou",8 Style "NQ"
 SELECT deT_lista
 REPLACE f2106cod WITH vnUe FOR ALLTRIM(f2106cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+7,mCO0+1 Say "Ordenes de Compra"            Font "&mLetCou",8 Style "NQ"
 SELECT deT_orden
 REPLACE f2911cod WITH vnUe FOR ALLTRIM(f2911cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+8,mCO0+1 Say "Conjuntos"                    Font "&mLetCou",8 Style "NQ"
 SELECT caB_conjuntos
 REPLACE f2920cod WITH vnUe FOR ALLTRIM(f2920cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT deT_conjuntos
 REPLACE f2921cod WITH vnUe FOR ALLTRIM(f2921cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2921cdg WITH vnUe FOR ALLTRIM(f2921cdg)+"*"=ALLTRIM(vaNt)+"*"
 SELECT alT_conjuntos
 REPLACE f2922cod WITH vnUe FOR ALLTRIM(f2922cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2922cdg WITH vnUe FOR ALLTRIM(f2922cdg)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2922alt WITH vnUe FOR ALLTRIM(f2922alt)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+9,mCO0+1 Say "Compras"                      Font "&mLetCou",8 Style "NQ"
 SELECT deT_cpra
 REPLACE f2401cod WITH vnUe FOR ALLTRIM(f2401cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_cpra
 REPLACE f2402cod WITH vnUe FOR ALLTRIM(f2402cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_cpra
 REPLACE f2403cod WITH vnUe FOR ALLTRIM(f2403cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+10,mCO0+1 Say "Guías de Remisión"           Font "&mLetCou",8 Style "NQ"
 SELECT deT_remi
 REPLACE f2601cod WITH vnUe FOR ALLTRIM(f2601cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_remi
 REPLACE f2602cod WITH vnUe FOR ALLTRIM(f2602cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_remi
 REPLACE f2603cod WITH vnUe FOR ALLTRIM(f2603cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT coN_remi
 REPLACE f2604cod WITH vnUe FOR ALLTRIM(f2604cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2604cdg WITH vnUe FOR ALLTRIM(f2604cdg)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+11,mCO0+1 Say "Entradas de Almacén"         Font "&mLetCou",8 Style "NQ"
 SELECT deT_ingr
 REPLACE f2701cod WITH vnUe FOR ALLTRIM(f2701cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2701cdg WITH vnUe FOR ALLTRIM(f2701cdg)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_ingr
 REPLACE f2702cod WITH vnUe FOR ALLTRIM(f2702cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_ingr
 REPLACE f2703cod WITH vnUe FOR ALLTRIM(f2703cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+12,mCO0+1 Say "Salidas de Almacén"          Font "&mLetCou",8 Style "NQ"
 SELECT deT_sali
 REPLACE f2801cod WITH vnUe FOR ALLTRIM(f2801cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f2801cdg WITH vnUe FOR ALLTRIM(f2801cdg)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_sali
 REPLACE f2802cod WITH vnUe FOR ALLTRIM(f2802cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_sali
 REPLACE f2803cod WITH vnUe FOR ALLTRIM(f2803cod)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+13,mCO0+1 Say "Pedidos"                     Font "&mLetCou",8 Style "NQ"
 SELECT deT_ped
 REPLACE f1201cod WITH vnUe FOR ALLTRIM(f1201cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_ped
 REPLACE f1202cod WITH vnUe FOR ALLTRIM(f1202cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_ped
 REPLACE f1203cod WITH vnUe FOR ALLTRIM(f1203cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT coN_ped
 REPLACE f1204cod WITH vnUe FOR ALLTRIM(f1204cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f1204cdg WITH vnUe FOR ALLTRIM(f1204cdg)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+14,mCO0+1 Say "Facturas"                    Font "&mLetCou",8 Style "NQ"
 SELECT deT_fact
 REPLACE f1301cod WITH vnUe FOR ALLTRIM(f1301cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT itE_fact
 REPLACE f1302cod WITH vnUe FOR ALLTRIM(f1302cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT seR_fact
 REPLACE f1303cod WITH vnUe FOR ALLTRIM(f1303cod)+"*"=ALLTRIM(vaNt)+"*"
 SELECT coN_fact
 REPLACE f1304cod WITH vnUe FOR ALLTRIM(f1304cod)+"*"=ALLTRIM(vaNt)+"*"
 REPLACE f1304cdg WITH vnUe FOR ALLTRIM(f1304cdg)+"*"=ALLTRIM(vaNt)+"*"
 @mFI0+15,mCO0+18 Say "* * * * * Presionar una tecla para continuar * * * * *" Font "&mLetRom",14 Style "BT" Color 4
 mkEy = INKEY(0)
 @ mfI0+5, mcO0+1 CLEAR TO mfI0+muFi+0.5, mcO0+muCo-1
 STORE 1 TO viTe
ENDPROC
*
PROCEDURE P00_9996a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 STORE 16 TO muFi
 STORE 126 TO muCo
 STORE (mwFi-muFi)/2 TO mfI0
 STORE (mwCo-muCo)/2 TO mcO0, vcL0
 STORE mfI0+1 TO vfB1, vfB2
 STORE mfI0+3 TO vfB3, vfB4
 STORE mcO0+52 TO vcB1, vcB3
 STORE vcB1+4 TO vcB2, vcB4
 STORE mfI0+04 TO ifFr, ufFr, vfFr
 STORE ifFr+12 TO ffFr
 DO CASE
      CASE mrEs="2"
           STORE ffFr+3 TO ffFr
           STORE vcL0-10 TO vcL0
      CASE mrEs>"2"
           STORE ffFr+7 TO ffFr
           STORE vcL0-20 TO vcL0
 ENDCASE
 DO tiT_0000a WITH "Cambio de Códigos"
 DO coL_fondo
 DO cuAdro WITH mfI0, mcO0, mfI0+muFi+0.7, mcO0+muCo
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coL_boton
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 DO coL_fondo
 @mFI0+1,mCO0+01 Say "Código antiguo:" Font "&mLetRom",13 Style "BQ"
 @mFI0+3,mCO0+01 Say "Código nuevo:  " Font "&mLetRom",13 Style "BQ"
 @mFI0+1,mCO0+26 Get vANT              Font "&mLetRom",12 Style "BQ" Pict "@S20" Size 1,18 Color ,&mColBlN
 @mFI0+3,mCO0+26 Get vNUE              Font "&mLetRom",12 Style "BQ" Pict "@S20" Size 1,18 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO prEsiona WITH "4", "R_CONS20", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "CONSU0", vfB1, vcB1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "BUSCA0", vfB2, vcB2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "CONSU0", vfB3, vcB3
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "BUSCA0", vfB4, vcB4
 IF mkEy=k_Esc
      RETURN
 ENDIF
ENDPROC
*
PROCEDURE Clp_9996a
 = INKEY(0.01)
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Tab TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.80
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfB1+mfG1 .AND. mfIl<=vfB1+mfG2 .AND. mcCc>=vcB1+mcG1  ;
           .AND. mcCc<=vcB1+mcG2
           STORE 01 TO viTe
           STORE k_F2 TO mkEy
      CASE mfIl>=vfB2+mfG1 .AND. mfIl<=vfB2+mfG2 .AND. mcCc>=vcB2+mcG1  ;
           .AND. mcCc<=vcB2+mcG2
           STORE 01 TO viTe
           STORE k_F3 TO mkEy
      CASE mfIl>=vfB3+mfG1 .AND. mfIl<=vfB3+mfG2 .AND. mcCc>=vcB3+mcG1  ;
           .AND. mcCc<=vcB3+mcG2
           IF viTe<02
                DO veR_9996a
           ENDIF
           IF mkEy<>99 .AND. viTe<=02
                STORE 02 TO viTe
                STORE k_F2 TO mkEy
           ENDIF
      CASE mfIl>=vfB4+mfG1 .AND. mfIl<=vfB4+mfG2 .AND. mcCc>=vcB4+mcG1  ;
           .AND. mcCc<=vcB4+mcG2
           IF viTe<02
                DO veR_9996a
           ENDIF
           IF mkEy<>99 .AND. viTe<=02
                STORE 02 TO viTe
                STORE k_F3 TO mkEy
           ENDIF
      CASE mfIl>=mfI0+0.964 .AND. mfIl<=mfI0+2.535 .AND. mcCc>=mcO0+0.4  ;
           .AND. mcCc<=mcO0+51.6 .AND. viTe<>1
           STORE 01 TO viTe
           STORE 99 TO mkEy
      CASE mfIl>=mfI0+2.964 .AND. mfIl<=mfI0+4.535 .AND. mcCc>=mcO0+0.4  ;
           .AND. mcCc<=mcO0+51.6 .AND. viTe<>2
           IF viTe<02
                DO veR_9996a
           ENDIF
           IF mkEy<>99 .AND. viTe<=02
                STORE 02 TO viTe
           ENDIF
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
ENDPROC
*
PROCEDURE Hl1_9996a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0.2 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Este programa cambia un código de un producto x otro nuevo que ya de-"
 @ pfIl+01, 02 SAY  ;
   "be estar registrado en el Sistema, en todos los movimientos."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 22 SAY ":" STYLE "BT"
 @ pfIl+06, 22 SAY ":" STYLE "BT"
 @ pfIl+07, 22 SAY ":" STYLE "BT"
 @ pfIl+08, 22 SAY ":" STYLE "BT"
 @ pfIl+09, 22 SAY ":" STYLE "BT"
 @ pfIl+10, 22 SAY ":" STYLE "BT"
 @ pfIl+11, 22 SAY ":" STYLE "BT"
 @ pfIl+12, 22 SAY ":" STYLE "BT"
 @ pfIl+13, 22 SAY ":" STYLE "BT"
 @ pfIl+14, 22 SAY ":" STYLE "BT"
 @ pfIl+05, 03 SAY "ESC" STYLE "BT"
 @ pfIl+06, 03 SAY "F10" STYLE "BT"
 @ pfIl+07, 03 SAY "F1" STYLE "BT"
 @ pfIl+08, 03 SAY "F2" STYLE "BT"
 @ pfIl+09, 03 SAY "F3" STYLE "BT"
 @ pfIl+10, 03 SAY "F4" STYLE "BT"
 @ pfIl+11, 03 SAY "ENTER,CTRL ->," STYLE "BT"
 @ pfIl+12, 03 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+13, 03 SAY "FLECHA ARRIBA" STYLE "BT"
 @ pfIl+14, 03 SAY "TAB" STYLE "BT"
 @ pfIl+05, 24 SAY "Regresar al Menú Principal"
 @ pfIl+06, 24 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 24 SAY "Ayuda del Programa"
 @ pfIl+08, 24 SAY "Consultar Productos de orden alfabético"
 @ pfIl+09, 24 SAY "Consultar Productos de orden de códigos"
 @ pfIl+10, 24 SAY "Buscar palabra para en descripción de Producto"
 @ pfIl+11, 24 SAY "Pasar al siguiente campo"
 @ pfIl+12, 24 SAY "Pasar al siguiente campo"
 @ pfIl+13, 24 SAY "Campo anterior"
 @ pfIl+14, 24 SAY "Iniciar Proceso"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO deL_file1
 RELEASE viTe, vaNt, vnUe, vfFr, ifFr, ufFr, ffFr, cfFr, vsWw, csWw, vsWr,  ;
         vcL0, vcDg
 RELEASE icDg, ucDg, ccDg, vcD1, vdEs, vdCr, vcOd, ccOd, vdCc, idCc, udCc,  ;
         cdCc, ctPo
 RELEASE csTo, ctPo, vfB1, vcB1, vfB2, vcB2, vfB3, vcB3, vfB4, vcB4
 RELEASE vpAn_11
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
