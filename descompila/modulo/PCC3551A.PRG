 SET CENTURY ON
 PUBLIC afIl, x, ntM1, ntM2
 STORE "0000" TO ntM1
 STORE "0001" TO ntM2
 STORE 01 TO meRr
 DIMENSION afIl[29, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM1TDO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SER"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DOC"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FEM"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FVE"
 afIl[x, 2] = "D"
 afIl[x, 3] = 8
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CAJ"
 afIl[x, 2] = "N"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NOM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 70
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TCA"
 afIl[x, 2] = "N"
 afIl[x, 3] = 6
 afIl[x, 4] = 3
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MON"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TOT"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1MND"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1ACU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SLD"
 afIl[x, 2] = "N"
 afIl[x, 3] = 15
 afIl[x, 4] = 4
 STORE x+1 TO x
 afIl[x, 1] = "FTM1GRU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SR1"
 afIl[x, 2] = "C"
 afIl[x, 3] = 3
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NUM"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1TIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NTI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NVE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1GLO"
 afIl[x, 2] = "C"
 afIl[x, 3] = 80
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NBA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NCT"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1CHE"
 afIl[x, 2] = "C"
 afIl[x, 3] = 20
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1SRL"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1LET"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1RCB"
 afIl[x, 2] = "C"
 afIl[x, 3] = 7
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1DNC"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM1NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 50
 afIl[x, 4] = 0
 STORE "TM01"+ntM1+meXt TO mdBf
 DO WHILE .T.
      ntM1 = STRTRAN(STR(VAL(ntM1)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM1+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM1="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj, 2, 0)+ ;
       ftM1sr1+ftM1num TAG ftM1doc
 INDEX ON ftM1fpa+ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj,  ;
       2, 0)+ftM1sr1+ftM1num TAG ftM1fpa
 CLOSE DATABASES
 CLOSE INDEXES
 DIMENSION afIl[13, 4]
 STORE 1 TO x
 afIl[x, 1] = "FTM2CAJ"
 afIl[x, 2] = "N"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2GRU"
 afIl[x, 2] = "N"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TIP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NTI"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2FPA"
 afIl[x, 2] = "C"
 afIl[x, 3] = 2
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2NFP"
 afIl[x, 2] = "C"
 afIl[x, 3] = 30
 afIl[x, 4] = 0
 STORE x+1 TO x
 afIl[x, 1] = "FTM2HO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2OT1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO1"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2HO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2OT2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2TO2"
 afIl[x, 2] = "N"
 afIl[x, 3] = 12
 afIl[x, 4] = 2
 STORE x+1 TO x
 afIl[x, 1] = "FTM2EST"
 afIl[x, 2] = "C"
 afIl[x, 3] = 1
 afIl[x, 4] = 0
 STORE "TM01"+ntM2+meXt TO mdBf
 DO WHILE .T.
      ntM2 = STRTRAN(STR(VAL(ntM2)+1, 4, 0), " ", "0")
      STORE "TM01"+ntM2+meXt TO mdBf
      If .not.File("&mDBF")
           EXIT
      ENDIF
      IF ntM2="9999"
           STORE "Error: muchos Archivos Temporales..." TO mmSj
           DO poNmsj
           DO deL_file2 WITH "1", "S"
           RETURN
      ENDIF
 ENDDO
 CREATE TABLE (mdBf) FROM ARRAY afIl
 Use &mDBF Exclusive
 INDEX ON STR(ftM2caj, 2, 0)+STR(ftM2gru, 1, 0)+ftM2tip+ftM2fpa TAG ftM2caj
 INDEX ON ftM2tip+ftM2fpa+STR(ftM2caj, 2, 0)+STR(ftM2gru, 1, 0) TAG ftM2tip
 CLOSE DATABASES
 CLOSE INDEXES
 RELEASE afIl, x
 STORE 99 TO mkEy
 SELECT 1
 DO abR_0000a IN PUX0000A WITH "3110", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Letras
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3110FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 2
 DO abR_0000a IN PUX0000A WITH "3500", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Pend_Vtas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3500DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 3
 DO abR_0000a IN PUX0000A WITH "3510", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Ing_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3510FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 4
 DO abR_0000a IN PUX0000A WITH "3511", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Ing_Caja
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3511NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 5
 DO abR_0000a IN PUX0000A WITH "3530", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Ing_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3530FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 6
 DO abR_0000a IN PUX0000A WITH "3531", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Det_Ing_Bancos
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3531NUM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 7
 DO abR_0000a IN PUX0000A WITH "3610", "C"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Notas
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F3610FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 8
 DO abR_0000a IN PUX0000A WITH "1300", "V"
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 Use &mDBF Shared NoUpdate Alias Cab_Fact
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO F1300FEM
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 9
 STORE "TM01"+ntM1+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM1DOC
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SELECT 10
 STORE "TM01"+ntM2+meXt TO mdBf
 Use &mDBF Exclusive Alias Temporal_2
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 SET ORDER TO FTM2CAJ
 IF mkEy=k_Esc
      DO deL_file1
      RETURN
 ENDIF
 STORE 00 TO meRr
 PUBLIC vsW0, vsW1, vsW2, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
        ffFs, cfFs
 PUBLIC icLn, ucLn, icL1, ucL1, vcL1, vcL2, vcL3, vcL4, vcL5, vcL6, vfI1,  ;
        vfI2, vpAg
 PUBLIC vlIn, vtDo, itDo, utDo, ctDo, vsEr, isEr, usEr, csEr, vdOc, idOc,  ;
        udOc, cdOc
 PUBLIC vcAj, icAj, ucAj, ccAj, vgRu, igRu, ugRu, cgRu, vsR1, isR1, usR1,  ;
        csR1, vnUm
 PUBLIC inUm, unUm, cnUm, vgR1, igR1, ugR1, vcJj, icJj, ucJj, vtIp, itIp,  ;
        utIp, vfEc
 PUBLIC cfEc, vmOn, vmNd, vtCa, vgLo, vsRl, vlEt, vrCb, vpGo, vcHe, vaCu,  ;
        vtOt, xtOt
 PUBLIC vsLd, vfPa, ifPa, ufPa, vnFp, vnOm, vfEm, vnTi, vdNc, vsG1, vsG2,  ;
        vcJ1, vcJ2
 PUBLIC vcJ3, vcJ4, vcJ6, vcJ7, vcJ8, vcJ9, vcJa, vcJ0, vcJt, voPc, vtPo,  ;
        veF1, veF2
 PUBLIC veF3, veF4, vcH1, vcH2, vcH3, vcH4, vdP1, vdP2, vdP3, vdP4, voT1,  ;
        voT2, voT3
 PUBLIC voT4, vfA1, vfA2, vfA3, vfA4, vbO1, vbO2, vbO3, vbO4, vnP1, vnP2,  ;
        vnP3, vnP4
 PUBLIC vpE1, vpE2, vpE3, vpE4, vnC1, vnC2, vnC3, vnC4, vnD1, vnD2, vnD3,  ;
        vnD4, vnVe
 PUBLIC vxLs
 PUBLIC vpAn_11, vpAn_12
 STORE DATE() TO vfEc
 STORE CTOD("  /  /    ") TO cfEc
 STORE SPACE(02) TO vtDo, itDo, utDo
 STORE SPACE(03) TO vsEr, isEr, usEr
 STORE SPACE(03) TO vsR1, isR1, usR1
 STORE SPACE(07) TO vdOc, idOc, udOc
 STORE SPACE(07) TO vnUm, inUm, unUm
 STORE 00 TO vgRu, igRu, ugRu
 STORE 00 TO vcAj, icAj, ucAj, vcJ1, vcJ2, vcJ3, vcJ4
 STORE 00 TO vcJ5, vcJ6, vcJ7, vcJ8, vcJ9, vcJa, vcJ0
 STORE 00 TO veF1, veF2, veF3, veF4
 STORE 00 TO vcH1, vcH2, vcH3, vcH4
 STORE 00 TO vdP1, vdP2, vdP3, vdP4
 STORE 00 TO voT1, voT2, voT3, voT4
 STORE 00 TO vfA1, vfA2, vfA3, vfA4
 STORE 00 TO vbO1, vbO2, vbO3, vbO4
 STORE 00 TO vnP1, vnP2, vnP3, vnP4
 STORE 00 TO vpE1, vpE2, vpE3, vpE4
 STORE 00 TO vnC1, vnC2, vnC3, vnC4
 STORE 00 TO vnD1, vnD2, vnD3, vnD4
 STORE 01 TO vsW0, vsW1, vsW2, vcJt
 STORE 88 TO mpAg
 STORE 99 TO mkEy
 SET READBORDER ON
 DO p00_3551a WITH "0"
 IF mkEy=k_Esc
      DO deL_files
      RETURN
 ENDIF
 DO p1_0000a
 DO WHILE .T.
      DO reS_0000a
      IF mrEs<>mrSs
           DO reS_3551a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      IF mkEy=k_Clic
           DO clP_coo
           DO clP_3551a
           IF mkEy=k_Esc
                EXIT
           ENDIF
      ENDIF
      DO CASE
           CASE mkEy=k_F1
                DO hl1_3551a
           CASE mkEy=k_F10
                DO reTorna
           CASE mkEy=k_F12
                DO reS_3551a
                IF mkEy=k_Esc
                     EXIT
                ENDIF
           CASE mkEy=k_Esc
                STORE 99 TO mkEy
                EXIT
           CASE mkEy=k_Ctrl_right .OR. mkEy=k_Ctrl_left
                DO CASE
                     CASE mkEy=k_Ctrl_right .AND. vsW2=3
                          STORE 1 TO vsW2
                     CASE mkEy=k_Ctrl_right
                          STORE vsW2+1 TO vsW2
                     CASE mkEy=k_Ctrl_left .AND. vsW2=1
                          STORE 3 TO vsW2
                     CASE mkEy=k_Ctrl_left
                          STORE vsW2-1 TO vsW2
                ENDCASE
                DO caJ_3551a
                DO boT_3551a
           CASE mkEy=k_Enter .OR. mkEy=k_Down .OR. mkEy=k_Tab
                STORE k_Tab TO mkEy
                SELECT teMporal
                SET ORDER TO FTM1DOC
                IF vfEc<>cfEc
                     SELECT teMporal
                     ZAP
                     REINDEX
                     SELECT teMporal_2
                     ZAP
                     REINDEX
                     STORE 00 TO veF1, veF2, veF3, veF4
                     STORE 00 TO vcH1, vcH2, vcH3, vcH4
                     STORE 00 TO vdP1, vdP2, vdP3, vdP4
                     STORE 00 TO voT1, voT2, voT3, voT4
                     STORE 00 TO vfA1, vfA2, vfA3, vfA4
                     STORE 00 TO vbO1, vbO2, vbO3, vbO4
                     STORE 00 TO vnP1, vnP2, vnP3, vnP4
                     STORE 00 TO vpE1, vpE2, vpE3, vpE4
                     STORE 00 TO vnC1, vnC2, vnC3, vnC4
                     STORE 00 TO vnD1, vnD2, vnD3, vnD4
                     STORE 01 TO vgRu
                     SAVE SCREEN TO vpAn_11
                     SET ESCAPE ON
                     ON ESCAPE STORE K_ESC TO MKEY
                     SELECT caB_ing_caja
                     SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc), 4,  ;
                          2)+SUBSTR(DTOC(vfEc), 1, 2)
                     DO WHILE  .NOT. EOF() .AND. f3510ano+f3510mes+ ;
                        f3510dia=SUBSTR(DTOC(vfEc), 7, 4)+ ;
                        SUBSTR(DTOC(vfEc), 4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          IF f3510est="9" .OR. f3510tpo=2 .OR. f3510tpo=5
                               SKIP
                               LOOP
                          ENDIF
                          DO meNsaje WITH "L E Y E N D O  CAJA "+f3510ano+ ;
                             "-"+f3510mes+"-"+f3510num+ ;
                             "...Presionar ESC para Salir..."
                          DO CASE
                               CASE f3510caj=01 .AND. vcJ1=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=02 .AND. vcJ2=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=03 .AND. vcJ3=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=04 .AND. vcJ4=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=05 .AND. vcJ5=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=06 .AND. vcJ6=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=07 .AND. vcJ7=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=08 .AND. vcJ8=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=09 .AND. vcJ9=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=10 .AND. vcJa=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                               CASE f3510caj=00 .AND. vcJ0=0 .AND. vcJt=0
                                    SKIP
                                    LOOP
                          ENDCASE
                          STORE f3510ser TO vsEr
                          STORE f3510num TO vnUm
                          STORE f3510tpo TO vtPo
                          STORE f3510caj TO vcAj
                          STORE f3510mon TO vmNd
                          STORE f3510tca TO vtCa
                          STORE f3510glo TO vgLo
                          STORE f3510srl TO vsRl
                          STORE f3510let TO vlEt
                          STORE f3510rcb TO vrCb
                          STORE f3510tip TO vtIp
                          STORE f3510nti TO vnTi
                          STORE f3510dnc TO vdNc
                          DO CASE
                               CASE vtPo=1
                                    STORE "Por rendir" TO vcHe
                               CASE vtPo=4
                                    STORE "Canje/Renovacion LE" TO vcHe
                               CASE vtPo=6
                                    STORE "Aplicacion NC" TO vcHe
                               OTHERWISE
                                    STORE "Caja" TO vcHe
                          ENDCASE
                          SELECT deT_ing_caja
                          SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc),  ;
                               4, 2)+vsEr+vnUm
                          DO WHILE  .NOT. EOF() .AND. f3511ano+f3511mes+ ;
                             f3511ser+f3511num=SUBSTR(DTOC(vfEc), 7, 4)+ ;
                             SUBSTR(DTOC(vfEc), 4, 2)+vsEr+vnUm
                               IF mkEy=k_Esc
                                    EXIT
                               ENDIF
                               STORE f3511tdo TO vtDo
                               STORE f3511sr1 TO vsR1
                               STORE f3511doc TO vdOc
                               STORE f3511pag TO vaCu
                               SELECT peNd_vtas
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    STORE 0 TO vtOt, vsLd
                                    STORE 1 TO vmOn
                                    STORE "00" TO vfPa
                                    STORE SPACE(70) TO vnOm, vnFp, vnVe
                                    STORE CTOD("  /  /    ") TO vfEm, vfVe
                               ELSE
                                    STORE f3500nom TO vnOm
                                    STORE f3500fem TO vfEm
                                    STORE f3500fve TO vfVe
                                    STORE f3500fpa TO vfPa
                                    STORE f3500nfp TO vnFp
                                    STORE f3500nve TO vnVe
                                    STORE f3500mon TO vmOn
                                    STORE f3500tot TO vtOt
                                    STORE f3500tot+f3500int-f3500acu TO vsLd
                               ENDIF
                               IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                                    STORE vtOt*-1 TO vtOt
                                    STORE vaCu*-1 TO vaCu
                               ENDIF
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc+STR(vgRu, 1, 0)+ ;
                                    STR(vcAj, 2, 0)+vsR1+vnUm
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1gru WITH vgRu
                                    REPLACE ftM1caj WITH vcAj
                                    REPLACE ftM1sr1 WITH vsR1
                                    REPLACE ftM1num WITH vnUm
                                    REPLACE ftM1fem WITH vfEm
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1fpa WITH vfPa
                                    REPLACE ftM1nfp WITH vnFp
                                    REPLACE ftM1nve WITH vnVe
                                    REPLACE ftM1dnc WITH vdNc
                                    REPLACE ftM1tip WITH vtIp
                                    REPLACE ftM1nti WITH vnTi
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1mnd WITH vmNd
                                    REPLACE ftM1tca WITH vtCa
                                    REPLACE ftM1acu WITH vaCu
                                    REPLACE ftM1sld WITH vsLd
                                    REPLACE ftM1glo WITH vgLo
                                    REPLACE ftM1che WITH vcHe
                                    REPLACE ftM1srl WITH vsRl
                                    REPLACE ftM1let WITH vlEt
                                    REPLACE ftM1rcb WITH vrCb
                                    SELECT teMporal_2
                                    SEEK STR(vcAj, 2, 0)+STR(vgRu, 1, 0)+ ;
                                     vtIp+vfPa
                                    IF EOF()
                                         APPEND BLANK
                                         REPLACE ftM2caj WITH vcAj
                                         REPLACE ftM2gru WITH vgRu
                                         REPLACE ftM2tip WITH vtIp
                                         REPLACE ftM2nti WITH vnTi
                                         REPLACE ftM2fpa WITH vfPa
                                         REPLACE ftM2nfp WITH vnFp
                                         REPLACE ftM2ho1 WITH 0
                                         REPLACE ftM2ho2 WITH 0
                                         REPLACE ftM2ot1 WITH 0
                                         REPLACE ftM2ot2 WITH 0
                                         REPLACE ftM2to1 WITH 0
                                         REPLACE ftM2to2 WITH 0
                                    ENDIF
                                    DO CASE
                                         CASE vmNd=1
                                              REPLACE ftM2to1 WITH ftM2to1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2to2 WITH ftM2to2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE vmNd=1 .AND. vfEc=vfEm
                                              REPLACE ftM2ho1 WITH ftM2ho1+vaCu
                                         CASE vmNd=2 .AND. vfEc=vfEm
                                              REPLACE ftM2ho2 WITH ftM2ho2+vaCu
                                         CASE vmNd=1
                                              REPLACE ftM2ot1 WITH ftM2ot1+vaCu
                                         CASE vmNd=2
                                              REPLACE ftM2ot2 WITH ftM2ot2+vaCu
                                    ENDCASE
                                    DO CASE
                                         CASE vtPo=4
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=1 .AND.  ;
                                          vfEm=vfEc
                                              STORE veF1-vaCu TO veF1
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=2 .AND.  ;
                                          vfEm=vfEc
                                              STORE veF2-vaCu TO veF2
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=1
                                              STORE veF3-vaCu TO veF3
                                         CASE vtPo=6 .AND. vdNc=1 .AND.  ;
                                          (vtDo="NC" .OR. vtDo="N1" .OR.  ;
                                          vtDo="N3") .AND. vmNd=2
                                              STORE veF4-vaCu TO veF4
                                         CASE vmNd=1 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<> ;
                                          "N3" .AND. vfEm=vfEc
                                              STORE veF1+vaCu TO veF1
                                         CASE vmNd=2 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<> ;
                                          "N3" .AND. vfEm=vfEc
                                              STORE veF2+vaCu TO veF2
                                         CASE vmNd=1 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<>"N3"
                                              STORE veF3+vaCu TO veF3
                                         CASE vmNd=2 .AND. vtDo<>"NC"  ;
                                          .AND. vtDo<>"N1" .AND. vtDo<>"N3"
                                              STORE veF4+vaCu TO veF4
                                    ENDCASE
                               ENDIF
                               SELECT deT_ing_caja
                               SKIP
                          ENDDO
                          IF mkEy=k_Esc
                               STORE 99 TO mkEy
                               SELECT teMporal
                               ZAP
                               REINDEX
                               SELECT teMporal_2
                               ZAP
                               REINDEX
                               EXIT
                          ENDIF
                          SELECT caB_ing_caja
                          SKIP
                     ENDDO
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     IF vcJt=1 .OR. vcJ0=1
                          STORE 02 TO vgRu
                          STORE 00 TO vcAj
                          SELECT caB_ing_bancos
                          SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc),  ;
                               4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                          DO WHILE  .NOT. EOF() .AND. f3530ano+f3530mes+ ;
                             f3530dia=SUBSTR(DTOC(vfEc), 7, 4)+ ;
                             SUBSTR(DTOC(vfEc), 4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                               IF mkEy=k_Esc
                                    STORE 99 TO mkEy
                                    SELECT teMporal
                                    ZAP
                                    REINDEX
                                    SELECT teMporal_2
                                    ZAP
                                    REINDEX
                                    EXIT
                               ENDIF
                               IF f3530est="9" .OR. f3530tpo=2 .OR. f3530tpo=3
                                    SKIP
                                    LOOP
                               ENDIF
                               DO meNsaje WITH "L E Y E N D O  BANCOS "+ ;
                                  f3530ano+"-"+f3530mes+"-"+f3530num+ ;
                                  "...Presionar ESC para Salir..."
                               STORE f3530ser TO vsEr
                               STORE f3530num TO vnUm
                               STORE f3530mon TO vmNd
                               STORE f3530tip TO vtIp
                               STORE f3530nti TO vnTi
                               STORE f3530tca TO vtCa
                               STORE f3530glo TO vgLo
                               STORE f3530rcb TO vrCb
                               STORE f3530nba TO vnBa
                               STORE f3530nct TO vnCt
                               STORE f3530che TO vcHe
                               SELECT deT_ing_bancos
                               SEEK SUBSTR(DTOC(vfEc), 7, 4)+ ;
                                    SUBSTR(DTOC(vfEc), 4, 2)+vsEr+vnUm
                               DO WHILE  .NOT. EOF() .AND. f3531ano+ ;
                                  f3531mes+f3531ser+f3531num= ;
                                  SUBSTR(DTOC(vfEc), 7, 4)+ ;
                                  SUBSTR(DTOC(vfEc), 4, 2)+vsEr+vnUm
                                    IF mkEy=k_Esc
                                         EXIT
                                    ENDIF
                                    STORE f3531tdo TO vtDo
                                    STORE f3531sr1 TO vsR1
                                    STORE f3531doc TO vdOc
                                    STORE f3531pag TO vaCu
                                    SELECT peNd_vtas
                                    SEEK vtDo+vsR1+vdOc
                                    IF EOF()
                                         STORE 0 TO vtOt, vsLd
                                         STORE 1 TO vmOn
                                         STORE "00" TO vfPa
                                         STORE SPACE(70) TO vnOm, vnFp, vnVe
                                         STORE CTOD("  /  /    ") TO vfEm, vfVe
                                    ELSE
                                         STORE f3500nom TO vnOm
                                         STORE f3500fem TO vfEm, vfVe
                                         STORE f3500fpa TO vfPa
                                         STORE f3500nfp TO vnFp
                                         STORE f3500nve TO vnVe
                                         STORE f3500mon TO vmOn
                                         STORE f3500tot TO vtOt
                                         STORE f3500tot+f3500int-f3500acu  ;
                                          TO vsLd
                                    ENDIF
                                    IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                                         STORE vtOt*-1 TO vtOt
                                         STORE vaCu*-1 TO vaCu
                                    ENDIF
                                    SELECT teMporal
                                    SEEK vtDo+vsR1+vdOc+STR(vgRu, 1, 0)+ ;
                                     STR(vcAj, 2, 0)+vsR1+vnUm
                                    IF EOF()
                                         APPEND BLANK
                                         REPLACE ftM1tdo WITH vtDo
                                         REPLACE ftM1ser WITH vsR1
                                         REPLACE ftM1doc WITH vdOc
                                         REPLACE ftM1gru WITH vgRu
                                         REPLACE ftM1caj WITH vcAj
                                         REPLACE ftM1sr1 WITH vsR1
                                         REPLACE ftM1num WITH vnUm
                                         REPLACE ftM1fem WITH vfEm
                                         REPLACE ftM1nom WITH vnOm
                                         REPLACE ftM1fpa WITH vfPa
                                         REPLACE ftM1nfp WITH vnFp
                                         REPLACE ftM1nve WITH vnVe
                                         REPLACE ftM1dnc WITH 0
                                         REPLACE ftM1tip WITH vtIp
                                         REPLACE ftM1nti WITH vnTi
                                         REPLACE ftM1mon WITH vmOn
                                         REPLACE ftM1tot WITH vtOt
                                         REPLACE ftM1mnd WITH vmNd
                                         REPLACE ftM1tca WITH vtCa
                                         REPLACE ftM1acu WITH vaCu
                                         REPLACE ftM1sld WITH vsLd
                                         REPLACE ftM1glo WITH vgLo
                                         REPLACE ftM1che WITH vcHe
                                         REPLACE ftM1nba WITH vnBa
                                         REPLACE ftM1nct WITH vnCt
                                         REPLACE ftM1rcb WITH vrCb
                                         SELECT teMporal_2
                                         SEEK STR(vcAj, 2, 0)+STR(vgRu, 1,  ;
                                          0)+vtIp+vfPa
                                         IF EOF()
                                              APPEND BLANK
                                              REPLACE ftM2caj WITH vcAj
                                              REPLACE ftM2gru WITH vgRu
                                              REPLACE ftM2tip WITH vtIp
                                              REPLACE ftM2nti WITH vnTi
                                              REPLACE ftM2fpa WITH vfPa
                                              REPLACE ftM2nfp WITH vnFp
                                              REPLACE ftM2ho1 WITH 0
                                              REPLACE ftM2ho2 WITH 0
                                              REPLACE ftM2ot1 WITH 0
                                              REPLACE ftM2ot2 WITH 0
                                              REPLACE ftM2to1 WITH 0
                                              REPLACE ftM2to2 WITH 0
                                         ENDIF
                                         DO CASE
                                              CASE vmNd=1
                                                   REPLACE ftM2to1 WITH  ;
                                                    ftM2to1+vaCu
                                              CASE vmNd=2
                                                   REPLACE ftM2to2 WITH  ;
                                                    ftM2to2+vaCu
                                         ENDCASE
                                         DO CASE
                                              CASE vmNd=1 .AND. vfEc=vfEm
                                                   REPLACE ftM2ho1 WITH  ;
                                                    ftM2ho1+vaCu
                                              CASE vmNd=2 .AND. vfEc=vfEm
                                                   REPLACE ftM2ho2 WITH  ;
                                                    ftM2ho2+vaCu
                                              CASE vmNd=1
                                                   REPLACE ftM2ot1 WITH  ;
                                                    ftM2ot1+vaCu
                                              CASE vmNd=2
                                                   REPLACE ftM2ot2 WITH  ;
                                                    ftM2ot2+vaCu
                                         ENDCASE
                                         DO CASE
                                              CASE AT("CHEQ",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=1 .AND. vfEc=vfEm
                                                   STORE vcH1+vaCu TO vcH1
                                              CASE AT("CHEQ",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=2 .AND. vfEc=vfEm
                                                   STORE vcH2+vaCu TO vcH2
                                              CASE AT("CHEQ",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=1
                                                   STORE vcH3+vaCu TO vcH3
                                              CASE AT("CHEQ",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=2
                                                   STORE vcH4+vaCu TO vcH4
                                              CASE AT("DEPO",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=1 .AND. vfEc=vfEm
                                                   STORE vdP1+vaCu TO vdP1
                                              CASE AT("DEPO",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=2 .AND. vfEc=vfEm
                                                   STORE vdP2+vaCu TO vdP2
                                              CASE AT("DEPO",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=1
                                                   STORE vdP3+vaCu TO vdP3
                                              CASE AT("DEPO",  ;
                                               UPPER(ALLTRIM(vnTi)))<>0  ;
                                               .AND. vmNd=2
                                                   STORE vdP4+vaCu TO vdP4
                                              CASE vmNd=1 .AND. vfEc=vfEm
                                                   STORE voT1+vaCu TO voT1
                                              CASE vmNd=2 .AND. vfEc=vfEm
                                                   STORE voT2+vaCu TO voT2
                                              CASE vmNd=1
                                                   STORE voT3+vaCu TO voT3
                                              CASE vmNd=2
                                                   STORE voT4+vaCu TO voT4
                                         ENDCASE
                                    ENDIF
                                    SELECT deT_ing_bancos
                                    SKIP
                               ENDDO
                               IF mkEy=k_Esc
                                    STORE 99 TO mkEy
                                    SELECT teMporal
                                    ZAP
                                    REINDEX
                                    SELECT teMporal_2
                                    ZAP
                                    REINDEX
                                    EXIT
                               ENDIF
                               SELECT caB_ing_bancos
                               SKIP
                          ENDDO
                     ENDIF
                     IF mkEy=k_Esc .OR. mkEy=99
                          RESTORE SCREEN FROM vpAn_11
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                     IF vcJt=1 .OR. vcJ0=1
                          SELECT caB_fact
                          SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc),  ;
                               4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                          DO WHILE  .NOT. EOF() .AND. f1300fem=vfEc
                               IF mkEy=k_Esc
                                    STORE 99 TO mkEy
                                    SELECT teMporal
                                    ZAP
                                    REINDEX
                                    SELECT teMporal_2
                                    ZAP
                                    REINDEX
                                    EXIT
                               ENDIF
                               IF f1300tdo="CT"
                                    SKIP
                                    LOOP
                               ENDIF
                               DO meNsaje WITH "L E Y E N D O  "+f1300tdo+ ;
                                  ":"+f1300ser+"-"+f1300doc+ ;
                                  "...Presionar ESC para Salir..."
                               STORE f1300tdo TO vtDo
                               STORE f1300ser TO vsR1
                               STORE f1300doc TO vdOc
                               STORE f1300nom TO vnOm
                               STORE f1300mon TO vmOn
                               STORE f1300tot TO vtOt
                               STORE f1300fpa TO vfPa
                               STORE f1300nfp TO vnFp
                               IF f1300est="9"
                                    STORE 0 TO vtOt
                                    STORE "ANULADO" TO vnOm
                               ENDIF
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1fem WITH vfEc
                                    REPLACE ftM1fpa WITH vfPa
                                    REPLACE ftM1nfp WITH vnFp
                                    REPLACE ftM1caj WITH 0
                                    REPLACE ftM1gru WITH 0
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1mnd WITH 1
                                    REPLACE ftM1dnc WITH 0
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1acu WITH 0
                                    REPLACE ftM1sld WITH vtOt
                                    REPLACE ftM1tca WITH 1
                               ENDIF
                               SELECT caB_fact
                               SKIP
                          ENDDO
                          IF mkEy=k_Esc .OR. mkEy=99
                               RESTORE SCREEN FROM vpAn_11
                               SET ESCAPE OFF
                               ON ESCAPE
                               EXIT
                          ENDIF
                     ENDIF
                     IF vcJt=1 .OR. vcJ0=1
                          SELECT caB_notas
                          SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc),  ;
                               4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                          DO WHILE  .NOT. EOF() .AND. f3610fem=vfEc
                               IF mkEy=k_Esc
                                    STORE 99 TO mkEy
                                    SELECT teMporal
                                    ZAP
                                    REINDEX
                                    SELECT teMporal_2
                                    ZAP
                                    REINDEX
                                    EXIT
                               ENDIF
                               DO meNsaje WITH "L E Y E N D O  "+f3610tdo+ ;
                                  ":"+f3610ser+"-"+f3610doc+ ;
                                  "...Presionar ESC para Salir..."
                               STORE f3610tdo TO vtDo
                               STORE f3610ser TO vsR1
                               STORE f3610doc TO vdOc
                               STORE f3610nom TO vnOm
                               STORE f3610mon TO vmOn
                               STORE f3610tot TO vtOt
                               IF f3610est="9"
                                    STORE 0 TO vtOt
                                    STORE "ANULADO" TO vnOm
                               ENDIF
                               IF vtDo="NC" .OR. vtDo="N1" .OR. vtDo="N3"
                                    STORE vtOt*-1 TO vtOt
                               ENDIF
                               SELECT teMporal
                               SEEK vtDo+vsR1+vdOc
                               IF EOF()
                                    APPEND BLANK
                                    REPLACE ftM1tdo WITH vtDo
                                    REPLACE ftM1ser WITH vsR1
                                    REPLACE ftM1doc WITH vdOc
                                    REPLACE ftM1fem WITH vfEm
                                    REPLACE ftM1fpa WITH "00"
                                    REPLACE ftM1caj WITH 0
                                    REPLACE ftM1gru WITH 0
                                    REPLACE ftM1nom WITH vnOm
                                    REPLACE ftM1mon WITH vmOn
                                    REPLACE ftM1mnd WITH 1
                                    REPLACE ftM1dnc WITH 0
                                    REPLACE ftM1tot WITH vtOt
                                    REPLACE ftM1acu WITH 0
                                    REPLACE ftM1sld WITH vtOt
                                    REPLACE ftM1tca WITH 1
                               ENDIF
                               SELECT caB_notas
                               SKIP
                          ENDDO
                          IF mkEy=k_Esc .OR. mkEy=99
                               RESTORE SCREEN FROM vpAn_11
                               SET ESCAPE OFF
                               ON ESCAPE
                               EXIT
                          ENDIF
                     ENDIF
                     IF vcJt=1 .OR. vcJ0=1
                          SELECT caB_ing_caja
                          STORE 01 TO meRr
                          SET ORDER TO F3510LET
                          STORE 00 TO meRr
                          STORE k_Tab TO mkEy
                          STORE "LE" TO vtDo
                          SELECT leTras
                          SEEK SUBSTR(DTOC(vfEc), 7, 4)+SUBSTR(DTOC(vfEc),  ;
                               4, 2)+SUBSTR(DTOC(vfEc), 1, 2)
                          DO WHILE  .NOT. EOF() .AND. f3110fem=vfEc
                               IF mkEy=k_Esc
                                    STORE 99 TO mkEy
                                    SELECT teMporal
                                    ZAP
                                    REINDEX
                                    SELECT teMporal_2
                                    ZAP
                                    REINDEX
                                    EXIT
                               ENDIF
                               IF f3110est="9"
                                    SKIP
                                    LOOP
                               ENDIF
                               DO meNsaje WITH "L E Y E N D O  LE:"+ ;
                                  f3110ser+"-"+f3110let+"..."+CHR(13)+ ;
                                  CHR(13)+"Presionar ESC para Salir..."
                               STORE f3110ser TO vsR1
                               STORE f3110let TO vdOc
                               STORE f3110nom TO vnOm
                               STORE f3110mon TO vmOn
                               STORE f3110tot TO vtOt
                               SELECT caB_ing_caja
                               SEEK vsR1+vdOc
                               IF EOF()
                                    SELECT teMporal
                                    SEEK vtDo+vsR1+vdOc
                                    IF EOF()
                                         APPEND BLANK
                                         REPLACE ftM1tdo WITH vtDo
                                         REPLACE ftM1ser WITH vsR1
                                         REPLACE ftM1doc WITH vdOc
                                         REPLACE ftM1gru WITH 0
                                         REPLACE ftM1dnc WITH 0
                                         REPLACE ftM1glo WITH  ;
                                          "Emitida n/canjeada"
                                         REPLACE ftM1fem WITH vfEm
                                         REPLACE ftM1nom WITH vnOm
                                         REPLACE ftM1mon WITH vmOn
                                         REPLACE ftM1tot WITH vtOt
                                         REPLACE ftM1mnd WITH vmOn
                                         REPLACE ftM1sld WITH 0
                                         REPLACE ftM1tca WITH 1
                                         REPLACE ftM1acu WITH 0
                                    ENDIF
                               ENDIF
                               SELECT leTras
                               SKIP
                          ENDDO
                          SELECT caB_ing_caja
                          STORE 01 TO meRr
                          SET ORDER TO F3510FEM
                          STORE 00 TO meRr
                          IF mkEy=k_Esc .OR. mkEy=99
                               RESTORE SCREEN FROM vpAn_11
                               SET ESCAPE OFF
                               ON ESCAPE
                               EXIT
                          ENDIF
                     ENDIF
                     RESTORE SCREEN FROM vpAn_11
                     IF mkEy=k_Esc .OR. mkEy=99
                          SET ESCAPE OFF
                          ON ESCAPE
                          EXIT
                     ENDIF
                ENDIF
                SELECT teMporal
                GOTO TOP
                IF BOF() .OR. EOF()
                     STORE "No hay datos registrados entre esta fecha..."  ;
                           TO mmSj
                ELSE
                     STORE "**" TO ctDo, csEr, cdOc
                     DO WHILE  .NOT. EOF()
                          IF ctDo+csEr+cdOc=ftM1tdo+ftM1ser+ftM1doc
                               SKIP
                               LOOP
                          ENDIF
                          STORE ftM1tdo TO ctDo
                          STORE ftM1ser TO csEr
                          STORE ftM1doc TO cdOc
                          DO CASE
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vfA1+ftM1tot TO vfA1
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vfA2+ftM1tot TO vfA2
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=1
                                    STORE vfA3+ftM1tot TO vfA3
                               CASE (ftM1tdo="FA" .OR. ftM1tdo="FE" .OR.  ;
                                    ftM1tdo="FC") .AND. ftM1mon=2
                                    STORE vfA4+ftM1tot TO vfA4
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vbO1+ftM1tot TO vbO1
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vbO2+ftM1tot TO vbO2
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=1
                                    STORE vbO3+ftM1tot TO vbO3
                               CASE (ftM1tdo="BO" .OR. ftM1tdo="BE" .OR.  ;
                                    ftM1tdo="BC") .AND. ftM1mon=2
                                    STORE vbO4+ftM1tot TO vbO4
                               CASE ftM1tdo="NP" .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnP1+ftM1tot TO vnP1
                               CASE ftM1tdo="NP" .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnP2+ftM1tot TO vnP2
                               CASE ftM1tdo="NP" .AND. ftM1mon=1
                                    STORE vnP3+ftM1tot TO vnP3
                               CASE ftM1tdo="NP" .AND. ftM1mon=2
                                    STORE vnP4+ftM1tot TO vnP4
                               CASE ftM1tdo="PC" .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vpE1+ftM1tot TO vpE1
                               CASE ftM1tdo="PC" .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vpE2+ftM1tot TO vpE2
                               CASE ftM1tdo="PC" .AND. ftM1mon=1
                                    STORE vpE3+ftM1tot TO vpE3
                               CASE ftM1tdo="PC" .AND. ftM1mon=2
                                    STORE vpE4+ftM1tot TO vpE4
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnC1+ftM1tot TO vnC1
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnC2+ftM1tot TO vnC2
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=1
                                    STORE vnC3+ftM1tot TO vnC3
                               CASE (ftM1tdo="NC" .OR. ftM1tdo="N1" .OR.  ;
                                    ftM1tdo="N3") .AND. ftM1mon=2
                                    STORE vnC4+ftM1tot TO vnC4
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=1 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnD1+ftM1tot TO vnD1
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=2 .AND.  ;
                                    vfEc=ftM1fem
                                    STORE vnD2+ftM1tot TO vnD2
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=1
                                    STORE vnD3+ftM1tot TO vnD3
                               CASE (ftM1tdo="ND" .OR. ftM1tdo="N2" .OR.  ;
                                    ftM1tdo="N4") .AND. ftM1mon=2
                                    STORE vnD4+ftM1tot TO vnD4
                          ENDCASE
                          SKIP
                     ENDDO
                     GOTO TOP
                     STORE vfEc TO cfEc
                     DO prEsiona WITH "4", "R_CONS06", mmF1, mmC1
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "MOVIMI", mmF2, mmC2
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "EXCEL", mmF1+2, 0
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET READBORDER OFF
                     DO pcC3551b
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET READBORDER ON
                     DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     DO prEsiona WITH "1", "MOVIM0", mmF2, mmC2
                     IF mkEy=k_Esc
                          EXIT
                     ENDIF
                     SET COLOR TO RGB(0,0,0,224,226,209)
                     @ mmF1, 0 CLEAR TO mmF1+3.1, 3.200
                ENDIF
      ENDCASE
      IF LEN(ALLTRIM(mmSj))<>0
           DO poNmsj
           STORE 99 TO mkEy
      ENDIF
      DO coLbln
      STORE k_Enter TO mkEy
      @iFIL-4,iCLN+9 Get vFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
      SET CURSOR ON
      READ
      SET CURSOR OFF
 ENDDO
 DO deL_files
 RETURN
ENDPROC
*
PROCEDURE Lin_3551a
 PARAMETER piNi, pfIn
 DO coLplp
 DO CASE
      CASE mrEs="3"
           @ piNi, icLn+019.4 TO pfIn, icLn+019.4
           @ piNi, icLn+032.6 TO pfIn, icLn+032.6
           @ piNi, icLn+073.2 TO pfIn, icLn+073.2
           @ piNi, icLn+075.4 TO pfIn, icLn+075.4
           @ piNi, icLn+106.9 TO pfIn, icLn+106.9
           @ piNi, icLn+124.7 TO pfIn, icLn+124.7
           @ piNi, icLn+146.1 TO pfIn, icLn+146.1
           @ piNi, icLn+167.5 TO pfIn, icLn+167.5
           @ piNi, icLn+183.5 TO pfIn, icLn+183.5
      CASE mrEs="4"
           @ piNi, icLn+019.4 TO pfIn, icLn+019.4
           @ piNi, icLn+032.6 TO pfIn, icLn+032.6
           @ piNi, icLn+083.1 TO pfIn, icLn+083.1
           @ piNi, icLn+085.4 TO pfIn, icLn+085.4
           @ piNi, icLn+133.8 TO pfIn, icLn+133.8
           @ piNi, icLn+150.0 TO pfIn, icLn+150.0
           @ piNi, icLn+176.8 TO pfIn, icLn+176.8
           @ piNi, icLn+198.2 TO pfIn, icLn+198.2
           @ piNi, icLn+219.6 TO pfIn, icLn+219.6
           @ piNi, icLn+235.6 TO pfIn, icLn+235.6
      OTHERWISE
           @ piNi, icLn+019.4 TO pfIn, icLn+019.4
           @ piNi, icLn+032.6 TO pfIn, icLn+032.6
           @ piNi, icLn+083.2 TO pfIn, icLn+083.2
           @ piNi, icLn+085.4 TO pfIn, icLn+085.4
           @ piNi, icLn+133.8 TO pfIn, icLn+133.8
           @ piNi, icLn+165.0 TO pfIn, icLn+165.0
           @ piNi, icLn+193.8 TO pfIn, icLn+193.8
           @ piNi, icLn+215.2 TO pfIn, icLn+215.2
           @ piNi, icLn+236.6 TO pfIn, icLn+236.6
           @ piNi, icLn+252.7 TO pfIn, icLn+252.7
 ENDCASE
ENDPROC
*
PROCEDURE Li1_3551a
 PARAMETER piNi, pfIn
 DO coLplp
 DO CASE
      CASE mrEs="3"
           @ piNi, icLn+003.6 TO pfIn, icLn+003.6
           @ piNi, icLn+008.5 TO pfIn, icLn+008.5
           @ piNi, icLn+130.1 TO pfIn, icLn+130.1
           @ piNi, icLn+151.5 TO pfIn, icLn+151.5
      CASE mrEs="4"
           @ piNi, icLn+003.6 TO pfIn, icLn+003.6
           @ piNi, icLn+008.5 TO pfIn, icLn+008.5
           @ piNi, icLn+182.2 TO pfIn, icLn+182.2
           @ piNi, icLn+203.6 TO pfIn, icLn+203.6
      OTHERWISE
           @ piNi, icLn+003.6 TO pfIn, icLn+003.6
           @ piNi, icLn+008.5 TO pfIn, icLn+008.5
           @ piNi, icLn+199.2 TO pfIn, icLn+199.2
           @ piNi, icLn+220.6 TO pfIn, icLn+220.6
 ENDCASE
ENDPROC
*
PROCEDURE P00_3551a
 PARAMETER ptPo
 DO ptA_0000a
 IF mkEy=k_Esc
      RETURN
 ENDIF
 STORE INT(mwFi-11) TO muFi
 STORE INT(mwCo-4) TO muCo
 DO maRcos
 STORE mfI0+1 TO mfI0
 STORE mcO0+muCo-14 TO mmC2
 STORE mcO0+0.4 TO icLn
 STORE mcO0+muCo TO ucLn
 STORE (mwCo-188.9)/2 TO icL1
 STORE icL1+188.4 TO ucL1
 STORE mfI0+01.3 TO ifIl, ufIl, vfIl
 STORE ifIl+(INT(muFi)-4) TO ffIl
 STORE ffIl-7 TO ffIl
 STORE ifIl+1 TO ifFs, ufFs, vfFs
 STORE ffIl TO ffFs
 STORE ffIl+8.4 TO mmF2
 STORE ifIl-03.8 TO vfI1
 STORE ffIl+01.3 TO vfI2
 STORE icLn+40 TO vcL1
 STORE vcL1+15 TO vcL2
 STORE vcL2+15 TO vcL3
 STORE vcL3+15 TO vcL4
 STORE vcL4+15 TO vcL5
 STORE vcL5+19 TO vcL6
 DO tiT_0000a WITH "Consulta de Ventas y Caja del Da"
 DO coLsc1
 DO cuAdro WITH mfI0, icLn, ffIl+8.9, ucLn
 IF mkEy=k_Esc
      RETURN
 ENDIF
 SET COLOR TO RGB(0,0,0,224,226,209)
 @ mmF1, 0 CLEAR TO mmF1+3.1, mwCo
 DO prEsiona WITH "1", "OPCIO2", mfI0-3.3, icLn-0.6
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO coLsc3
 @iFIL-4,iCLN+1 Say "Del:" Font "&mLetRom",13 Style "BT"
 DO liN_3551a WITH ifIl-1.6, ffIl+1.1
 DO li1_3551a WITH ifIl-0.2, ffIl+1.1
 @ ifIl-0.2, icLn TO ifIl-0.2, ucLn
 @ ffIl+1.1, icLn TO ffIl+1.1, ucLn
 DO coLblz
 @vFI1,vCL1-07.9 Say "Caja"          Font "&mLetAri",9 Style "BT"
 @vFI1,vCL2-07.9 Say "Caja"          Font "&mLetAri",9 Style "BT"
 @vFI1,vCL3-07.9 Say "Caja"          Font "&mLetAri",9 Style "BT"
 @vFI1,vCL4-07.9 Say "Caja"          Font "&mLetAri",9 Style "BT"
 @vFI1,vCL5-07.9 Say "Caja 0"        Font "&mLetAri",9 Style "BT"
 @vFI1,vCL6-11.9 Say "Tod.Cajas"     Font "&mLetAri",9 Style "BT"
 @iFIL-1.2,iCLN+04.0 Say "Documento" Font "&mLetAri",9 Style "BT"
 @iFIL-1.2,iCLN+21.6 Say "Emisin"   Font "&mLetAri",9 Style "BT"
 DO CASE
      CASE mrEs="3"
           @iFIL-1.2,iCLN+046.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+073.8 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+086.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+107.8 Say "Cheque/Deps"    Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+126.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+150.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+169.5 Say "Saldo "+mSIG     Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+185.5 Say "Saldo US$"       Font "&mLetAri",9 Style "BT"
      CASE mrEs="4"
           @iFIL-1.2,iCLN+051.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+083.7 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+106.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+137.8 Say "F.Pago"          Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+154.0 Say "Cheque/Depsito" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+178.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+203.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+223.1 Say "Saldo "+mSIG     Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+238.5 Say "Saldo US$"       Font "&mLetAri",9 Style "BT"
      OTHERWISE
           @iFIL-1.2,iCLN+051.4 Say "Cliente"         Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+083.8 Say "#"               Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+106.3 Say "Glosa"           Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+140.8 Say "Forma de Pago"   Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+170.0 Say "Cheque/Depsito" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+195.0 Say "Total Documento" Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+220.5 Say "Total Pago"      Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+240.1 Say "Saldo "+mSIG     Font "&mLetAri",9 Style "BT"
           @iFIL-1.2,iCLN+255.5 Say "Saldo US$"       Font "&mLetAri",9 Style "BT"
 ENDCASE
 DO toT_3551a
 DO coLbln
 @iFIL-4,iCLN+09 Get vFEC Font "&mLetRom",11 Style "NQ" Size 1,10.7 Color ,&mColBlN
 READ TIMEOUT 0.01
 DO prEsiona WITH "4", "R_CONS08", mmF1, mmC1
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO prEsiona WITH "1", "MOVIM0", mmF2, mmC2
 IF mkEy=k_Esc
      RETURN
 ENDIF
 DO caJ_3551a
 DO boT_3551a
ENDPROC
*
PROCEDURE Caj_3551a
 DO coLsc7
 DO CASE
      CASE vsW2=1
           @vFI1,vCL1-02.9 Say " 1" Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL2-02.9 Say " 2" Font "&mLetAri",9 Style "BQ" Size 1,2.2
           @vFI1,vCL3-02.9 Say " 3" Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL4-02.9 Say " 4" Font "&mLetAri",9 Style "BQ" Size 1,2
      CASE vsW2=2
           @vFI1,vCL1-02.9 Say " 5" Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL2-02.9 Say " 6" Font "&mLetAri",9 Style "BQ" Size 1,2.2
           @vFI1,vCL3-02.9 Say " 7" Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL4-02.9 Say " 8" Font "&mLetAri",9 Style "BQ" Size 1,2
      CASE vsW2=3
           @vFI1,vCL1-02.9 Say " 9" Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL2-02.9 Say "10" Font "&mLetAri",9 Style "BQ" Size 1,2.2
           @vFI1,vCL3-02.9 Say "  " Font "&mLetAri",9 Style "BQ" Size 1,2
           @vFI1,vCL4-02.9 Say "  " Font "&mLetAri",9 Style "BQ" Size 1,2
 ENDCASE
ENDPROC
*
PROCEDURE Bot_3551a
 PRIVATE pcJ1, pcJ2, pcJ3, pcJ4
 DO CASE
      CASE vsW2=1
           STORE vcJ1 TO pcJ1
           STORE vcJ2 TO pcJ2
           STORE vcJ3 TO pcJ3
           STORE vcJ4 TO pcJ4
      CASE vsW2=2
           STORE vcJ5 TO pcJ1
           STORE vcJ6 TO pcJ2
           STORE vcJ7 TO pcJ3
           STORE vcJ8 TO pcJ4
      CASE vsW2=3
           STORE vcJ9 TO pcJ1
           STORE vcJa TO pcJ2
           STORE 0 TO pcJ3
           STORE 0 TO pcJ4
 ENDCASE
 IF pcJ1=1
      DO prEsiona WITH "1", "SI", vfI1, vcL1
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL1
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 IF pcJ2=1
      DO prEsiona WITH "1", "SI", vfI1, vcL2
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL2
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 IF pcJ3=1
      DO prEsiona WITH "1", "SI", vfI1, vcL3
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL3
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 IF pcJ4=1
      DO prEsiona WITH "1", "SI", vfI1, vcL4
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL4
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 IF vcJ0=1
      DO prEsiona WITH "1", "SI", vfI1, vcL5
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL5
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 IF vcJt=1
      DO prEsiona WITH "1", "SI", vfI1, vcL6
 ELSE
      DO prEsiona WITH "1", "NO", vfI1, vcL6
 ENDIF
 IF mkEy=k_Esc
      RETURN
 ENDIF
 RELEASE pcJ1, pcJ2, pcJ3, pcJ4
ENDPROC
*
PROCEDURE Tot_3551a
 PRIVATE pcL1, pcL2, pcL3
 STORE icLn+00 TO pcL1
 STORE pcL1+55 TO pcL2
 STORE pcL2+55 TO pcL3
 DO CASE
      CASE vsW0=1
           DO coLsc6
      CASE vsW0=2
           DO coLsc7
 ENDCASE
 @ vfI2+0.0, pcL1+00.0 TO vfI2+11.2, pcL1+54.2 PATTERN 1
 @ vfI2+0.0, pcL1+13.5 TO vfI2+11.2, pcL1+13.5
 @ vfI2+0.0, pcL1+33.8 TO vfI2+11.2, pcL1+33.8
 @ vfI2+1.6, pcL1+00.0 TO vfI2+01.6, pcL1+54.2
 @ vfI2+0.0, pcL2+00.0 TO vfI2+11.2, pcL2+54.2 PATTERN 1
 @ vfI2+0.0, pcL2+13.5 TO vfI2+11.2, pcL2+13.5
 @ vfI2+0.0, pcL2+33.8 TO vfI2+11.2, pcL2+33.8
 @ vfI2+1.6, pcL2+00.0 TO vfI2+01.6, pcL2+54.2
 @ vfI2+0.0, pcL3+00.0 TO vfI2+11.2, pcL3+54.2 PATTERN 1
 @ vfI2+0.0, pcL3+13.5 TO vfI2+11.2, pcL3+13.5
 @ vfI2+0.0, pcL3+33.8 TO vfI2+11.2, pcL3+33.8
 @ vfI2+1.6, pcL3+00.0 TO vfI2+01.6, pcL3+54.2
 @vFI2+0.1,pCL1+00.5 Say "Del Dia"  Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL1+22.0 Say mSIG       Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL1+40.5 Say "US$"      Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL2+00.5 Say "Otr.Dias" Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL2+22.0 Say mSIG       Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL2+40.5 Say "US$"      Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL3+00.5 Say "Totales"  Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL3+22.0 Say mSIG       Font "&mLetRom",12 Style "BQ"
 @vFI2+0.1,pCL3+40.5 Say "US$"      Font "&mLetRom",12 Style "BQ"
 DO CASE
      CASE vsW0=1
           @vFI2+2.0,pCL1+00.5 Say "Efectivo" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL1+00.5 Say "Cheque"   Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL1+00.5 Say "Depsito" Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL1+00.5 Say "Otros"    Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL2+00.5 Say "Efectivo" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL2+00.5 Say "Cheque"   Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL2+00.5 Say "Depsito" Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL2+00.5 Say "Otros"    Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL3+00.5 Say "Efectivo" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL3+00.5 Say "Cheque"   Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL3+00.5 Say "Depsito" Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL3+00.5 Say "Otros"    Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL1+14.2 Say vEF1       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL1+34.4 Say vEF2       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL1+14.2 Say vCH1       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL1+34.4 Say vCH2       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL1+14.2 Say vDP1       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL1+34.4 Say vDP2       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL1+14.2 Say vOT1       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL1+34.4 Say vOT2       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL2+14.2 Say vEF3       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL2+34.4 Say vEF4       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL2+14.2 Say vCH3       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL2+34.4 Say vCH4       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL2+14.2 Say vDP3       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL2+34.4 Say vDP4       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL2+14.2 Say vOT3       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL2+34.4 Say vOT4       Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL3+14.2 Say vEF1+vEF3  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL3+34.4 Say vEF2+vEF4  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL3+14.2 Say vCH1+vCH3  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL3+34.4 Say vCH2+vCH4  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL3+14.2 Say vDP1+vDP3  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL3+34.4 Say vDP2+vDP4  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL3+14.2 Say vOT1+vOT3  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL3+34.4 Say vOT2+vOT4  Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
      CASE vsW0=2
           @vFI2+2.0,pCL1+00.5 Say "Facturas" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL1+00.5 Say "Boletas"  Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL1+00.5 Say "NP"       Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL1+00.5 Say "Percepc." Font "&mLetRom",12 Style "BQ"
           @vFI2+8.0,pCL1+00.5 Say "N/C"      Font "&mLetRom",12 Style "BQ"
           @vFI2+9.5,pCL1+00.5 Say "N/D"      Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL2+00.5 Say "Facturas" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL2+00.5 Say "Boletas"  Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL2+00.5 Say "NP"       Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL2+00.5 Say "Percepc." Font "&mLetRom",12 Style "BQ"
           @vFI2+8.0,pCL2+00.5 Say "N/C"      Font "&mLetRom",12 Style "BQ"
           @vFI2+9.5,pCL2+00.5 Say "N/D"      Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL3+00.5 Say "Facturas" Font "&mLetRom",12 Style "BQ"
           @vFI2+3.5,pCL3+00.5 Say "Boletas"  Font "&mLetRom",12 Style "BQ"
           @vFI2+5.0,pCL3+00.5 Say "NP"       Font "&mLetRom",12 Style "BQ"
           @vFI2+6.5,pCL3+00.5 Say "Percepc." Font "&mLetRom",12 Style "BQ"
           @vFI2+8.0,pCL3+00.5 Say "N/C"      Font "&mLetRom",12 Style "BQ"
           @vFI2+9.5,pCL3+00.5 Say "N/D"      Font "&mLetRom",12 Style "BQ"
           @vFI2+2.0,pCL1+014.2 Say vFA1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL1+034.4 Say vFA2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL1+014.2 Say vBO1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL1+034.4 Say vBO2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL1+014.2 Say vNP1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL1+034.4 Say vNP2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL1+014.2 Say vPE1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL1+034.4 Say vPE2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL1+014.2 Say vNC1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL1+034.4 Say vNC2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL1+014.2 Say vND1      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL1+034.4 Say vND2      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL2+014.2 Say vFA3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL2+034.4 Say vFA4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL2+014.2 Say vBO3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL2+034.4 Say vBO4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL2+014.2 Say vNP3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL2+034.4 Say vNP4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL2+014.2 Say vPE3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL2+034.4 Say vPE4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL2+014.2 Say vNC3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL2+034.4 Say vNC4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL2+014.2 Say vND3      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL2+034.4 Say vND4      Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL3+014.2 Say vFA1+vFA3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+2.0,pCL3+034.4 Say vFA2+vFA4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL3+014.2 Say vBO1+vBO3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+3.5,pCL3+034.4 Say vBO2+vBO4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL3+014.2 Say vNP1+vNP3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+5.0,pCL3+034.4 Say vNP2+vNP4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL3+014.2 Say vPE1+vPE3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+6.5,pCL3+034.4 Say vPE2+vPE4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL3+014.2 Say vNC1+vNC3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+8.0,pCL3+034.4 Say vNC2+vNC4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL3+014.2 Say vND1+vND3 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
           @vFI2+9.5,pCL3+034.4 Say vND2+vND4 Font "&mLetRom",12 Style "BQ" Pict "9,999,999.99" Size 1,13.7
 ENDCASE
 RELEASE pcL1, pcL2, pcL3
ENDPROC
*
PROCEDURE Res_3551a
 DO p00_3551a WITH "1"
 IF mkEy=k_Esc
      EXIT
 ENDIF
 IF LEN(ALLTRIM(inUm))<>0
      STORE 00 TO cfIl
      STORE ifIl TO vfIl
      DO muE_3551b IN PCC3551B WITH "v", "c"
      SELECT teMporal
      DO seE_3551b IN PCC3551B WITH "i"
      DO WHILE  .NOT. EOF() .AND. vfIl<ffIl+1
           IF ftM1tdo+ftM1ser+ftM1doc+STR(ftM1gru, 1, 0)+STR(ftM1caj, 2,  ;
              0)+ftM1sr1+ftM1num=vtDo+vsEr+vdOc+STR(vgRu, 1, 0)+STR(vcAj,  ;
              2, 0)+vsR1+vnUm
                STORE vfIl TO cfIl
                EXIT
           ENDIF
           STORE vfIl+1 TO vfIl
           SKIP
      ENDDO
      IF cfIl=0
           DO muE_3551b IN PCC3551B WITH "v", "i"
           DO muE_3551b IN PCC3551B WITH "v", "c"
           STORE ifIl TO vfIl, cfIl
      ENDIF
      DO seE_3551b IN PCC3551B WITH "i"
      DO paN_3551b IN PCC3551B
      IF mkEy=k_Esc
           RETURN
      ENDIF
      STORE cfIl TO vfIl
      DO muE_3551b IN PCC3551B WITH "c", "v"
      DO seE_3551b IN PCC3551B WITH "v"
      DO toT_3551a
 ENDIF
ENDPROC
*
PROCEDURE Clp_3551a
 = INKEY(0.01)
 DO CASE
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+59.4 .AND.  ;
           mcCc<=mmC1+68
           STORE k_Enter TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+68 .AND.  ;
           mcCc<=mmC1+77
           STORE k_F1 TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+77 .AND.  ;
           mcCc<=mmC1+85.8
           STORE k_Esc TO mkEy
      CASE mfIl>=mmF1 .AND. mfIl<=mmF1+03.11 .AND. mcCc>=mmC1+85.8 .AND.  ;
           mcCc<=mmC1+95
           STORE k_F10 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL1-8.1 .AND. mcCc<= ;
           vcL1+2.5
           STORE CTOD("  /  /    ") TO cfEc
           DO CASE
                CASE vsW2=1
                     IF vcJ1=1
                          STORE 0 TO vcJ1
                     ELSE
                          STORE 1 TO vcJ1
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=2
                     IF vcJ5=1
                          STORE 0 TO vcJ5
                     ELSE
                          STORE 1 TO vcJ5
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=3
                     IF vcJ9=1
                          STORE 0 TO vcJ9
                     ELSE
                          STORE 1 TO vcJ9
                          STORE 0 TO vcJt
                     ENDIF
           ENDCASE
           DO boT_3551a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL2-8.1 .AND. mcCc<= ;
           vcL2+2.5
           STORE CTOD("  /  /    ") TO cfEc
           DO CASE
                CASE vsW2=1
                     IF vcJ2=1
                          STORE 0 TO vcJ2
                     ELSE
                          STORE 1 TO vcJ2
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=2
                     IF vcJ6=1
                          STORE 0 TO vcJ6
                     ELSE
                          STORE 1 TO vcJ6
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=3
                     IF vcJa=1
                          STORE 0 TO vcJa
                     ELSE
                          STORE 1 TO vcJa
                          STORE 0 TO vcJt
                     ENDIF
           ENDCASE
           DO boT_3551a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL3-8.1 .AND. mcCc<= ;
           vcL3+2.5 .AND. vsW2<>3
           STORE CTOD("  /  /    ") TO cfEc
           DO CASE
                CASE vsW2=1
                     IF vcJ3=1
                          STORE 0 TO vcJ3
                     ELSE
                          STORE 1 TO vcJ3
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=2
                     IF vcJ7=1
                          STORE 0 TO vcJ7
                     ELSE
                          STORE 1 TO vcJ7
                          STORE 0 TO vcJt
                     ENDIF
           ENDCASE
           DO boT_3551a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL4-8.1 .AND. mcCc<= ;
           vcL4+2.5 .AND. vsW2<>3
           STORE CTOD("  /  /    ") TO cfEc
           DO CASE
                CASE vsW2=1
                     IF vcJ4=1
                          STORE 0 TO vcJ4
                     ELSE
                          STORE 1 TO vcJ4
                          STORE 0 TO vcJt
                     ENDIF
                CASE vsW2=2
                     IF vcJ8=1
                          STORE 0 TO vcJ8
                     ELSE
                          STORE 1 TO vcJ8
                          STORE 0 TO vcJt
                     ENDIF
           ENDCASE
           DO boT_3551a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL5-8.1 .AND. mcCc<= ;
           vcL5+2.5
           STORE CTOD("  /  /    ") TO cfEc
           IF vcJ0=1
                STORE 0 TO vcJ0
           ELSE
                STORE 1 TO vcJ0
                STORE 0 TO vcJt
           ENDIF
           DO boT_3551a
           STORE 99 TO mkEy
      CASE mfIl>=vfI1 .AND. mfIl<=vfI1+1 .AND. mcCc>=vcL6-12.3 .AND. mcCc<= ;
           vcL6+2.5
           STORE CTOD("  /  /    ") TO cfEc
           IF vcJt=1
                STORE 0 TO vcJt
           ELSE
                STORE 1 TO vcJt
                STORE 0 TO vcJ1, vcJ2, vcJ3, vcJ4, vcJ5, vcJ6, vcJ7, vcJ8,  ;
                      vcJ9, vcJa, vcJ0
           ENDIF
           DO boT_3551a
           STORE 99 TO mkEy
      OTHERWISE
           STORE 99 TO mkEy
 ENDCASE
ENDPROC
*
PROCEDURE Hl1_3551a
 PRIVATE pfIl
 = INKEY(0.01)
 STORE 0 TO pfIl
 ACTIVATE WINDOW mpAn_hlp
 @ pfIl+00, 02 SAY  ;
   "Esta consulta muestra todos los Movimientos de Ventas del da seleccio-"
 @ pfIl+01, 02 SAY "nado y su forma de cancelacin o pago a cuenta."
 @ pfIl+03, 02 SAY "Las teclas para movilizarse son:"
 @ pfIl+05, 18 SAY ":" STYLE "BT"
 @ pfIl+06, 18 SAY ":" STYLE "BT"
 @ pfIl+07, 18 SAY ":" STYLE "BT"
 @ pfIl+08, 18 SAY ":" STYLE "BT"
 @ pfIl+10, 18 SAY ":" STYLE "BT"
 @ pfIl+05, 02 SAY "ESC" STYLE "BT"
 @ pfIl+06, 02 SAY "F10" STYLE "BT"
 @ pfIl+07, 02 SAY "F1" STYLE "BT"
 @ pfIl+08, 02 SAY "ENTER, TAB," STYLE "BT"
 @ pfIl+09, 02 SAY "FLECHA ABAJO" STYLE "BT"
 @ pfIl+10, 02 SAY "CTRL ->  <--" STYLE "BT"
 @ pfIl+05, 20 SAY "Regresar al Men Principal"
 @ pfIl+06, 20 SAY "Cerrar y regresar a Windows"
 @ pfIl+07, 20 SAY "Ayuda del Programa"
 @ pfIl+08, 20 SAY "Consultar a partir de lo digitado, si es mayor a lo regis-"
 @ pfIl+09, 20 SAY "trado va al final del Archivo"
 @ pfIl+10, 20 SAY "Cambiar de Grupo de Cajas"
 DO ruTinahlp
 = INKEY(0.01)
 DEACTIVATE WINDOW mpAn_hlp
ENDPROC
*
PROCEDURE Del_Files
 DO q1_0000a
 DO deL_file1
 SET READBORDER OFF
 RELEASE vsW0, vsW1, vsW2, vfIl, ifIl, ufIl, ffIl, cfIl, vfFs, ifFs, ufFs,  ;
         ffFs, cfFs
 RELEASE icLn, ucLn, icL1, ucL1, vcL1, vcL2, vcL3, vcL4, vcL5, vcL6, vfI1,  ;
         vfI2, vpAg
 RELEASE vlIn, vtDo, itDo, utDo, ctDo, vsEr, isEr, usEr, csEr, vdOc, idOc,  ;
         udOc, cdOc
 RELEASE vcAj, icAj, ucAj, ccAj, vgRu, igRu, ugRu, cgRu, vsR1, isR1, usR1,  ;
         csR1, vnUm
 RELEASE inUm, unUm, cnUm, vgR1, igR1, ugR1, vcJj, icJj, ucJj, vtIp, itIp,  ;
         utIp, vfEc
 RELEASE cfEc, vmOn, vmNd, vtCa, vgLo, vsRl, vlEt, vrCb, vpGo, vcHe, vaCu,  ;
         vtOt, xtOt
 RELEASE vsLd, vfPa, ifPa, ufPa, vnFp, vnOm, vfEm, vnTi, vdNc, vsG1, vsG2,  ;
         vcJ1, vcJ2
 RELEASE vcJ3, vcJ4, vcJ6, vcJ7, vcJ8, vcJ9, vcJa, vcJ0, vcJt, voPc, vtPo,  ;
         veF1, veF2
 RELEASE veF3, veF4, vcH1, vcH2, vcH3, vcH4, vdP1, vdP2, vdP3, vdP4, voT1,  ;
         voT2, voT3
 RELEASE voT4, vfA1, vfA2, vfA3, vfA4, vbO1, vbO2, vbO3, vbO4, vnP1, vnP2,  ;
         vnP3, vnP4
 RELEASE vpE1, vpE2, vpE3, vpE4, vnC1, vnC2, vnC3, vnC4, vnD1, vnD2, vnD3,  ;
         vnD4, vnVe
 RELEASE vxLs
 RELEASE vpAn_11, vpAn_12
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 RELEASE exTended
 CLEAR RESOURCES
 FLUSH
ENDPROC
*
PROCEDURE Del_File1
 CLOSE INDEXES
 CLOSE DATABASES
 STORE 99 TO mkEy
 DO deL_file2 WITH "1", "S"
 DO deL_file2 WITH "2", "S"
 RELEASE ntM1, ntM2
ENDPROC
*
